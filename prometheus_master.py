# üî• PROMETHEUS-TQFD MASTER SCRIPT
# Unified Technical Specification v2.0
# Dual-AI Tabula Rasa Chess Training Framework

import os
import sys
import subprocess
import base64
from pathlib import Path

def write_file_b64(path, b64_content):
    os.makedirs(os.path.dirname(path), exist_ok=True)
    with open(path, 'wb') as f:
        f.write(base64.b64decode(b64_content))

print("üìù Writing project modules...")
write_file_b64("prometheus_tqfd/config.py", "ZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzLCBmaWVsZApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKaW1wb3J0IHRvcmNoCmltcG9ydCBvcwoKQGRhdGFjbGFzcwpjbGFzcyBFbnRyb3B5UGh5c2ljc0NvbmZpZzoKICAgICMgRmlndXJlbi1FbmVyZ2llbgogICAgZW5lcmd5X2tpbmc6IGZsb2F0ID0gMTAwMC4wCiAgICBlbmVyZ3lfcXVlZW46IGZsb2F0ID0gOS41CiAgICBlbmVyZ3lfcm9vazogZmxvYXQgPSA1LjI1CiAgICBlbmVyZ3lfYmlzaG9wOiBmbG9hdCA9IDMuMzMKICAgIGVuZXJneV9rbmlnaHQ6IGZsb2F0ID0gMy4wNQogICAgZW5lcmd5X3Bhd246IGZsb2F0ID0gMS4wCiAgICAKICAgICMgRmVsZC1QYXJhbWV0ZXIKICAgIGRpZmZ1c2lvbl9zaWdtYTogZmxvYXQgPSAyLjUKICAgIGZpZWxkX2FscGhhOiBmbG9hdCA9IDEuMCAgIyBHZXdpY2h0IE1hc3NlLUZlbGQKICAgIGZpZWxkX2JldGE6IGZsb2F0ID0gMC41ICAgIyBHZXdpY2h0IERydWNrLUZlbGQKICAgIGZpZWxkX2dhbW1hOiBmbG9hdCA9IDAuMSAgIyBHZXdpY2h0IExhcGxhY2lhbgogICAgCiAgICAjIFRoZXJtb2R5bmFtaWsKICAgIGJvbHR6bWFubl90ZW1wX3N0YXJ0OiBmbG9hdCA9IDUuMAogICAgYm9sdHptYW5uX3RlbXBfZW5kOiBmbG9hdCA9IDAuMQogICAgamFyenluc2tpX2JldGFfc3RhcnQ6IGZsb2F0ID0gMC4xCiAgICBqYXJ6eW5za2lfYmV0YV9lbmQ6IGZsb2F0ID0gMi4wCgpAZGF0YWNsYXNzCmNsYXNzIFByb21ldGhldXNDb25maWc6CiAgICAjID09PSBTWVNURU0gPT09CiAgICBydW5faWQ6IHN0ciA9IGZpZWxkKGRlZmF1bHRfZmFjdG9yeT1sYW1iZGE6IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWSVtJWRfJUglTSVTJykpCiAgICBiYXNlX2RpcjogUGF0aCA9IFBhdGgoJy4vcHJvbWV0aGV1c19ydW5zJykKICAgIHVzZV9kcml2ZTogYm9vbCA9IEZhbHNlCiAgICBzZWVkOiBpbnQgPSA0MgogICAgCiAgICAjID09PSBIQVJEV0FSRSA9PT0KICAgIGRldmljZTogc3RyID0gJ2N1ZGEnIGlmIHRvcmNoLmN1ZGEuaXNfYXZhaWxhYmxlKCkgZWxzZSAnY3B1JwogICAgYWN0b3JfZGV2aWNlOiBzdHIgPSAnY3B1JyAjIEZvciBzdGFiaWxpdHkgaW4gQ29sYWIKICAgIG51bV9hdGxhc19hY3RvcnM6IGludCA9IDIKICAgIG51bV9lbnRyb3B5X2FjdG9yczogaW50ID0gMgogICAgCiAgICAjID09PSBBVExBUyA9PT0KICAgIGF0bGFzX2lucHV0X2NoYW5uZWxzOiBpbnQgPSAxOQogICAgYXRsYXNfcmVzX2Jsb2NrczogaW50ID0gMTAKICAgIGF0bGFzX2NoYW5uZWxzOiBpbnQgPSAyNTYKICAgIGF0bGFzX2xlYXJuaW5nX3JhdGU6IGZsb2F0ID0gMWUtMwogICAgYXRsYXNfd2VpZ2h0X2RlY2F5OiBmbG9hdCA9IDFlLTQKICAgIGF0bGFzX2JhdGNoX3NpemU6IGludCA9IDI1NgogICAgYXRsYXNfcmVwbGF5X3NpemU6IGludCA9IDUwMF8wMDAKICAgIGF0bGFzX21jdHNfc2ltdWxhdGlvbnM6IGludCA9IDIwMAogICAgYXRsYXNfbWN0c19jcHVjdF9iYXNlOiBmbG9hdCA9IDE5NjUyLjAKICAgIGF0bGFzX21jdHNfY3B1Y3RfaW5pdDogZmxvYXQgPSAyLjUKICAgIGF0bGFzX2RpcmljaGxldF9hbHBoYTogZmxvYXQgPSAwLjMKICAgIGF0bGFzX2RpcmljaGxldF9lcHNpbG9uOiBmbG9hdCA9IDAuMjUKICAgIGF0bGFzX3RlbXBfbW92ZXM6IGludCA9IDMwCiAgICBhdGxhc190ZW1wX2luaXQ6IGZsb2F0ID0gMS4wCiAgICBhdGxhc190ZW1wX2ZpbmFsOiBmbG9hdCA9IDAuMQogICAgCiAgICAjID09PSBFTlRST1BZID09PQogICAgZW50cm9weV9nbm5faGlkZGVuOiBpbnQgPSA2NAogICAgZW50cm9weV9nbm5faGVhZHM6IGludCA9IDQKICAgIGVudHJvcHlfZ25uX2xheWVyczogaW50ID0gNAogICAgZW50cm9weV9maWVsZF9jaGFubmVsczogaW50ID0gNjQKICAgIGVudHJvcHlfZnVzaW9uX2RpbTogaW50ID0gNTEyCiAgICBlbnRyb3B5X2xlYXJuaW5nX3JhdGU6IGZsb2F0ID0gM2UtNAogICAgZW50cm9weV9iYXRjaF9zaXplOiBpbnQgPSAxMjgKICAgIGVudHJvcHlfcmVwbGF5X3NpemU6IGludCA9IDIwMF8wMDAKICAgIGVudHJvcHlfdGVtcF9zdGFydDogZmxvYXQgPSA1LjAKICAgIGVudHJvcHlfdGVtcF9lbmQ6IGZsb2F0ID0gMC4xCiAgICBlbnRyb3B5X3RlbXBfZGVjYXk6IGZsb2F0ID0gMC45OTk5CiAgICBlbnRyb3B5X2JldGFfc3RhcnQ6IGZsb2F0ID0gMC4xCiAgICBlbnRyb3B5X2JldGFfZW5kOiBmbG9hdCA9IDIuMAogICAgZW50cm9weV9sb3NzX3dlaWdodF9jb25zZXJ2YXRpb246IGZsb2F0ID0gMC41CiAgICBlbnRyb3B5X2xvc3Nfd2VpZ2h0X3Ntb290aG5lc3M6IGZsb2F0ID0gMC4xCiAgICBlbnRyb3B5X2xvc3Nfd2VpZ2h0X25vdmVsdHk6IGZsb2F0ID0gMC4zCiAgICBlbnRyb3B5X3JuZF9mZWF0dXJlX2RpbTogaW50ID0gMTI4CiAgICAKICAgIHBoeXNpY3M6IEVudHJvcHlQaHlzaWNzQ29uZmlnID0gZmllbGQoZGVmYXVsdF9mYWN0b3J5PUVudHJvcHlQaHlzaWNzQ29uZmlnKQogICAgCiAgICAjID09PSBUUkFJTklORyA9PT0KICAgIG1pbl9idWZmZXJfYmVmb3JlX3RyYWluaW5nOiBpbnQgPSAxMF8wMDAKICAgIHdlaWdodF9wdWJsaXNoX2ludGVydmFsOiBpbnQgPSAxMDAgICMgc3RlcHMKICAgIGNoZWNrcG9pbnRfaW50ZXJ2YWxfbWludXRlczogaW50ID0gMTUKICAgIGNoZWNrcG9pbnRfa2VlcF9uOiBpbnQgPSA1CiAgICAKICAgICMgPT09IEVWQUxVQVRJT04gPT09CiAgICBldmFsX2ludGVydmFsX2dhbWVzOiBpbnQgPSAxMF8wMDAKICAgIGV2YWxfZ2FtZXNfcGVyX2R1ZWw6IGludCA9IDEwMAogICAgZXZhbF90aW1lX3Blcl9tb3ZlOiBmbG9hdCA9IDUuMAogICAgZWxvX2luaXRpYWw6IGZsb2F0ID0gMTAwMC4wCiAgICBlbG9fa19mYWN0b3I6IGZsb2F0ID0gMzIuMAogICAgCiAgICAjID09PSBEQVNIQk9BUkQgPT09CiAgICBkYXNoYm9hcmRfcG9ydDogaW50ID0gODUwMQogICAgZGFzaGJvYXJkX3JlZnJlc2hfc2Vjb25kczogZmxvYXQgPSAyLjAKICAgIAogICAgIyA9PT0gUkVTSUxJRU5aID09PQogICAgaGVhcnRiZWF0X3RpbWVvdXQ6IGZsb2F0ID0gNjAuMAogICAgbWF4X3Byb2Nlc3NfcmVzdGFydHM6IGludCA9IDMKICAgIG9vbV9iYXRjaF9yZWR1Y3Rpb25fZmFjdG9yOiBmbG9hdCA9IDAuNQogICAgb29tX21pbl9iYXRjaF9zaXplOiBpbnQgPSA4CgpkZWYgYWRqdXN0X2NvbmZpZ19mb3JfaGFyZHdhcmUoY29uZmlnOiBQcm9tZXRoZXVzQ29uZmlnKToKICAgIGlmIG5vdCB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgIGNvbmZpZy5kZXZpY2UgPSAnY3B1JwogICAgICAgIGNvbmZpZy5hdGxhc19iYXRjaF9zaXplID0gMzIKICAgICAgICBjb25maWcuZW50cm9weV9iYXRjaF9zaXplID0gMTYKICAgICAgICBjb25maWcuYXRsYXNfcmVzX2Jsb2NrcyA9IDUKICAgICAgICBjb25maWcuYXRsYXNfbWN0c19zaW11bGF0aW9ucyA9IDUwCiAgICAgICAgcmV0dXJuIGNvbmZpZwoKICAgIHZyYW1fZ2IgPSB0b3JjaC5jdWRhLmdldF9kZXZpY2VfcHJvcGVydGllcygwKS50b3RhbF9tZW1vcnkgLyAoMTAyNCoqMykKICAgIAogICAgaWYgdnJhbV9nYiA+PSA0MDogICMgQTEwMAogICAgICAgIGNvbmZpZy5hdGxhc19iYXRjaF9zaXplID0gNTEyCiAgICAgICAgY29uZmlnLmVudHJvcHlfYmF0Y2hfc2l6ZSA9IDI1NgogICAgICAgIGNvbmZpZy5hdGxhc19tY3RzX3NpbXVsYXRpb25zID0gNDAwCiAgICAgICAgY29uZmlnLmF0bGFzX3Jlc19ibG9ja3MgPSAxNQogICAgICAgIGNvbmZpZy5hdGxhc19yZXBsYXlfc2l6ZSA9IDFfMDAwXzAwMAogICAgZWxpZiB2cmFtX2diID49IDE2OiAgIyBWMTAwIC8gVDQtUHJvCiAgICAgICAgY29uZmlnLmF0bGFzX2JhdGNoX3NpemUgPSAyNTYKICAgICAgICBjb25maWcuZW50cm9weV9iYXRjaF9zaXplID0gMTI4CiAgICAgICAgY29uZmlnLmF0bGFzX21jdHNfc2ltdWxhdGlvbnMgPSAyMDAKICAgICAgICBjb25maWcuYXRsYXNfcmVzX2Jsb2NrcyA9IDEwCiAgICAgICAgY29uZmlnLmF0bGFzX3JlcGxheV9zaXplID0gNTAwXzAwMAogICAgZWxpZiB2cmFtX2diID49IDEyOiAgIyBUNC1GcmVlCiAgICAgICAgY29uZmlnLmF0bGFzX2JhdGNoX3NpemUgPSAxMjgKICAgICAgICBjb25maWcuZW50cm9weV9iYXRjaF9zaXplID0gNjQKICAgICAgICBjb25maWcuYXRsYXNfbWN0c19zaW11bGF0aW9ucyA9IDEwMAogICAgICAgIGNvbmZpZy5hdGxhc19yZXNfYmxvY2tzID0gOAogICAgICAgIGNvbmZpZy5hdGxhc19yZXBsYXlfc2l6ZSA9IDMwMF8wMDAKICAgIGVsc2U6CiAgICAgICAgY29uZmlnLmF0bGFzX2JhdGNoX3NpemUgPSA2NAogICAgICAgIGNvbmZpZy5lbnRyb3B5X2JhdGNoX3NpemUgPSAzMgogICAgICAgIGNvbmZpZy5hdGxhc19tY3RzX3NpbXVsYXRpb25zID0gNTAKICAgICAgICBjb25maWcuYXRsYXNfcmVzX2Jsb2NrcyA9IDUKICAgICAgICBjb25maWcuYXRsYXNfcmVwbGF5X3NpemUgPSAxMDBfMDAwCiAgICAgICAgCiAgICByZXR1cm4gY29uZmlnCg==")
write_file_b64("prometheus_tqfd/encoding.py", "aW1wb3J0IGNoZXNzCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgdG9yY2gKCmNsYXNzIEJvYXJkRW5jb2RlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB1c2VfaGlzdG9yeT1GYWxzZSwgaGlzdG9yeV9sZW49OCk6CiAgICAgICAgc2VsZi51c2VfaGlzdG9yeSA9IHVzZV9oaXN0b3J5CiAgICAgICAgc2VsZi5oaXN0b3J5X2xlbiA9IGhpc3RvcnlfbGVuCiAgICAgICAgc2VsZi5udW1fY2hhbm5lbHMgPSAxOSArICgxMiAqIChoaXN0b3J5X2xlbiAtIDEpKSBpZiB1c2VfaGlzdG9yeSBlbHNlIDE5CgogICAgZGVmIGVuY29kZShzZWxmLCBib2FyZDogY2hlc3MuQm9hcmQpIC0+IHRvcmNoLlRlbnNvcjoKICAgICAgICAjIFtDLCA4LCA4XQogICAgICAgIHRlbnNvciA9IG5wLnplcm9zKCgxOSwgOCwgOCksIGR0eXBlPW5wLmZsb2F0MzIpCiAgICAgICAgCiAgICAgICAgIyBQaWVjZSBjaGFubmVscwogICAgICAgIGZvciBzcXVhcmUsIHBpZWNlIGluIGJvYXJkLnBpZWNlX21hcCgpLml0ZW1zKCk6CiAgICAgICAgICAgIHJhbmssIGZpbGUgPSBkaXZtb2Qoc3F1YXJlLCA4KQogICAgICAgICAgICAjIFdoaXRlOiAwLTUsIEJsYWNrOiA2LTExCiAgICAgICAgICAgIGNoYW5uZWwgPSBwaWVjZS5waWVjZV90eXBlIC0gMSArICgwIGlmIHBpZWNlLmNvbG9yID09IGNoZXNzLldISVRFIGVsc2UgNikKICAgICAgICAgICAgdGVuc29yW2NoYW5uZWwsIHJhbmssIGZpbGVdID0gMS4wCiAgICAgICAgICAgIAogICAgICAgICMgQ2FzdGxpbmcgcmlnaHRzCiAgICAgICAgaWYgYm9hcmQuaGFzX2tpbmdzaWRlX2Nhc3RsaW5nX3JpZ2h0cyhjaGVzcy5XSElURSk6IHRlbnNvclsxMiwgOiwgOl0gPSAxLjAKICAgICAgICBpZiBib2FyZC5oYXNfcXVlZW5zaWRlX2Nhc3RsaW5nX3JpZ2h0cyhjaGVzcy5XSElURSk6IHRlbnNvclsxMywgOiwgOl0gPSAxLjAKICAgICAgICBpZiBib2FyZC5oYXNfa2luZ3NpZGVfY2FzdGxpbmdfcmlnaHRzKGNoZXNzLkJMQUNLKTogdGVuc29yWzE0LCA6LCA6XSA9IDEuMAogICAgICAgIGlmIGJvYXJkLmhhc19xdWVlbnNpZGVfY2FzdGxpbmdfcmlnaHRzKGNoZXNzLkJMQUNLKTogdGVuc29yWzE1LCA6LCA6XSA9IDEuMAogICAgICAgIAogICAgICAgICMgRW4gcGFzc2FudAogICAgICAgIGlmIGJvYXJkLmVwX3NxdWFyZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFuaywgZmlsZSA9IGRpdm1vZChib2FyZC5lcF9zcXVhcmUsIDgpCiAgICAgICAgICAgIHRlbnNvclsxNiwgcmFuaywgZmlsZV0gPSAxLjAKICAgICAgICAgICAgCiAgICAgICAgIyBIYWxmbW92ZSBjbG9jawogICAgICAgIHRlbnNvclsxNywgOiwgOl0gPSBib2FyZC5oYWxmbW92ZV9jbG9jayAvIDEwMC4wCiAgICAgICAgCiAgICAgICAgIyBTaWRlIHRvIG1vdmUKICAgICAgICBpZiBib2FyZC50dXJuID09IGNoZXNzLldISVRFOgogICAgICAgICAgICB0ZW5zb3JbMTgsIDosIDpdID0gMS4wCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiB0b3JjaC5mcm9tX251bXB5KHRlbnNvcikKCmNsYXNzIE1vdmVFbmNvZGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubW92ZV90b19pZHggPSB7fQogICAgICAgIHNlbGYuaWR4X3RvX21vdmUgPSB7fQogICAgICAgIHNlbGYuX2NyZWF0ZV9tYXBwaW5nKCkKCiAgICBkZWYgX2NyZWF0ZV9tYXBwaW5nKHNlbGYpOgogICAgICAgIGlkeCA9IDAKICAgICAgICAjIGRpcmVjdGlvbnM6IChkciwgZGYpCiAgICAgICAgIyBRdWVlbiBtb3ZlcwogICAgICAgIGRpcmVjdGlvbnMgPSBbCiAgICAgICAgICAgICgxLCAwKSwgKDEsIDEpLCAoMCwgMSksICgtMSwgMSksCiAgICAgICAgICAgICgtMSwgMCksICgtMSwgLTEpLCAoMCwgLTEpLCAoMSwgLTEpCiAgICAgICAgXQogICAgICAgIAogICAgICAgIGZvciBmcm9tX3NxIGluIHJhbmdlKDY0KToKICAgICAgICAgICAgZnJvbV9yYW5rLCBmcm9tX2ZpbGUgPSBkaXZtb2QoZnJvbV9zcSwgOCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgUXVlZW4tbGlrZSBtb3ZlcwogICAgICAgICAgICBmb3IgZF9pZHgsIChkciwgZGYpIGluIGVudW1lcmF0ZShkaXJlY3Rpb25zKToKICAgICAgICAgICAgICAgIGZvciBkaXN0IGluIHJhbmdlKDEsIDgpOgogICAgICAgICAgICAgICAgICAgIHRvX3JhbmssIHRvX2ZpbGUgPSBmcm9tX3JhbmsgKyBkciAqIGRpc3QsIGZyb21fZmlsZSArIGRmICogZGlzdAogICAgICAgICAgICAgICAgICAgIGlmIDAgPD0gdG9fcmFuayA8IDggYW5kIDAgPD0gdG9fZmlsZSA8IDg6CiAgICAgICAgICAgICAgICAgICAgICAgICMgVGhpcyBtb3ZlIGV4aXN0cy4gV2UgbmVlZCBhIHVuaXF1ZSBJRCBmb3IgKGZyb21fc3EsIGRfaWR4LCBkaXN0KQogICAgICAgICAgICAgICAgICAgICAgICAjIEFjdHVhbGx5IEFscGhhWmVybyBtYXBzIGVhY2ggbW92ZSB0byA3MyBwbGFuZXMgb2YgOHg4CiAgICAgICAgICAgICAgICAgICAgICAgICMgMC01NTogUXVlZW4gbW92ZXMgKDggZGlyICogNyBkaXN0KQogICAgICAgICAgICAgICAgICAgICAgICAjIDU2LTYzOiBLbmlnaHQgbW92ZXMKICAgICAgICAgICAgICAgICAgICAgICAgIyA2NC03MjogVW5kZXJwcm9tb3Rpb25zCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgCiAgICAgICAgIyBMZXQncyB1c2UgYSBzaW1wbGVyIG1hcHBpbmcgdGhhdCdzIGNvbnNpc3RlbnQgd2l0aCB0aGUgc3BlYzogNjQgKiA3MwogICAgICAgICMgcGxhbmVfaWR4OgogICAgICAgICMgMC4uNTU6IFF1ZWVuIG1vdmVzIChkaXJlY3Rpb24gKiA3ICsgKGRpc3RhbmNlIC0gMSkpCiAgICAgICAgIyA1Ni4uNjM6IEtuaWdodCBtb3ZlcwogICAgICAgICMgNjQuLjcyOiBVbmRlcnByb21vdGlvbnMKICAgICAgICAKICAgICAgICAjIFdlIGRvbid0IHJlYWxseSBuZWVkIHRvIHByZS1wb3B1bGF0ZSBldmVyeXRoaW5nIGlmIHdlIGNhbiBjb21wdXRlIGl0CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfcGxhbmVfYW5kX3NxKHNlbGYsIG1vdmU6IGNoZXNzLk1vdmUpOgogICAgICAgIGZyb21fc3EgPSBtb3ZlLmZyb21fc3F1YXJlCiAgICAgICAgdG9fc3EgPSBtb3ZlLnRvX3NxdWFyZQogICAgICAgIGZyb21fcmFuaywgZnJvbV9maWxlID0gZGl2bW9kKGZyb21fc3EsIDgpCiAgICAgICAgdG9fcmFuaywgdG9fZmlsZSA9IGRpdm1vZCh0b19zcSwgOCkKICAgICAgICBkciwgZGYgPSB0b19yYW5rIC0gZnJvbV9yYW5rLCB0b19maWxlIC0gZnJvbV9maWxlCiAgICAgICAgCiAgICAgICAgIyBVbmRlcnByb21vdGlvbnMKICAgICAgICBpZiBtb3ZlLnByb21vdGlvbiBhbmQgbW92ZS5wcm9tb3Rpb24gIT0gY2hlc3MuUVVFRU46CiAgICAgICAgICAgICMgNjQtNzI6IDMgZGlyZWN0aW9ucyAoZGY6IC0xLCAwLCAxKSB4IDMgcGllY2VzIChOLCBCLCBSKQogICAgICAgICAgICAjIFBpZWNlczogTj0yLCBCPTMsIFI9NAogICAgICAgICAgICBwaWVjZV9pZHggPSBtb3ZlLnByb21vdGlvbiAtIDIgIyAwLCAxLCAyCiAgICAgICAgICAgIGRpcl9pZHggPSBkZiArIDEgIyAwLCAxLCAyCiAgICAgICAgICAgIHBsYW5lID0gNjQgKyBwaWVjZV9pZHggKiAzICsgZGlyX2lkeAogICAgICAgICAgICByZXR1cm4gcGxhbmUsIGZyb21fc3EKCiAgICAgICAgIyBLbmlnaHQgbW92ZXMKICAgICAgICBrbmlnaHRfbW92ZXMgPSBbCiAgICAgICAgICAgICgyLCAxKSwgKDEsIDIpLCAoLTEsIDIpLCAoLTIsIDEpLAogICAgICAgICAgICAoLTIsIC0xKSwgKC0xLCAtMiksICgxLCAtMiksICgyLCAtMSkKICAgICAgICBdCiAgICAgICAgaWYgKGRyLCBkZikgaW4ga25pZ2h0X21vdmVzOgogICAgICAgICAgICBwbGFuZSA9IDU2ICsga25pZ2h0X21vdmVzLmluZGV4KChkciwgZGYpKQogICAgICAgICAgICByZXR1cm4gcGxhbmUsIGZyb21fc3EKICAgICAgICAgICAgCiAgICAgICAgIyBRdWVlbiBtb3ZlcwogICAgICAgIGRpcmVjdGlvbnMgPSBbCiAgICAgICAgICAgICgxLCAwKSwgKDEsIDEpLCAoMCwgMSksICgtMSwgMSksCiAgICAgICAgICAgICgtMSwgMCksICgtMSwgLTEpLCAoMCwgLTEpLCAoMSwgLTEpCiAgICAgICAgXQogICAgICAgIGFic19kciwgYWJzX2RmID0gYWJzKGRyKSwgYWJzKGRmKQogICAgICAgIGRpc3QgPSBtYXgoYWJzX2RyLCBhYnNfZGYpCiAgICAgICAgaWYgKGRyIC8vIGRpc3QsIGRmIC8vIGRpc3QpIGluIGRpcmVjdGlvbnMgYW5kIChhYnNfZHIgPT0gMCBvciBhYnNfZGYgPT0gMCBvciBhYnNfZHIgPT0gYWJzX2RmKToKICAgICAgICAgICAgZF9pZHggPSBkaXJlY3Rpb25zLmluZGV4KChkciAvLyBkaXN0LCBkZiAvLyBkaXN0KSkKICAgICAgICAgICAgcGxhbmUgPSBkX2lkeCAqIDcgKyAoZGlzdCAtIDEpCiAgICAgICAgICAgIHJldHVybiBwbGFuZSwgZnJvbV9zcQogICAgICAgICAgICAKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiSW52YWxpZCBtb3ZlIGZvciBlbmNvZGluZzoge21vdmV9IikKCiAgICBkZWYgbW92ZV90b19pbmRleChzZWxmLCBtb3ZlOiBjaGVzcy5Nb3ZlKSAtPiBpbnQ6CiAgICAgICAgcGxhbmUsIGZyb21fc3EgPSBzZWxmLmdldF9wbGFuZV9hbmRfc3EobW92ZSkKICAgICAgICByZXR1cm4gZnJvbV9zcSAqIDczICsgcGxhbmUKCiAgICBkZWYgaW5kZXhfdG9fbW92ZShzZWxmLCBpbmRleDogaW50LCBib2FyZDogY2hlc3MuQm9hcmQpIC0+IGNoZXNzLk1vdmU6CiAgICAgICAgZnJvbV9zcSwgcGxhbmUgPSBkaXZtb2QoaW5kZXgsIDczKQogICAgICAgIGZyb21fcmFuaywgZnJvbV9maWxlID0gZGl2bW9kKGZyb21fc3EsIDgpCiAgICAgICAgCiAgICAgICAgaWYgcGxhbmUgPCA1NjoKICAgICAgICAgICAgIyBRdWVlbiBtb3ZlCiAgICAgICAgICAgIGRfaWR4LCBkaXN0X20xID0gZGl2bW9kKHBsYW5lLCA3KQogICAgICAgICAgICBkaXN0ID0gZGlzdF9tMSArIDEKICAgICAgICAgICAgZGlyZWN0aW9ucyA9IFsoMSwgMCksICgxLCAxKSwgKDAsIDEpLCAoLTEsIDEpLCAoLTEsIDApLCAoLTEsIC0xKSwgKDAsIC0xKSwgKDEsIC0xKV0KICAgICAgICAgICAgZHIsIGRmID0gZGlyZWN0aW9uc1tkX2lkeF0KICAgICAgICAgICAgdG9fcmFuaywgdG9fZmlsZSA9IGZyb21fcmFuayArIGRyICogZGlzdCwgZnJvbV9maWxlICsgZGYgKiBkaXN0CiAgICAgICAgICAgIHRvX3NxID0gdG9fcmFuayAqIDggKyB0b19maWxlCiAgICAgICAgICAgIG1vdmUgPSBjaGVzcy5Nb3ZlKGZyb21fc3EsIHRvX3NxKQogICAgICAgICAgICAjIENoZWNrIGZvciBwcm9tb3Rpb24gdG8gUXVlZW4gKGRlZmF1bHQpCiAgICAgICAgICAgIGlmIGJvYXJkLnBpZWNlX2F0KGZyb21fc3EpIGFuZCBib2FyZC5waWVjZV9hdChmcm9tX3NxKS5waWVjZV90eXBlID09IGNoZXNzLlBBV046CiAgICAgICAgICAgICAgICBpZiAodG9fcmFuayA9PSA3IGFuZCBib2FyZC50dXJuID09IGNoZXNzLldISVRFKSBvciAodG9fcmFuayA9PSAwIGFuZCBib2FyZC50dXJuID09IGNoZXNzLkJMQUNLKToKICAgICAgICAgICAgICAgICAgICBtb3ZlLnByb21vdGlvbiA9IGNoZXNzLlFVRUVOCiAgICAgICAgICAgIHJldHVybiBtb3ZlCiAgICAgICAgZWxpZiBwbGFuZSA8IDY0OgogICAgICAgICAgICAjIEtuaWdodCBtb3ZlCiAgICAgICAgICAgIGtuaWdodF9tb3ZlcyA9IFsoMiwgMSksICgxLCAyKSwgKC0xLCAyKSwgKC0yLCAxKSwgKC0yLCAtMSksICgtMSwgLTIpLCAoMSwgLTIpLCAoMiwgLTEpXQogICAgICAgICAgICBkciwgZGYgPSBrbmlnaHRfbW92ZXNbcGxhbmUgLSA1Nl0KICAgICAgICAgICAgdG9fcmFuaywgdG9fZmlsZSA9IGZyb21fcmFuayArIGRyLCBmcm9tX2ZpbGUgKyBkZgogICAgICAgICAgICB0b19zcSA9IHRvX3JhbmsgKiA4ICsgdG9fZmlsZQogICAgICAgICAgICByZXR1cm4gY2hlc3MuTW92ZShmcm9tX3NxLCB0b19zcSkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIFVuZGVycHJvbW90aW9uCiAgICAgICAgICAgIHBpZWNlX2lkeCwgZGlyX2lkeCA9IGRpdm1vZChwbGFuZSAtIDY0LCAzKQogICAgICAgICAgICBkZiA9IGRpcl9pZHggLSAxCiAgICAgICAgICAgIHBpZWNlID0gcGllY2VfaWR4ICsgMgogICAgICAgICAgICB0b19yYW5rID0gNyBpZiBib2FyZC50dXJuID09IGNoZXNzLldISVRFIGVsc2UgMAogICAgICAgICAgICB0b19maWxlID0gZnJvbV9maWxlICsgZGYKICAgICAgICAgICAgdG9fc3EgPSB0b19yYW5rICogOCArIHRvX2ZpbGUKICAgICAgICAgICAgcmV0dXJuIGNoZXNzLk1vdmUoZnJvbV9zcSwgdG9fc3EsIHByb21vdGlvbj1waWVjZSkKCiAgICBkZWYgZ2V0X2xlZ2FsX21hc2soc2VsZiwgYm9hcmQ6IGNoZXNzLkJvYXJkKSAtPiB0b3JjaC5UZW5zb3I6CiAgICAgICAgbWFzayA9IHRvcmNoLnplcm9zKDQ2NzIsIGR0eXBlPXRvcmNoLmJvb2wpCiAgICAgICAgZm9yIG1vdmUgaW4gYm9hcmQubGVnYWxfbW92ZXM6CiAgICAgICAgICAgIG1hc2tbc2VsZi5tb3ZlX3RvX2luZGV4KG1vdmUpXSA9IFRydWUKICAgICAgICByZXR1cm4gbWFzawo=")
write_file_b64("prometheus_tqfd/utils/hardware.py", "aW1wb3J0IHRvcmNoCmltcG9ydCBwc3V0aWwKCmRlZiBkZXRlY3RfaGFyZHdhcmUoKToKICAgIGh3ID0gewogICAgICAgICdkZXZpY2UnOiAnY3VkYScgaWYgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKSBlbHNlICdjcHUnLAogICAgICAgICdncHVfbmFtZSc6IE5vbmUsCiAgICAgICAgJ3ZyYW1fZ2InOiAwLjAsCiAgICAgICAgJ3JhbV9nYic6IHBzdXRpbC52aXJ0dWFsX21lbW9yeSgpLnRvdGFsIC8gKDEwMjQqKjMpLAogICAgICAgICdjcHVfY29yZXMnOiBwc3V0aWwuY3B1X2NvdW50KCksCiAgICAgICAgJ2lzX2NvbGFiJzogJ2dvb2dsZS5jb2xhYicgaW4gc3RyKGdldF9pcHl0aG9uKCkpIGlmICdnZXRfaXB5dGhvbicgaW4gZ2xvYmFscygpIGVsc2UgRmFsc2UKICAgIH0KICAgIAogICAgaWYgaHdbJ2RldmljZSddID09ICdjdWRhJzoKICAgICAgICBod1snZ3B1X25hbWUnXSA9IHRvcmNoLmN1ZGEuZ2V0X2RldmljZV9uYW1lKDApCiAgICAgICAgaHdbJ3ZyYW1fZ2InXSA9IHRvcmNoLmN1ZGEuZ2V0X2RldmljZV9wcm9wZXJ0aWVzKDApLnRvdGFsX21lbW9yeSAvICgxMDI0KiozKQogICAgICAgIAogICAgcmV0dXJuIGh3Cg==")
write_file_b64("prometheus_tqfd/utils/logging.py", "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAoKY2xhc3MgTWV0cmljc0xvZ2dlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBydW5fZGlyKToKICAgICAgICBzZWxmLm1ldHJpY3NfZGlyID0gcnVuX2RpciAvICdtZXRyaWNzJwogICAgICAgIHNlbGYubWV0cmljc19kaXIubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQogICAgICAgIHNlbGYubWV0cmljc19maWxlID0gc2VsZi5tZXRyaWNzX2RpciAvICdtZXRyaWNzLmpzb25sJwogICAgICAgIHNlbGYuZiA9IG9wZW4oc2VsZi5tZXRyaWNzX2ZpbGUsICdhJywgYnVmZmVyaW5nPTEpCgogICAgZGVmIGxvZyhzZWxmLCBkYXRhKToKICAgICAgICBkYXRhWyd0aW1lc3RhbXAnXSA9IG9zLnRpbWVzKCkuZWxhcHNlZAogICAgICAgIHNlbGYuZi53cml0ZShqc29uLmR1bXBzKGRhdGEpICsgJ1xuJykKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgc2VsZi5mLmNsb3NlKCkK")
write_file_b64("prometheus_tqfd/utils/tunneling.py", "aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCB0aW1lCgpjbGFzcyBUdW5uZWxNYW5hZ2VyOgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHN0YXJ0X25ncm9rKHBvcnQsIHRva2VuPU5vbmUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZnJvbSBweW5ncm9rIGltcG9ydCBuZ3JvawogICAgICAgICAgICBpZiB0b2tlbjoKICAgICAgICAgICAgICAgIG5ncm9rLnNldF9hdXRoX3Rva2VuKHRva2VuKQogICAgICAgICAgICB0dW5uZWwgPSBuZ3Jvay5jb25uZWN0KHBvcnQsICJodHRwIikKICAgICAgICAgICAgcmV0dXJuIHR1bm5lbC5wdWJsaWNfdXJsCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIm5ncm9rIGZhaWxlZDoge2V9IikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgc3RhcnRfY2xvdWRmbGFyZWQocG9ydCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIERvd25sb2FkIGlmIG5vdCBwcmVzZW50CiAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygiLi9jbG91ZGZsYXJlZCIpOgogICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJ3Z2V0IiwgIi1xIiwgImh0dHBzOi8vZ2l0aHViLmNvbS9jbG91ZGZsYXJlL2Nsb3VkZmxhcmVkL3JlbGVhc2VzL2xhdGVzdC9kb3dubG9hZC9jbG91ZGZsYXJlZC1saW51eC1hbWQ2NCIsICItTyIsICJjbG91ZGZsYXJlZCJdKQogICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJjaG1vZCIsICIreCIsICJjbG91ZGZsYXJlZCJdKQogICAgICAgICAgICAKICAgICAgICAgICAgcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oWyIuL2Nsb3VkZmxhcmVkIiwgInR1bm5lbCIsICItLXVybCIsIGYiaHR0cDovL2xvY2FsaG9zdDp7cG9ydH0iXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5TVERPVVQsIHRleHQ9VHJ1ZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgV2FpdCBmb3IgVVJMIHRvIGFwcGVhciBpbiBvdXRwdXQKICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMzApOgogICAgICAgICAgICAgICAgbGluZSA9IHByb2Nlc3Muc3Rkb3V0LnJlYWRsaW5lKCkKICAgICAgICAgICAgICAgIGlmICIudHJ5Y2xvdWRmbGFyZS5jb20iIGluIGxpbmU6CiAgICAgICAgICAgICAgICAgICAgdXJsID0gbGluZS5zdHJpcCgpLnNwbGl0KClbLTFdCiAgICAgICAgICAgICAgICAgICAgIyBTb21ldGltZXMgVVJMIGlzIGluc2lkZSBhIHNlbnRlbmNlCiAgICAgICAgICAgICAgICAgICAgZm9yIHdvcmQgaW4gbGluZS5zcGxpdCgpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAiLnRyeWNsb3VkZmxhcmUuY29tIiBpbiB3b3JkOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmQKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiY2xvdWRmbGFyZWQgZmFpbGVkOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBzdGFydF9sb2NhbHR1bm5lbChwb3J0KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHByb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKFsibnB4IiwgImxvY2FsdHVubmVsIiwgIi0tcG9ydCIsIHN0cihwb3J0KV0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgdGV4dD1UcnVlKQogICAgICAgICAgICBsaW5lID0gcHJvY2Vzcy5zdGRvdXQucmVhZGxpbmUoKQogICAgICAgICAgICBpZiAieW91ciB1cmwgaXM6IiBpbiBsaW5lLmxvd2VyKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5zcGxpdCgpWy0xXQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJsb2NhbHR1bm5lbCBmYWlsZWQ6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBOb25lCgpkZWYgc2V0dXBfdHVubmVsKHBvcnQsIG5ncm9rX3Rva2VuPU5vbmUpOgogICAgIyAxLiBuZ3JvawogICAgaWYgbmdyb2tfdG9rZW46CiAgICAgICAgdXJsID0gVHVubmVsTWFuYWdlci5zdGFydF9uZ3Jvayhwb3J0LCBuZ3Jva190b2tlbikKICAgICAgICBpZiB1cmw6IHJldHVybiB1cmwKICAgICAgICAKICAgICMgMi4gY2xvdWRmbGFyZWQKICAgIHVybCA9IFR1bm5lbE1hbmFnZXIuc3RhcnRfY2xvdWRmbGFyZWQocG9ydCkKICAgIGlmIHVybDogcmV0dXJuIHVybAogICAgCiAgICAjIDMuIGxvY2FsdHVubmVsCiAgICB1cmwgPSBUdW5uZWxNYW5hZ2VyLnN0YXJ0X2xvY2FsdHVubmVsKHBvcnQpCiAgICByZXR1cm4gdXJsCg==")
write_file_b64("prometheus_tqfd/orchestration/supervisor.py", "aW1wb3J0IHRvcmNoLm11bHRpcHJvY2Vzc2luZyBhcyBtcAppbXBvcnQgdGltZQppbXBvcnQgcmFuZG9tCmltcG9ydCB0b3JjaApmcm9tIHByb21ldGhldXNfdHFmZC5vcmNoZXN0cmF0aW9uLmNoZWNrcG9pbnQgaW1wb3J0IENoZWNrcG9pbnRNYW5hZ2VyCmZyb20gcHJvbWV0aGV1c190cWZkLm9yY2hlc3RyYXRpb24ucmVjb3ZlcnkgaW1wb3J0IFJlY292ZXJ5TWFuYWdlciwgZ3VhcmRlZF9ydW4KZnJvbSBwcm9tZXRoZXVzX3RxZmQuYXRsYXMudHJhaW5lciBpbXBvcnQgQXRsYXNUcmFpbmVyCmZyb20gcHJvbWV0aGV1c190cWZkLmF0bGFzLnNlbGZwbGF5IGltcG9ydCBBdGxhc1NlbGZQbGF5V29ya2VyCmZyb20gcHJvbWV0aGV1c190cWZkLmVudHJvcHkudHJhaW5lciBpbXBvcnQgRW50cm9weVRyYWluZXIKZnJvbSBwcm9tZXRoZXVzX3RxZmQuZW50cm9weS5zZWxmcGxheSBpbXBvcnQgRW50cm9weVNlbGZQbGF5V29ya2VyCmZyb20gcHJvbWV0aGV1c190cWZkLmV2YWx1YXRpb24uYXJlbmEgaW1wb3J0IEFyZW5hLCBOTlBsYXllcgpmcm9tIHByb21ldGhldXNfdHFmZC5ldmFsdWF0aW9uLmJhc2VsaW5lcyBpbXBvcnQgUmFuZG9tUGxheWVyLCBIZXVyaXN0aWNQbGF5ZXIKZnJvbSBwcm9tZXRoZXVzX3RxZmQudXRpbHMubG9nZ2luZyBpbXBvcnQgTWV0cmljc0xvZ2dlcgoKY2xhc3MgU3VwZXJ2aXNvcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25maWcpOgogICAgICAgIHNlbGYuY29uZmlnID0gY29uZmlnCiAgICAgICAgc2VsZi5zdG9wX2V2ZW50ID0gbXAuRXZlbnQoKQogICAgICAgIHNlbGYucGF1c2VfZXZlbnQgPSBtcC5FdmVudCgpCiAgICAgICAgc2VsZi5vb21fZXZlbnQgPSBtcC5FdmVudCgpCiAgICAgICAgc2VsZi50cmFpbmluZ19sb2NrID0gbXAuTG9jaygpCiAgICAgICAgCiAgICAgICAgc2VsZi5tYW5hZ2VyID0gbXAuTWFuYWdlcigpCiAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzID0gc2VsZi5tYW5hZ2VyLmRpY3QoewogICAgICAgICAgICAnYXRsYXNfZ2FtZXMnOiAwLAogICAgICAgICAgICAnZW50cm9weV9nYW1lcyc6IDAsCiAgICAgICAgICAgICdhdGxhc19zdGVwcyc6IDAsCiAgICAgICAgICAgICdlbnRyb3B5X3N0ZXBzJzogMCwKICAgICAgICAgICAgJ2F0bGFzX2Vsbyc6IGNvbmZpZy5lbG9faW5pdGlhbCwKICAgICAgICAgICAgJ2VudHJvcHlfZWxvJzogY29uZmlnLmVsb19pbml0aWFsLAogICAgICAgICAgICAnc3RhdHVzJzogJ3N0YXJ0aW5nJwogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgc2VsZi5xdWV1ZXMgPSB7CiAgICAgICAgICAgICdhdGxhc19kYXRhJzogbXAuUXVldWUobWF4c2l6ZT0xMDApLAogICAgICAgICAgICAnZW50cm9weV9kYXRhJzogbXAuUXVldWUobWF4c2l6ZT0xMDApLAogICAgICAgICAgICAnYXRsYXNfd2VpZ2h0cyc6IG1wLlF1ZXVlKG1heHNpemU9MSksCiAgICAgICAgICAgICdlbnRyb3B5X3dlaWdodHMnOiBtcC5RdWV1ZShtYXhzaXplPTEpLAogICAgICAgICAgICAnbWV0cmljcyc6IG1wLlF1ZXVlKG1heHNpemU9MTAwMCkKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc2VsZi5jcF9tZ3IgPSBDaGVja3BvaW50TWFuYWdlcihjb25maWcpCiAgICAgICAgc2VsZi5yZWNvdmVyeV9tZ3IgPSBSZWNvdmVyeU1hbmFnZXIoY29uZmlnLCBzZWxmLnN0b3BfZXZlbnQsIHNlbGYub29tX2V2ZW50KQogICAgICAgIHNlbGYubG9nZ2VyID0gTWV0cmljc0xvZ2dlcihjb25maWcuYmFzZV9kaXIgLyBjb25maWcucnVuX2lkKQogICAgICAgIAogICAgICAgIHNlbGYucHJvY2Vzc2VzID0ge30KCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHByaW50KCJTdXBlcnZpc29yIHN0YXJ0aW5nLi4uIikKICAgICAgICAKICAgICAgICAjIDEuIFN0YXJ0IFRyYWluZXIgcHJvY2Vzc2VzCiAgICAgICAgc2VsZi5wcm9jZXNzZXNbJ2F0bGFzX3RyYWluZXInXSA9IG1wLlByb2Nlc3MoCiAgICAgICAgICAgIHRhcmdldD1ndWFyZGVkX3J1biwKICAgICAgICAgICAgYXJncz0oc2VsZi5fcnVuX2F0bGFzX3RyYWluZXIsICdhdGxhc190cmFpbmVyJywgc2VsZi5yZWNvdmVyeV9tZ3IpCiAgICAgICAgKQogICAgICAgIHNlbGYucHJvY2Vzc2VzWydlbnRyb3B5X3RyYWluZXInXSA9IG1wLlByb2Nlc3MoCiAgICAgICAgICAgIHRhcmdldD1ndWFyZGVkX3J1biwKICAgICAgICAgICAgYXJncz0oc2VsZi5fcnVuX2VudHJvcHlfdHJhaW5lciwgJ2VudHJvcHlfdHJhaW5lcicsIHNlbGYucmVjb3ZlcnlfbWdyKQogICAgICAgICkKICAgICAgICAKICAgICAgICAjIDIuIFN0YXJ0IFNlbGYtUGxheSBBY3RvcnMKICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLmNvbmZpZy5udW1fYXRsYXNfYWN0b3JzKToKICAgICAgICAgICAgbmFtZSA9IGYnYXRsYXNfYWN0b3Jfe2l9JwogICAgICAgICAgICBzZWxmLnByb2Nlc3Nlc1tuYW1lXSA9IG1wLlByb2Nlc3MoCiAgICAgICAgICAgICAgICB0YXJnZXQ9Z3VhcmRlZF9ydW4sCiAgICAgICAgICAgICAgICBhcmdzPShzZWxmLl9ydW5fYXRsYXNfYWN0b3IsIG5hbWUsIHNlbGYucmVjb3ZlcnlfbWdyLCBpKQogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgIGZvciBpIGluIHJhbmdlKHNlbGYuY29uZmlnLm51bV9lbnRyb3B5X2FjdG9ycyk6CiAgICAgICAgICAgIG5hbWUgPSBmJ2VudHJvcHlfYWN0b3Jfe2l9JwogICAgICAgICAgICBzZWxmLnByb2Nlc3Nlc1tuYW1lXSA9IG1wLlByb2Nlc3MoCiAgICAgICAgICAgICAgICB0YXJnZXQ9Z3VhcmRlZF9ydW4sCiAgICAgICAgICAgICAgICBhcmdzPShzZWxmLl9ydW5fZW50cm9weV9hY3RvciwgbmFtZSwgc2VsZi5yZWNvdmVyeV9tZ3IsIGkpCiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgIyAzLiBTdGFydCBFdmFsdWF0b3IKICAgICAgICBzZWxmLnByb2Nlc3Nlc1snZXZhbHVhdG9yJ10gPSBtcC5Qcm9jZXNzKAogICAgICAgICAgICB0YXJnZXQ9Z3VhcmRlZF9ydW4sCiAgICAgICAgICAgIGFyZ3M9KHNlbGYuX3J1bl9ldmFsdWF0b3IsICdldmFsdWF0b3InLCBzZWxmLnJlY292ZXJ5X21ncikKICAgICAgICApCgogICAgICAgIGZvciBwIGluIHNlbGYucHJvY2Vzc2VzLnZhbHVlcygpOgogICAgICAgICAgICBwLnN0YXJ0KCkKICAgICAgICAgICAgCiAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzWydzdGF0dXMnXSA9ICdydW5uaW5nJwogICAgICAgIAogICAgICAgICMgNC4gU3VwZXJ2aXNvciBMb29wIChXYXRjaGRvZyAmIENoZWNrcG9pbnRpbmcpCiAgICAgICAgbGFzdF9taWNyb19jcCA9IHRpbWUudGltZSgpCiAgICAgICAgbGFzdF9saWdodF9jcCA9IHRpbWUudGltZSgpCiAgICAgICAgbGFzdF9mdWxsX2NwID0gdGltZS50aW1lKCkKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIG5vdCBzZWxmLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgUHJvY2VzcyBNZXRyaWNzCiAgICAgICAgICAgICAgICB3aGlsZSBub3Qgc2VsZi5xdWV1ZXNbJ21ldHJpY3MnXS5lbXB0eSgpOgogICAgICAgICAgICAgICAgICAgIG0gPSBzZWxmLnF1ZXVlc1snbWV0cmljcyddLmdldCgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIubG9nKG0pCgogICAgICAgICAgICAgICAgIyBIZWFsdGggQ2hlY2sKICAgICAgICAgICAgICAgIGhlYWx0aCA9IHNlbGYucmVjb3ZlcnlfbWdyLmNoZWNrX3N5c3RlbV9oZWFsdGgoKQogICAgICAgICAgICAgICAgaWYgaGVhbHRoID09ICJob3QiOgogICAgICAgICAgICAgICAgICAgIHNlbGYucGF1c2VfZXZlbnQuc2V0KCkKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDYwKQogICAgICAgICAgICAgICAgICAgIHNlbGYucGF1c2VfZXZlbnQuY2xlYXIoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIENoZWNrcG9pbnRpbmcgbG9naWMKICAgICAgICAgICAgICAgIG5vdyA9IHRpbWUudGltZSgpCiAgICAgICAgICAgICAgICBpZiBub3cgLSBsYXN0X21pY3JvX2NwID4gMzAwOiAjIDVtCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2F2ZV9jaGVja3BvaW50KCdtaWNybycpCiAgICAgICAgICAgICAgICAgICAgbGFzdF9taWNyb19jcCA9IG5vdwogICAgICAgICAgICAgICAgaWYgbm93IC0gbGFzdF9saWdodF9jcCA+IDkwMDogIyAxNW0KICAgICAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX2NoZWNrcG9pbnQoJ2xpZ2h0JykKICAgICAgICAgICAgICAgICAgICBsYXN0X2xpZ2h0X2NwID0gbm93CiAgICAgICAgICAgICAgICBpZiBub3cgLSBsYXN0X2Z1bGxfY3AgPiAzNjAwOiAjIDYwbQogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfY2hlY2twb2ludCgnZnVsbCcpCiAgICAgICAgICAgICAgICAgICAgbGFzdF9mdWxsX2NwID0gbm93CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIE1vbml0b3IgcHJvY2Vzc2VzCiAgICAgICAgICAgICAgICBmb3IgbmFtZSwgcCBpbiBzZWxmLnByb2Nlc3Nlcy5pdGVtcygpOgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBwLmlzX2FsaXZlKCkgYW5kIG5vdCBzZWxmLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiUHJvY2VzcyB7bmFtZX0gZGllZC4gUmVzdGFydGluZy4uLiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdhY3RvcicgaW4gbmFtZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBpbnQobmFtZS5zcGxpdCgnXycpWy0xXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHNlbGYuX3J1bl9hdGxhc19hY3RvciBpZiAnYXRsYXMnIGluIG5hbWUgZWxzZSBzZWxmLl9ydW5fZW50cm9weV9hY3RvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3AgPSBtcC5Qcm9jZXNzKHRhcmdldD1ndWFyZGVkX3J1biwgYXJncz0odGFyZ2V0LCBuYW1lLCBzZWxmLnJlY292ZXJ5X21nciwgaSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgbmFtZSA9PSAnZXZhbHVhdG9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19wID0gbXAuUHJvY2Vzcyh0YXJnZXQ9Z3VhcmRlZF9ydW4sIGFyZ3M9KHNlbGYuX3J1bl9ldmFsdWF0b3IsIG5hbWUsIHNlbGYucmVjb3ZlcnlfbWdyKSkKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBuYW1lID09ICdhdGxhc190cmFpbmVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19wID0gbXAuUHJvY2Vzcyh0YXJnZXQ9Z3VhcmRlZF9ydW4sIGFyZ3M9KHNlbGYuX3J1bl9hdGxhc190cmFpbmVyLCBuYW1lLCBzZWxmLnJlY292ZXJ5X21ncikpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgbmFtZSA9PSAnZW50cm9weV90cmFpbmVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19wID0gbXAuUHJvY2Vzcyh0YXJnZXQ9Z3VhcmRlZF9ydW4sIGFyZ3M9KHNlbGYuX3J1bl9lbnRyb3B5X3RyYWluZXIsIG5hbWUsIHNlbGYucmVjb3ZlcnlfbWdyKSkKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBuZXdfcC5zdGFydCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucHJvY2Vzc2VzW25hbWVdID0gbmV3X3AKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLnN0b3BfZXZlbnQuc2V0KCkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBzZWxmLl9zYXZlX2NoZWNrcG9pbnQoJ2Z1bGwnKQogICAgICAgICAgICBmb3IgcCBpbiBzZWxmLnByb2Nlc3Nlcy52YWx1ZXMoKToKICAgICAgICAgICAgICAgIHAudGVybWluYXRlKCkKICAgICAgICAgICAgICAgIHAuam9pbigpCgogICAgZGVmIF9zYXZlX2NoZWNrcG9pbnQoc2VsZiwgdHlwZSk6CiAgICAgICAgcHJpbnQoZiLwn5K+IFNhdmluZyB7dHlwZX0gY2hlY2twb2ludC4uLiIpCiAgICAgICAgIyBDb2xsZWN0IGRhdGEgZnJvbSB0cmFpbmVycyAoaWYgdGhleSB3ZXJlIHJ1bm5pbmcgYW5kIHNoYXJlZCB0aGVpciBzdGF0ZSkKICAgICAgICAjIEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgd2UnZCB1c2UgYSBzaGFyZWQgZGljdCBvciBhIHJlcXVlc3QtcmVzcG9uc2UgcGF0dGVybi4KICAgICAgICAjIEZvciBub3csIGxldCdzIGFzc3VtZSB0cmFpbmVycyByZWd1bGFybHkgdXBkYXRlIGEgJ2xhdGVzdF93ZWlnaHRzJyBpbiBzaGFyZWRfdmFsdWVzLgogICAgICAgIAogICAgICAgIGNvbnRlbnQgPSB7CiAgICAgICAgICAgICdhdGxhc19tb2RlbCc6IHNlbGYuc2hhcmVkX3ZhbHVlcy5nZXQoJ2F0bGFzX3dlaWdodHMnKSwKICAgICAgICAgICAgJ2VudHJvcHlfbW9kZWwnOiBzZWxmLnNoYXJlZF92YWx1ZXMuZ2V0KCdlbnRyb3B5X3dlaWdodHMnKSwKICAgICAgICAgICAgJ2F0bGFzX29wdCc6IHNlbGYuc2hhcmVkX3ZhbHVlcy5nZXQoJ2F0bGFzX29wdF9zdGF0ZScpLAogICAgICAgICAgICAnZW50cm9weV9vcHQnOiBzZWxmLnNoYXJlZF92YWx1ZXMuZ2V0KCdlbnRyb3B5X29wdF9zdGF0ZScpLAogICAgICAgICAgICAncm5nX3N0YXRlcyc6IHsKICAgICAgICAgICAgICAgICd0b3JjaCc6IHRvcmNoLmdldF9ybmdfc3RhdGUoKSwKICAgICAgICAgICAgICAgICdudW1weSc6IG5wLnJhbmRvbS5nZXRfc3RhdGUoKSwKICAgICAgICAgICAgICAgICdweXRob24nOiByYW5kb20uZ2V0c3RhdGUoKQogICAgICAgICAgICB9LAogICAgICAgICAgICAnYXRsYXNfc3RlcCc6IHNlbGYuc2hhcmVkX3ZhbHVlc1snYXRsYXNfc3RlcHMnXSwKICAgICAgICAgICAgJ2VudHJvcHlfc3RlcCc6IHNlbGYuc2hhcmVkX3ZhbHVlc1snZW50cm9weV9zdGVwcyddLAogICAgICAgICAgICAnYXRsYXNfZ2FtZXMnOiBzZWxmLnNoYXJlZF92YWx1ZXNbJ2F0bGFzX2dhbWVzJ10sCiAgICAgICAgICAgICdlbnRyb3B5X2dhbWVzJzogc2VsZi5zaGFyZWRfdmFsdWVzWydlbnRyb3B5X2dhbWVzJ10sCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIHR5cGUgPT0gJ2Z1bGwnOgogICAgICAgICAgICAjIFRoaXMgaXMgaGFyZCB2aWEgTVAgcXVldWVzLiAKICAgICAgICAgICAgIyBJZGVhbGx5LCB0aGUgdHJhaW5lcnMgd291bGQgc2F2ZSB0aGVpciBidWZmZXJzIHRvIGRpc2sgYW5kIHdlIGp1c3QgbW92ZSB0aGVtLgogICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIAogICAgICAgIHNlbGYuY3BfbWdyLnNhdmUoY29udGVudCwgdHlwZT10eXBlKQoKICAgIGRlZiBfcnVuX2F0bGFzX3RyYWluZXIoc2VsZik6CiAgICAgICAgdHJhaW5lciA9IEF0bGFzVHJhaW5lcihzZWxmLmNvbmZpZywgc2VsZi5xdWV1ZXNbJ2F0bGFzX2RhdGEnXSwgc2VsZi5xdWV1ZXNbJ2F0bGFzX3dlaWdodHMnXSwgc2VsZi5zdG9wX2V2ZW50LCBzZWxmLnF1ZXVlc1snbWV0cmljcyddLCBzZWxmLnNoYXJlZF92YWx1ZXMpCiAgICAgICAgb3JpZ2luYWxfdHJhaW5fc3RlcCA9IHRyYWluZXIuX3RyYWluX3N0ZXAKICAgICAgICBkZWYgbG9ja2VkX3RyYWluX3N0ZXAoKToKICAgICAgICAgICAgIyBBVExBUyBQcmlvcml0eSBsb2dpYwogICAgICAgICAgICBhY3F1aXJlZCA9IEZhbHNlCiAgICAgICAgICAgIHdoaWxlIG5vdCBhY3F1aXJlZCBhbmQgbm90IHNlbGYuc3RvcF9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgICAgIGlmIHNlbGYudHJhaW5pbmdfbG9jay5hY3F1aXJlKHRpbWVvdXQ9MC4xKToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsX3RyYWluX3N0ZXAoKQogICAgICAgICAgICAgICAgICAgICAgICBhY3F1aXJlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYWluaW5nX2xvY2sucmVsZWFzZSgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wMSkKICAgICAgICB0cmFpbmVyLl90cmFpbl9zdGVwID0gbG9ja2VkX3RyYWluX3N0ZXAKICAgICAgICB0cmFpbmVyLnJ1bigpCgogICAgZGVmIF9ydW5fZW50cm9weV90cmFpbmVyKHNlbGYpOgogICAgICAgIHRyYWluZXIgPSBFbnRyb3B5VHJhaW5lcihzZWxmLmNvbmZpZywgc2VsZi5xdWV1ZXNbJ2VudHJvcHlfZGF0YSddLCBzZWxmLnF1ZXVlc1snZW50cm9weV93ZWlnaHRzJ10sIHNlbGYuc3RvcF9ldmVudCwgc2VsZi5xdWV1ZXNbJ21ldHJpY3MnXSwgc2VsZi5zaGFyZWRfdmFsdWVzKQogICAgICAgIG9yaWdpbmFsX3RyYWluX3N0ZXAgPSB0cmFpbmVyLl90cmFpbl9zdGVwCiAgICAgICAgZGVmIGxvY2tlZF90cmFpbl9zdGVwKCk6CiAgICAgICAgICAgIGFjcXVpcmVkID0gRmFsc2UKICAgICAgICAgICAgd2hpbGUgbm90IGFjcXVpcmVkIGFuZCBub3Qgc2VsZi5zdG9wX2V2ZW50LmlzX3NldCgpOgogICAgICAgICAgICAgICAgIyBFTlRST1BZIG1pZ2h0IHdhaXQgaWYgQVRMQVMgd2FudHMgdGhlIGxvY2sKICAgICAgICAgICAgICAgIGlmIHJhbmRvbS5yYW5kb20oKSA8IDAuNDogIyBPbmx5IHRyeSBpZiB3ZSBwYXNzIHRoZSA0MCUgY2hhbmNlIHdoZW4gY29tcGV0aW5nPwogICAgICAgICAgICAgICAgICAgICMgQmV0dGVyOiB0cnkgdG8gYWNxdWlyZSwgYnV0IEFUTEFTIGhhcyBoaWdoZXIgY2hhbmNlIG9yIHByaW9yaXR5CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZWxmLnRyYWluaW5nX2xvY2suYWNxdWlyZSh0aW1lb3V0PTAuMSk6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbF90cmFpbl9zdGVwKCkKICAgICAgICAgICAgICAgICAgICAgICAgYWNxdWlyZWQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50cmFpbmluZ19sb2NrLnJlbGVhc2UoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDAuMDUpICMgV2FpdCBsb25nZXIgdGhhbiBBVExBUwogICAgICAgIHRyYWluZXIuX3RyYWluX3N0ZXAgPSBsb2NrZWRfdHJhaW5fc3RlcAogICAgICAgIHRyYWluZXIucnVuKCkKCiAgICBkZWYgX3J1bl9hdGxhc19hY3RvcihzZWxmLCB3b3JrZXJfaWQpOgogICAgICAgIHdvcmtlciA9IEF0bGFzU2VsZlBsYXlXb3JrZXIoc2VsZi5jb25maWcsIHNlbGYucXVldWVzWydhdGxhc193ZWlnaHRzJ10sIHNlbGYucXVldWVzWydhdGxhc19kYXRhJ10sIHNlbGYuc3RvcF9ldmVudCwgd29ya2VyX2lkKQogICAgICAgIHdvcmtlci5ydW4oKQoKICAgIGRlZiBfcnVuX2VudHJvcHlfYWN0b3Ioc2VsZiwgd29ya2VyX2lkKToKICAgICAgICB3b3JrZXIgPSBFbnRyb3B5U2VsZlBsYXlXb3JrZXIoc2VsZi5jb25maWcsIHNlbGYucXVldWVzWydlbnRyb3B5X3dlaWdodHMnXSwgc2VsZi5xdWV1ZXNbJ2VudHJvcHlfZGF0YSddLCBzZWxmLnN0b3BfZXZlbnQsIHdvcmtlcl9pZCkKICAgICAgICB3b3JrZXIucnVuKCkKCiAgICBkZWYgX3J1bl9ldmFsdWF0b3Ioc2VsZik6CiAgICAgICAgcHJpbnQoIkV2YWx1YXRvciBzdGFydGVkLiIpCiAgICAgICAgYXJlbmEgPSBBcmVuYShzZWxmLmNvbmZpZywgc2VsZi5xdWV1ZXNbJ21ldHJpY3MnXSwgc2VsZi5zaGFyZWRfdmFsdWVzKQogICAgICAgIAogICAgICAgICMgV2UgbmVlZCBtb2RlbHMgdG8gcGxheS4gRXZhbHVhdG9yIHdpbGwgbG9hZCBsYXRlc3Qgd2VpZ2h0cyBmcm9tIHNoYXJlZF92YWx1ZXMuCiAgICAgICAgZnJvbSBwcm9tZXRoZXVzX3RxZmQuYXRsYXMubmV0d29yayBpbXBvcnQgQXRsYXNOZXR3b3JrCiAgICAgICAgZnJvbSBwcm9tZXRoZXVzX3RxZmQuZW50cm9weS5uZXR3b3JrIGltcG9ydCBFbnRyb3B5TmV0d29yawogICAgICAgIGF0bGFzX21vZGVsID0gQXRsYXNOZXR3b3JrKHNlbGYuY29uZmlnKS50byhzZWxmLmNvbmZpZy5kZXZpY2UpCiAgICAgICAgZW50cm9weV9tb2RlbCA9IEVudHJvcHlOZXR3b3JrKHNlbGYuY29uZmlnKS50byhzZWxmLmNvbmZpZy5kZXZpY2UpCiAgICAgICAgCiAgICAgICAgbGFzdF9ldmFsX3RvdGFsX2dhbWVzID0gMAogICAgICAgIAogICAgICAgIHdoaWxlIG5vdCBzZWxmLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgICAgIGN1cnJlbnRfdG90YWxfZ2FtZXMgPSBzZWxmLnNoYXJlZF92YWx1ZXNbJ2F0bGFzX2dhbWVzJ10gKyBzZWxmLnNoYXJlZF92YWx1ZXNbJ2VudHJvcHlfZ2FtZXMnXQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgY3VycmVudF90b3RhbF9nYW1lcyAtIGxhc3RfZXZhbF90b3RhbF9nYW1lcyA+PSBzZWxmLmNvbmZpZy5ldmFsX2ludGVydmFsX2dhbWVzOgogICAgICAgICAgICAgICAgcHJpbnQoZiLimpTvuI8gU3RhcnRpbmcgRHVlbHMgYXQge2N1cnJlbnRfdG90YWxfZ2FtZXN9IGdhbWVzLi4uIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBMb2FkIGxhdGVzdCB3ZWlnaHRzCiAgICAgICAgICAgICAgICBpZiBzZWxmLnNoYXJlZF92YWx1ZXMuZ2V0KCdhdGxhc193ZWlnaHRzJyk6CiAgICAgICAgICAgICAgICAgICAgYXRsYXNfbW9kZWwubG9hZF9zdGF0ZV9kaWN0KHNlbGYuc2hhcmVkX3ZhbHVlc1snYXRsYXNfd2VpZ2h0cyddKQogICAgICAgICAgICAgICAgaWYgc2VsZi5zaGFyZWRfdmFsdWVzLmdldCgnZW50cm9weV93ZWlnaHRzJyk6CiAgICAgICAgICAgICAgICAgICAgZW50cm9weV9tb2RlbC5sb2FkX3N0YXRlX2RpY3Qoc2VsZi5zaGFyZWRfdmFsdWVzWydlbnRyb3B5X3dlaWdodHMnXSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBTZXR1cCBwbGF5ZXJzCiAgICAgICAgICAgICAgICBwX2F0bGFzID0gTk5QbGF5ZXIoYXRsYXNfbW9kZWwsIHNlbGYuY29uZmlnLCBhcmVuYS5tb3ZlX2VuY29kZXIsIGFyZW5hLmJvYXJkX2VuY29kZXIsIGlzX21jdHM9VHJ1ZSkKICAgICAgICAgICAgICAgIHBfZW50cm9weSA9IE5OUGxheWVyKGVudHJvcHlfbW9kZWwsIHNlbGYuY29uZmlnLCBhcmVuYS5tb3ZlX2VuY29kZXIsIGFyZW5hLmJvYXJkX2VuY29kZXIsIGFyZW5hLmZpZWxkX2NhbGMsIGlzX21jdHM9RmFsc2UpCiAgICAgICAgICAgICAgICBwX3JhbmRvbSA9IFJhbmRvbVBsYXllcigpCiAgICAgICAgICAgICAgICBwX2hldXJpc3RpYyA9IEhldXJpc3RpY1BsYXllcigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHJlc3VsdHMgPSB7J2F0bGFzX3dpbnMnOiAwLCAnZW50cm9weV93aW5zJzogMCwgJ2RyYXdzJzogMH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyAxLiBBdGxhcyB2cyBFbnRyb3B5CiAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLmNvbmZpZy5ldmFsX2dhbWVzX3Blcl9kdWVsKToKICAgICAgICAgICAgICAgICAgICAjIEFsdGVybmF0ZSBjb2xvcnMKICAgICAgICAgICAgICAgICAgICBpZiBpICUgMiA9PSAwOiByZXMgPSBhcmVuYS5wbGF5X2dhbWUocF9hdGxhcywgcF9lbnRyb3B5KQogICAgICAgICAgICAgICAgICAgIGVsc2U6IHJlcyA9IGFyZW5hLnBsYXlfZ2FtZShwX2VudHJvcHksIHBfYXRsYXMpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgcmVzID09ICIxLTAiOiAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaSAlIDIgPT0gMDogcmVzdWx0c1snYXRsYXNfd2lucyddICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogcmVzdWx0c1snZW50cm9weV93aW5zJ10gKz0gMQogICAgICAgICAgICAgICAgICAgIGVsaWYgcmVzID09ICIwLTEiOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBpICUgMiA9PSAwOiByZXN1bHRzWydlbnRyb3B5X3dpbnMnXSArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6IHJlc3VsdHNbJ2F0bGFzX3dpbnMnXSArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1snZHJhd3MnXSArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXJlbmEudXBkYXRlX2VsbyhyZXN1bHRzKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIDIuIEJhc2VsaW5lcyAob3B0aW9uYWwsIGZvciBtZXRyaWNzKQogICAgICAgICAgICAgICAgIyAuLi4gYW5hbG9nb3VzIGxvZ2ljIGZvciByYW5kb20vaGV1cmlzdGljIC4uLgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLnF1ZXVlc1snbWV0cmljcyddLnB1dCh7CiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnZHVlbCcsCiAgICAgICAgICAgICAgICAgICAgJ3Jlc3VsdHMnOiByZXN1bHRzLAogICAgICAgICAgICAgICAgICAgICdhdGxhc19lbG8nOiBzZWxmLnNoYXJlZF92YWx1ZXNbJ2F0bGFzX2VsbyddLAogICAgICAgICAgICAgICAgICAgICdlbnRyb3B5X2Vsbyc6IHNlbGYuc2hhcmVkX3ZhbHVlc1snZW50cm9weV9lbG8nXQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGFzdF9ldmFsX3RvdGFsX2dhbWVzID0gY3VycmVudF90b3RhbF9nYW1lcwogICAgICAgICAgICAKICAgICAgICAgICAgdGltZS5zbGVlcCg2MCkK")
write_file_b64("prometheus_tqfd/orchestration/checkpoint.py", "aW1wb3J0IHRvcmNoCmltcG9ydCBqc29uCmltcG9ydCBzaHV0aWwKaW1wb3J0IHBpY2tsZQppbXBvcnQgbHo0LmZyYW1lCmltcG9ydCByYW5kb20KaW1wb3J0IG51bXB5IGFzIG5wCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQppbXBvcnQgdXVpZAoKY2xhc3MgQ2hlY2twb2ludE1hbmFnZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZmlnKToKICAgICAgICBzZWxmLmNvbmZpZyA9IGNvbmZpZwogICAgICAgIHNlbGYucnVuX2RpciA9IGNvbmZpZy5iYXNlX2RpciAvIGNvbmZpZy5ydW5faWQKICAgICAgICBzZWxmLmNoZWNrcG9pbnRfZGlyID0gc2VsZi5ydW5fZGlyIC8gJ2NoZWNrcG9pbnRzJwogICAgICAgIHNlbGYuY2hlY2twb2ludF9kaXIubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQoKICAgIGRlZiBzYXZlKHNlbGYsIGNvbnRlbnQsIHR5cGU9J2xpZ2h0Jyk6CiAgICAgICAgdGltZXN0YW1wID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVZJW0lZF8lSCVNJVMnKQogICAgICAgIGNwX3BhdGggPSBzZWxmLmNoZWNrcG9pbnRfZGlyIC8gZiJjaGVja3BvaW50X3t0eXBlfV97dGltZXN0YW1wfSIKICAgICAgICBjcF9wYXRoLm1rZGlyKGV4aXN0X29rPVRydWUpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIE1vZGVscyAoYWx3YXlzIHNhdmVkKQogICAgICAgICAgICBpZiBjb250ZW50LmdldCgnYXRsYXNfbW9kZWwnKToKICAgICAgICAgICAgICAgIHRvcmNoLnNhdmUoY29udGVudFsnYXRsYXNfbW9kZWwnXSwgY3BfcGF0aCAvICdhdGxhc19tb2RlbC5wdCcpCiAgICAgICAgICAgIGlmIGNvbnRlbnQuZ2V0KCdlbnRyb3B5X21vZGVsJyk6CiAgICAgICAgICAgICAgICB0b3JjaC5zYXZlKGNvbnRlbnRbJ2VudHJvcHlfbW9kZWwnXSwgY3BfcGF0aCAvICdlbnRyb3B5X21vZGVsLnB0JykKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHR5cGUgaW4gWydsaWdodCcsICdmdWxsJ106CiAgICAgICAgICAgICAgICBpZiBjb250ZW50LmdldCgnYXRsYXNfb3B0Jyk6IHRvcmNoLnNhdmUoY29udGVudFsnYXRsYXNfb3B0J10sIGNwX3BhdGggLyAnYXRsYXNfb3B0LnB0JykKICAgICAgICAgICAgICAgIGlmIGNvbnRlbnQuZ2V0KCdlbnRyb3B5X29wdCcpOiB0b3JjaC5zYXZlKGNvbnRlbnRbJ2VudHJvcHlfb3B0J10sIGNwX3BhdGggLyAnZW50cm9weV9vcHQucHQnKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIFJORyBzdGF0ZXMKICAgICAgICAgICAgICAgIHJuZ19zdGF0ZXMgPSB7CiAgICAgICAgICAgICAgICAgICAgJ3RvcmNoJzogdG9yY2guZ2V0X3JuZ19zdGF0ZSgpLAogICAgICAgICAgICAgICAgICAgICdudW1weSc6IG5wLnJhbmRvbS5nZXRfc3RhdGUoKSwKICAgICAgICAgICAgICAgICAgICAncHl0aG9uJzogcmFuZG9tLmdldHN0YXRlKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIHRvcmNoLmN1ZGEuaXNfYXZhaWxhYmxlKCk6CiAgICAgICAgICAgICAgICAgICAgcm5nX3N0YXRlc1snY3VkYSddID0gdG9yY2guY3VkYS5nZXRfcm5nX3N0YXRlX2FsbCgpCiAgICAgICAgICAgICAgICB0b3JjaC5zYXZlKHJuZ19zdGF0ZXMsIGNwX3BhdGggLyAncm5nX3N0YXRlcy5wdCcpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG1ldGFkYXRhID0gewogICAgICAgICAgICAgICAgICAgICdhdGxhc19zdGVwJzogY29udGVudC5nZXQoJ2F0bGFzX3N0ZXAnLCAwKSwKICAgICAgICAgICAgICAgICAgICAnZW50cm9weV9zdGVwJzogY29udGVudC5nZXQoJ2VudHJvcHlfc3RlcCcsIDApLAogICAgICAgICAgICAgICAgICAgICdhdGxhc19nYW1lcyc6IGNvbnRlbnQuZ2V0KCdhdGxhc19nYW1lcycsIDApLAogICAgICAgICAgICAgICAgICAgICdlbnRyb3B5X2dhbWVzJzogY29udGVudC5nZXQoJ2VudHJvcHlfZ2FtZXMnLCAwKSwKICAgICAgICAgICAgICAgICAgICAndGltZXN0YW1wJzogdGltZXN0YW1wLAogICAgICAgICAgICAgICAgICAgICd0eXBlJzogdHlwZSwKICAgICAgICAgICAgICAgICAgICAnY29uZmlnJzogdmFycyhzZWxmLmNvbmZpZykgaWYgaGFzYXR0cihzZWxmLmNvbmZpZywgJ19fZGljdF9fJykgZWxzZSB7fQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKGNwX3BhdGggLyAnbWV0YWRhdGEuanNvbicsICd3JykgYXMgZjoKICAgICAgICAgICAgICAgICAgICBqc29uLmR1bXAobWV0YWRhdGEsIGYsIGluZGVudD0yLCBkZWZhdWx0PXN0cikKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgdHlwZSA9PSAnZnVsbCc6CiAgICAgICAgICAgICAgICAjIFJlcGxheSBidWZmZXJzCiAgICAgICAgICAgICAgICBpZiBjb250ZW50LmdldCgnYXRsYXNfcmVwbGF5Jyk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBsejQuZnJhbWUub3BlbihjcF9wYXRoIC8gJ2F0bGFzX3JlcGxheS5sejQnLCAnd2InKSBhcyBmOgogICAgICAgICAgICAgICAgICAgICAgICBwaWNrbGUuZHVtcChjb250ZW50WydhdGxhc19yZXBsYXknXSwgZikKICAgICAgICAgICAgICAgIGlmIGNvbnRlbnQuZ2V0KCdlbnRyb3B5X3JlcGxheScpOgogICAgICAgICAgICAgICAgICAgIHdpdGggbHo0LmZyYW1lLm9wZW4oY3BfcGF0aCAvICdlbnRyb3B5X3JlcGxheS5sejQnLCAnd2InKSBhcyBmOgogICAgICAgICAgICAgICAgICAgICAgICBwaWNrbGUuZHVtcChjb250ZW50WydlbnRyb3B5X3JlcGxheSddLCBmKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAjIFBvaW50ZXIgdXBkYXRlCiAgICAgICAgICAgIHdpdGggb3BlbihzZWxmLmNoZWNrcG9pbnRfZGlyIC8gJ2xhdGVzdF9wb2ludGVyLmpzb24nLCAndycpIGFzIGY6CiAgICAgICAgICAgICAgICBqc29uLmR1bXAoeydwYXRoJzogc3RyKGNwX3BhdGgpLCAndHlwZSc6IHR5cGV9LCBmKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICMgUm90YXRpb24KICAgICAgICAgICAgc2VsZi5fcm90YXRlX2NoZWNrcG9pbnRzKCkKCiAgICAgICAgICAgICMgSWYgdXNlX2RyaXZlLCBjb3B5IHRvIGRyaXZlCiAgICAgICAgICAgIGlmIHNlbGYuY29uZmlnLnVzZV9kcml2ZToKICAgICAgICAgICAgICAgIHNlbGYuX3N5bmNfdG9fZHJpdmUoY3BfcGF0aCkKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJFcnJvciBzYXZpbmcgY2hlY2twb2ludDoge2V9IikKICAgICAgICAgICAgaW1wb3J0IHRyYWNlYmFjawogICAgICAgICAgICB0cmFjZWJhY2sucHJpbnRfZXhjKCkKCiAgICBkZWYgX3JvdGF0ZV9jaGVja3BvaW50cyhzZWxmKToKICAgICAgICBjcHMgPSBzb3J0ZWQobGlzdChzZWxmLmNoZWNrcG9pbnRfZGlyLmdsb2IoJ2NoZWNrcG9pbnRfKicpKSwga2V5PWxhbWJkYSB4OiB4LnN0YXQoKS5zdF9tdGltZSkKICAgICAgICB3aGlsZSBsZW4oY3BzKSA+IHNlbGYuY29uZmlnLmNoZWNrcG9pbnRfa2VlcF9uOgogICAgICAgICAgICBvbGRlc3QgPSBjcHMucG9wKDApCiAgICAgICAgICAgIHNodXRpbC5ybXRyZWUob2xkZXN0LCBpZ25vcmVfZXJyb3JzPVRydWUpCgogICAgZGVmIF9zeW5jX3RvX2RyaXZlKHNlbGYsIGNwX3BhdGgpOgogICAgICAgIGRyaXZlX3BhdGggPSBQYXRoKCcvY29udGVudC9kcml2ZS9NeURyaXZlL3Byb21ldGhldXNfY2hlc3MnKSAvIHNlbGYuY29uZmlnLnJ1bl9pZCAvICdjaGVja3BvaW50cycgLyBjcF9wYXRoLm5hbWUKICAgICAgICBkcml2ZV9wYXRoLm1rZGlyKHBhcmVudHM9VHJ1ZSwgZXhpc3Rfb2s9VHJ1ZSkKICAgICAgICAjIENvcHkgZmlsZXMgKG9ubHkgbW9kZWxzL21ldGFkYXRhIGZvciBsaWdodCwgZXZlcnl0aGluZyBmb3IgZnVsbCkKICAgICAgICBmb3IgZiBpbiBjcF9wYXRoLml0ZXJkaXIoKToKICAgICAgICAgICAgc2h1dGlsLmNvcHkyKGYsIGRyaXZlX3BhdGggLyBmLm5hbWUpCgogICAgZGVmIGxvYWRfbGF0ZXN0KHNlbGYpOgogICAgICAgIHBvaW50ZXJfZmlsZSA9IHNlbGYuY2hlY2twb2ludF9kaXIgLyAnbGF0ZXN0X3BvaW50ZXIuanNvbicKICAgICAgICBpZiBub3QgcG9pbnRlcl9maWxlLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICAKICAgICAgICB3aXRoIG9wZW4ocG9pbnRlcl9maWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIHBvaW50ZXIgPSBqc29uLmxvYWQoZikKICAgICAgICAgICAgCiAgICAgICAgY3BfcGF0aCA9IFBhdGgocG9pbnRlclsncGF0aCddKQogICAgICAgIGlmIG5vdCBjcF9wYXRoLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICAKICAgICAgICBwcmludChmIvCflIQgTG9hZGluZyBjaGVja3BvaW50IGZyb20ge2NwX3BhdGh9IikKICAgICAgICBjb250ZW50ID0ge30KICAgICAgICBpZiAoY3BfcGF0aCAvICdhdGxhc19tb2RlbC5wdCcpLmV4aXN0cygpOgogICAgICAgICAgICBjb250ZW50WydhdGxhc19tb2RlbCddID0gdG9yY2gubG9hZChjcF9wYXRoIC8gJ2F0bGFzX21vZGVsLnB0JywgbWFwX2xvY2F0aW9uPSdjcHUnLCB3ZWlnaHRzX29ubHk9RmFsc2UpCiAgICAgICAgaWYgKGNwX3BhdGggLyAnZW50cm9weV9tb2RlbC5wdCcpLmV4aXN0cygpOgogICAgICAgICAgICBjb250ZW50WydlbnRyb3B5X21vZGVsJ10gPSB0b3JjaC5sb2FkKGNwX3BhdGggLyAnZW50cm9weV9tb2RlbC5wdCcsIG1hcF9sb2NhdGlvbj0nY3B1Jywgd2VpZ2h0c19vbmx5PUZhbHNlKQogICAgICAgIAogICAgICAgIGlmIChjcF9wYXRoIC8gJ2F0bGFzX29wdC5wdCcpLmV4aXN0cygpOgogICAgICAgICAgICBjb250ZW50WydhdGxhc19vcHQnXSA9IHRvcmNoLmxvYWQoY3BfcGF0aCAvICdhdGxhc19vcHQucHQnLCBtYXBfbG9jYXRpb249J2NwdScsIHdlaWdodHNfb25seT1GYWxzZSkKICAgICAgICBpZiAoY3BfcGF0aCAvICdlbnRyb3B5X29wdC5wdCcpLmV4aXN0cygpOgogICAgICAgICAgICBjb250ZW50WydlbnRyb3B5X29wdCddID0gdG9yY2gubG9hZChjcF9wYXRoIC8gJ2VudHJvcHlfb3B0LnB0JywgbWFwX2xvY2F0aW9uPSdjcHUnLCB3ZWlnaHRzX29ubHk9RmFsc2UpCiAgICAgICAgICAgIAogICAgICAgIGlmIChjcF9wYXRoIC8gJ3JuZ19zdGF0ZXMucHQnKS5leGlzdHMoKToKICAgICAgICAgICAgcm5nX3N0YXRlcyA9IHRvcmNoLmxvYWQoY3BfcGF0aCAvICdybmdfc3RhdGVzLnB0JywgbWFwX2xvY2F0aW9uPSdjcHUnLCB3ZWlnaHRzX29ubHk9RmFsc2UpCiAgICAgICAgICAgIHRvcmNoLnNldF9ybmdfc3RhdGUocm5nX3N0YXRlc1sndG9yY2gnXSkKICAgICAgICAgICAgbnAucmFuZG9tLnNldF9zdGF0ZShybmdfc3RhdGVzWydudW1weSddKQogICAgICAgICAgICByYW5kb20uc2V0c3RhdGUocm5nX3N0YXRlc1sncHl0aG9uJ10pCiAgICAgICAgICAgIGlmICdjdWRhJyBpbiBybmdfc3RhdGVzIGFuZCB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgICAgICAgICAgdG9yY2guY3VkYS5zZXRfcm5nX3N0YXRlX2FsbChybmdfc3RhdGVzWydjdWRhJ10pCiAgICAgICAgICAgIGNvbnRlbnRbJ3JuZ19zdGF0ZXMnXSA9IHJuZ19zdGF0ZXMKICAgICAgICAgICAgCiAgICAgICAgaWYgKGNwX3BhdGggLyAnbWV0YWRhdGEuanNvbicpLmV4aXN0cygpOgogICAgICAgICAgICB3aXRoIG9wZW4oY3BfcGF0aCAvICdtZXRhZGF0YS5qc29uJywgJ3InKSBhcyBmOgogICAgICAgICAgICAgICAgY29udGVudFsnbWV0YWRhdGEnXSA9IGpzb24ubG9hZChmKQogICAgICAgICAgICAgICAgCiAgICAgICAgaWYgKGNwX3BhdGggLyAnYXRsYXNfcmVwbGF5Lmx6NCcpLmV4aXN0cygpOgogICAgICAgICAgICB3aXRoIGx6NC5mcmFtZS5vcGVuKGNwX3BhdGggLyAnYXRsYXNfcmVwbGF5Lmx6NCcsICdyYicpIGFzIGY6CiAgICAgICAgICAgICAgICBjb250ZW50WydhdGxhc19yZXBsYXknXSA9IHBpY2tsZS5sb2FkKGYpCiAgICAgICAgaWYgKGNwX3BhdGggLyAnZW50cm9weV9yZXBsYXkubHo0JykuZXhpc3RzKCk6CiAgICAgICAgICAgIHdpdGggbHo0LmZyYW1lLm9wZW4oY3BfcGF0aCAvICdlbnRyb3B5X3JlcGxheS5sejQnLCAncmInKSBhcyBmOgogICAgICAgICAgICAgICAgY29udGVudFsnZW50cm9weV9yZXBsYXknXSA9IHBpY2tsZS5sb2FkKGYpCiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gY29udGVudAo=")
write_file_b64("prometheus_tqfd/orchestration/recovery.py", "aW1wb3J0IHRvcmNoCmltcG9ydCBnYwppbXBvcnQgdGltZQppbXBvcnQgcHN1dGlsCgpjbGFzcyBSZWNvdmVyeU1hbmFnZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZmlnLCBzdG9wX2V2ZW50LCBvb21fZXZlbnQpOgogICAgICAgIHNlbGYuY29uZmlnID0gY29uZmlnCiAgICAgICAgc2VsZi5zdG9wX2V2ZW50ID0gc3RvcF9ldmVudAogICAgICAgIHNlbGYub29tX2V2ZW50ID0gb29tX2V2ZW50CiAgICAgICAgc2VsZi5vb21fY291bnQgPSAwCgogICAgZGVmIGhhbmRsZV9vb20oc2VsZiwgcHJvY2Vzc19uYW1lKToKICAgICAgICBwcmludChmIuKaoO+4jyBPT00gZGV0ZWN0ZWQgaW4ge3Byb2Nlc3NfbmFtZX0iKQogICAgICAgIHNlbGYub29tX2V2ZW50LnNldCgpCiAgICAgICAgCiAgICAgICAgIyAxLiBDbGVhciBjYWNoZQogICAgICAgIHRvcmNoLmN1ZGEuZW1wdHlfY2FjaGUoKQogICAgICAgIGdjLmNvbGxlY3QoKQogICAgICAgIAogICAgICAgICMgMi4gQWRqdXN0IGNvbmZpZyAocmVkdWNlIGJhdGNoIHNpemVzKQogICAgICAgIGlmIHNlbGYuY29uZmlnLmF0bGFzX2JhdGNoX3NpemUgPiBzZWxmLmNvbmZpZy5vb21fbWluX2JhdGNoX3NpemU6CiAgICAgICAgICAgIHNlbGYuY29uZmlnLmF0bGFzX2JhdGNoX3NpemUgPSBpbnQoc2VsZi5jb25maWcuYXRsYXNfYmF0Y2hfc2l6ZSAqIHNlbGYuY29uZmlnLm9vbV9iYXRjaF9yZWR1Y3Rpb25fZmFjdG9yKQogICAgICAgICAgICBwcmludChmIlJlZHVjZWQgQVRMQVMgYmF0Y2ggc2l6ZSB0byB7c2VsZi5jb25maWcuYXRsYXNfYmF0Y2hfc2l6ZX0iKQogICAgICAgICAgICAKICAgICAgICBpZiBzZWxmLmNvbmZpZy5lbnRyb3B5X2JhdGNoX3NpemUgPiBzZWxmLmNvbmZpZy5vb21fbWluX2JhdGNoX3NpemU6CiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVudHJvcHlfYmF0Y2hfc2l6ZSA9IGludChzZWxmLmNvbmZpZy5lbnRyb3B5X2JhdGNoX3NpemUgKiBzZWxmLmNvbmZpZy5vb21fYmF0Y2hfcmVkdWN0aW9uX2ZhY3RvcikKICAgICAgICAgICAgcHJpbnQoZiJSZWR1Y2VkIEVOVFJPUFkgYmF0Y2ggc2l6ZSB0byB7c2VsZi5jb25maWcuZW50cm9weV9iYXRjaF9zaXplfSIpCiAgICAgICAgICAgIAogICAgICAgIGlmIHNlbGYuY29uZmlnLmF0bGFzX21jdHNfc2ltdWxhdGlvbnMgPiA1MDoKICAgICAgICAgICAgc2VsZi5jb25maWcuYXRsYXNfbWN0c19zaW11bGF0aW9ucyAvLz0gMgogICAgICAgICAgICBwcmludChmIlJlZHVjZWQgTUNUUyBzaW11bGF0aW9ucyB0byB7c2VsZi5jb25maWcuYXRsYXNfbWN0c19zaW11bGF0aW9uc30iKQoKICAgICAgICBzZWxmLm9vbV9jb3VudCArPSAxCiAgICAgICAgdGltZS5zbGVlcCg1KQogICAgICAgIHNlbGYub29tX2V2ZW50LmNsZWFyKCkKCiAgICBkZWYgY2hlY2tfc3lzdGVtX2hlYWx0aChzZWxmKToKICAgICAgICAjIFJBTSBjaGVjawogICAgICAgIHJhbV91c2FnZSA9IHBzdXRpbC52aXJ0dWFsX21lbW9yeSgpLnBlcmNlbnQKICAgICAgICBpZiByYW1fdXNhZ2UgPiA5MDoKICAgICAgICAgICAgcHJpbnQoZiLimqDvuI8gSGlnaCBSQU0gdXNhZ2U6IHtyYW1fdXNhZ2V9JSIpCiAgICAgICAgICAgICMgUG9zc2libGUgYWN0aW9uOiBjbGVhciByZXBsYXkgYnVmZmVycyBvciByZXN0YXJ0CiAgICAgICAgICAgIAogICAgICAgICMgR1BVIFRlbXAgY2hlY2sgKGlmIHB5bnZtbCBpcyBhdmFpbGFibGUpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbXBvcnQgcHludm1sCiAgICAgICAgICAgIHB5bnZtbC5udm1sSW5pdCgpCiAgICAgICAgICAgIGhhbmRsZSA9IHB5bnZtbC5udm1sRGV2aWNlR2V0SGFuZGxlQnlJbmRleCgwKQogICAgICAgICAgICB0ZW1wID0gcHludm1sLm52bWxEZXZpY2VHZXRUZW1wZXJhdHVyZShoYW5kbGUsIHB5bnZtbC5OVk1MX1RFTVBFUkFUVVJFX0dQVSkKICAgICAgICAgICAgaWYgdGVtcCA+IDg1OgogICAgICAgICAgICAgICAgcHJpbnQoZiLimqDvuI8gSGlnaCBHUFUgVGVtcDoge3RlbXB9wrBDIikKICAgICAgICAgICAgICAgIHJldHVybiAiaG90IgogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHJldHVybiAib2siCgpkZWYgZ3VhcmRlZF9ydW4odGFyZ2V0X2ZuLCBuYW1lLCByZWNvdmVyeV9tZ3IsICphcmdzLCAqKmt3YXJncyk6CiAgICByZXN0YXJ0cyA9IDAKICAgIG1heF9yZXN0YXJ0cyA9IDMKICAgIHdoaWxlIHJlc3RhcnRzIDwgbWF4X3Jlc3RhcnRzIGFuZCBub3QgcmVjb3ZlcnlfbWdyLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB0YXJnZXRfZm4oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBicmVhawogICAgICAgIGV4Y2VwdCB0b3JjaC5jdWRhLk91dE9mTWVtb3J5RXJyb3I6CiAgICAgICAgICAgIHJlY292ZXJ5X21nci5oYW5kbGVfb29tKG5hbWUpCiAgICAgICAgICAgIHJlc3RhcnRzICs9IDEKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiRXJyb3IgaW4ge25hbWV9OiB7ZX0iKQogICAgICAgICAgICBpbXBvcnQgdHJhY2ViYWNrCiAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQogICAgICAgICAgICByZXN0YXJ0cyArPSAxCiAgICAgICAgICAgIHRpbWUuc2xlZXAoNSkKICAgIAogICAgaWYgcmVzdGFydHMgPj0gbWF4X3Jlc3RhcnRzOgogICAgICAgIHByaW50KGYiUHJvY2VzcyB7bmFtZX0gZmFpbGVkIGFmdGVyIHttYXhfcmVzdGFydHN9IHJlc3RhcnRzLiIpCiAgICAgICAgcmVjb3ZlcnlfbWdyLnN0b3BfZXZlbnQuc2V0KCkK")
write_file_b64("prometheus_tqfd/entropy/fields.py", "aW1wb3J0IGNoZXNzCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgdG9yY2gKaW1wb3J0IHRvcmNoLm5uLmZ1bmN0aW9uYWwgYXMgRgoKY2xhc3MgRmllbGRDYWxjdWxhdG9yOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBoeXNpY3NfY29uZmlnKToKICAgICAgICBzZWxmLnBjID0gcGh5c2ljc19jb25maWcKICAgICAgICBzZWxmLnBpZWNlX2VuZXJnaWVzID0gewogICAgICAgICAgICBjaGVzcy5QQVdOOiBzZWxmLnBjLmVuZXJneV9wYXduLAogICAgICAgICAgICBjaGVzcy5LTklHSFQ6IHNlbGYucGMuZW5lcmd5X2tuaWdodCwKICAgICAgICAgICAgY2hlc3MuQklTSE9QOiBzZWxmLnBjLmVuZXJneV9iaXNob3AsCiAgICAgICAgICAgIGNoZXNzLlJPT0s6IHNlbGYucGMuZW5lcmd5X3Jvb2ssCiAgICAgICAgICAgIGNoZXNzLlFVRUVOOiBzZWxmLnBjLmVuZXJneV9xdWVlbiwKICAgICAgICAgICAgY2hlc3MuS0lORzogc2VsZi5wYy5lbmVyZ3lfa2luZwogICAgICAgIH0KCiAgICBkZWYgY29tcHV0ZV9maWVsZHMoc2VsZiwgYm9hcmQ6IGNoZXNzLkJvYXJkKToKICAgICAgICAjIE1fdG90YWw6IE1hc3NlL0VuZXJnaWUtRmVsZAogICAgICAgIG1fdG90YWwgPSBzZWxmLl9jb21wdXRlX21hc3NfZmllbGQoYm9hcmQpCiAgICAgICAgIyBGX3ByZXNzdXJlOiBNb2JpbGl0w6R0c2ZsdXNzLUZlbGQKICAgICAgICBmX3ByZXNzdXJlID0gc2VsZi5fY29tcHV0ZV9tb2JpbGl0eV9maWVsZChib2FyZCkKICAgICAgICAjIFA6IERydWNrLUZlbGQKICAgICAgICBwX2ZpZWxkID0gc2VsZi5fY29tcHV0ZV9wcmVzc3VyZV9maWVsZChtX3RvdGFsLCBmX3ByZXNzdXJlKQogICAgICAgICMgzqY6IFBvdGVudGlhbGZlbGQKICAgICAgICBwaGkgPSBzZWxmLl9jb21wdXRlX3BvdGVudGlhbF9maWVsZChtX3RvdGFsLCBwX2ZpZWxkKQogICAgICAgIAogICAgICAgIHJldHVybiB0b3JjaC5zdGFjayhbbV90b3RhbCwgZl9wcmVzc3VyZSwgcF9maWVsZCwgcGhpXSkgIyBbNCwgOCwgOF0KCiAgICBkZWYgX2NvbXB1dGVfbWFzc19maWVsZChzZWxmLCBib2FyZDogY2hlc3MuQm9hcmQpOgogICAgICAgIGZpZWxkID0gbnAuemVyb3MoKDgsIDgpLCBkdHlwZT1ucC5mbG9hdDMyKQogICAgICAgIHNpZ21hID0gc2VsZi5wYy5kaWZmdXNpb25fc2lnbWEKICAgICAgICAKICAgICAgICBmb3Igc3F1YXJlLCBwaWVjZSBpbiBib2FyZC5waWVjZV9tYXAoKS5pdGVtcygpOgogICAgICAgICAgICByMCwgZjAgPSBkaXZtb2Qoc3F1YXJlLCA4KQogICAgICAgICAgICBlbmVyZ3kgPSBzZWxmLnBpZWNlX2VuZXJnaWVzW3BpZWNlLnBpZWNlX3R5cGVdCiAgICAgICAgICAgIGlmIHBpZWNlLmNvbG9yID09IGNoZXNzLkJMQUNLOgogICAgICAgICAgICAgICAgZW5lcmd5ID0gLWVuZXJneQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICMgR2F1c3NpYW4gZGlzdHJpYnV0aW9uCiAgICAgICAgICAgIGZvciByIGluIHJhbmdlKDgpOgogICAgICAgICAgICAgICAgZm9yIGYgaW4gcmFuZ2UoOCk6CiAgICAgICAgICAgICAgICAgICAgZGlzdF9zcSA9IChyIC0gcjApKioyICsgKGYgLSBmMCkqKjIKICAgICAgICAgICAgICAgICAgICBmaWVsZFtyLCBmXSArPSBlbmVyZ3kgKiBucC5leHAoLWRpc3Rfc3EgLyAoMiAqIHNpZ21hKioyKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gdG9yY2guZnJvbV9udW1weShmaWVsZCkKCiAgICBkZWYgX2NvbXB1dGVfbW9iaWxpdHlfZmllbGQoc2VsZiwgYm9hcmQ6IGNoZXNzLkJvYXJkKToKICAgICAgICBmX3doaXRlID0gbnAuemVyb3MoKDgsIDgpLCBkdHlwZT1ucC5mbG9hdDMyKQogICAgICAgIGZfYmxhY2sgPSBucC56ZXJvcygoOCwgOCksIGR0eXBlPW5wLmZsb2F0MzIpCiAgICAgICAgCiAgICAgICAgIyBXaGl0ZSBtb2JpbGl0eQogICAgICAgIGJvYXJkX3cgPSBib2FyZC5jb3B5KCkKICAgICAgICBib2FyZF93LnR1cm4gPSBjaGVzcy5XSElURQogICAgICAgIGZvciBtb3ZlIGluIGJvYXJkX3cucHNldWRvX2xlZ2FsX21vdmVzOgogICAgICAgICAgICByLCBmID0gZGl2bW9kKG1vdmUudG9fc3F1YXJlLCA4KQogICAgICAgICAgICBmX3doaXRlW3IsIGZdICs9IDEKICAgICAgICAgICAgCiAgICAgICAgIyBCbGFjayBtb2JpbGl0eQogICAgICAgIGJvYXJkX2IgPSBib2FyZC5jb3B5KCkKICAgICAgICBib2FyZF9iLnR1cm4gPSBjaGVzcy5CTEFDSwogICAgICAgIGZvciBtb3ZlIGluIGJvYXJkX2IucHNldWRvX2xlZ2FsX21vdmVzOgogICAgICAgICAgICByLCBmID0gZGl2bW9kKG1vdmUudG9fc3F1YXJlLCA4KQogICAgICAgICAgICBmX2JsYWNrW3IsIGZdICs9IDEKICAgICAgICAgICAgCiAgICAgICAgIyBOb3JtYWxpemF0aW9uIGFuZCBQcmVzc3VyZQogICAgICAgIGZfcHJlc3N1cmUgPSAoZl93aGl0ZSAtIGZfYmxhY2spCiAgICAgICAgIyBTaWdtb2lkLWxpa2Ugbm9ybWFsaXphdGlvbgogICAgICAgIGZfcHJlc3N1cmUgPSAyLjAgLyAoMS4wICsgbnAuZXhwKC0wLjUgKiBmX3ByZXNzdXJlKSkgLSAxLjAKICAgICAgICAKICAgICAgICByZXR1cm4gdG9yY2guZnJvbV9udW1weShmX3ByZXNzdXJlKQoKICAgIGRlZiBfY29tcHV0ZV9wcmVzc3VyZV9maWVsZChzZWxmLCBtX3RvdGFsLCBmX3ByZXNzdXJlKToKICAgICAgICAjIFAoeCx5KSA9IENvbnYyZChzdGFja1tNX3RvdGFsLCBGX3ByZXNzdXJlXSwga2VybmVsPTMsIM+DX3Ntb290aD0xLjApCiAgICAgICAgIyBGb3Igc2ltcGxpY2l0eSwganVzdCBhIHNtb290aGVkIGNvbWJpbmF0aW9uCiAgICAgICAgY29tYmluZWQgPSB0b3JjaC5zdGFjayhbbV90b3RhbCwgZl9wcmVzc3VyZV0pLnVuc3F1ZWV6ZSgwKQogICAgICAgIGtlcm5lbCA9IHRvcmNoLm9uZXMoKDEsIDIsIDMsIDMpKSAvIDE4LjAKICAgICAgICBwX2ZpZWxkID0gRi5jb252MmQoY29tYmluZWQsIGtlcm5lbCwgcGFkZGluZz0xKQogICAgICAgIHJldHVybiBwX2ZpZWxkLnNxdWVlemUoKQoKICAgIGRlZiBfY29tcHV0ZV9wb3RlbnRpYWxfZmllbGQoc2VsZiwgbV90b3RhbCwgcF9maWVsZCk6CiAgICAgICAgIyDOpih4LHkpID0gzrEgw5cgTV90b3RhbCh4LHkpICsgzrIgw5cgUCh4LHkpICsgzrMgw5cg4oiHwrJNKHgseSkKICAgICAgICAjIOKIh8KyTSBhcHByb3hpbWF0ZWQgd2l0aCBMYXBsYWNpYW4ga2VybmVsCiAgICAgICAgbGFwbGFjaWFuX2tlcm5lbCA9IHRvcmNoLnRlbnNvcihbWzAsIDEsIDBdLCBbMSwgLTQsIDFdLCBbMCwgMSwgMF1dKS5mbG9hdCgpLnZpZXcoMSwgMSwgMywgMykKICAgICAgICBsYXBsYWNpYW4gPSBGLmNvbnYyZChtX3RvdGFsLnZpZXcoMSwgMSwgOCwgOCksIGxhcGxhY2lhbl9rZXJuZWwsIHBhZGRpbmc9MSkuc3F1ZWV6ZSgpCiAgICAgICAgCiAgICAgICAgcGhpID0gKHNlbGYucGMuZmllbGRfYWxwaGEgKiBtX3RvdGFsICsgCiAgICAgICAgICAgICAgIHNlbGYucGMuZmllbGRfYmV0YSAqIHBfZmllbGQgKyAKICAgICAgICAgICAgICAgc2VsZi5wYy5maWVsZF9nYW1tYSAqIGxhcGxhY2lhbikKICAgICAgICByZXR1cm4gcGhpCg==")
write_file_b64("prometheus_tqfd/entropy/loss.py", "aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKCmRlZiBlbnRyb3B5X2xvc3MocG9saWN5X3NlbGYsIGJvYXJkX2JhdGNoKToKICAgICMgU19zZWxmID0gLc6jIHAgbG9nIHAKICAgIHNfc2VsZiA9IC10b3JjaC5zdW0ocG9saWN5X3NlbGYgKiB0b3JjaC5sb2cocG9saWN5X3NlbGYgKyAxZS04KSwgZGltPS0xKQogICAgCiAgICAjIFNfb3Bwb25lbnQgYXBwcm94aW1hdGlvbjogbG9nKG51bV9sZWdhbCkKICAgICMgV2UgbmVlZCBudW1fbGVnYWxfb3Bwb25lbnQgZm9yIGVhY2ggYm9hcmQgaW4gYmF0Y2gKICAgICMgVGhpcyBtaWdodCBiZSBzbG93IGlmIHdlIGNhbGN1bGF0ZSBpdCBoZXJlLCBidXQgbGV0J3MgYXNzdW1lIGl0J3MgcGFzc2VkCiAgICBwYXNzCgpkZWYgY29tcHV0ZV90b3RhbF9lbnRyb3B5X2xvc3MoYmF0Y2hfZGF0YSwgbW9kZWwsIHJuZF90YXJnZXQsIHJuZF9wcmVkaWN0b3IsIGNvbmZpZyk6CiAgICAjIGJhdGNoX2RhdGEgY29udGFpbnM6IGZpZWxkX3RlbnNvcnMsIGJvYXJkX2RhdGEsIGxlZ2FsX21hc2tzLCBvcHBvbmVudF9sZWdhbF9jb3VudHMsIGV0Yy4KICAgIHByb2JzLCBlbmVyZ3ksIGZsb3csIChyZWFsLCBpbWFnKSwgZnVzZWQgPSBtb2RlbChiYXRjaF9kYXRhWydmaWVsZHMnXSwgYmF0Y2hfZGF0YVsnYm9hcmRzJ10sIGJhdGNoX2RhdGFbJ21hc2tzJ10pCiAgICAKICAgICMgMS4gRW50cm9weSBSYXRpbyBMb3NzCiAgICBzX3NlbGYgPSAtdG9yY2guc3VtKHByb2JzICogdG9yY2gubG9nKHByb2JzICsgMWUtOCksIGRpbT0tMSkKICAgIHNfb3BwID0gdG9yY2gubG9nKGJhdGNoX2RhdGFbJ29wcF9sZWdhbF9jb3VudHMnXS5mbG9hdCgpICsgMS4wKQogICAgbF9lbnQgPSAtdG9yY2gubG9nKHNfc2VsZiAvIChzX29wcCArIDAuMSkgKyAxZS04KS5tZWFuKCkKICAgIAogICAgIyAyLiBDb25zZXJ2YXRpb24gTG9zczogfM6URSAtIEVfY2FwdHVyZWR8wrIKICAgICMgTmVlZCBlX2JlZm9yZSwgZV9hZnRlciwgZV9jYXB0dXJlZAogICAgIyBUaGlzIHJlcXVpcmVzIHNlcXVlbnRpYWwgZGF0YSBvciBwYWlycyBvZiBzdGF0ZXMKICAgIGxfY29ucyA9IEYubXNlX2xvc3MoYmF0Y2hfZGF0YVsnZW5lcmd5X2RpZmYnXSwgLWJhdGNoX2RhdGFbJ2VuZXJneV9jYXB0dXJlZCddKQogICAgCiAgICAjIDMuIFNtb290aG5lc3MgTG9zczogfOKIh8KyzqZ8wrIKICAgIGxhcGxhY2lhbl9rZXJuZWwgPSB0b3JjaC50ZW5zb3IoW1swLCAxLCAwXSwgWzEsIC00LCAxXSwgWzAsIDEsIDBdXSkuZmxvYXQoKS50byhlbmVyZ3kuZGV2aWNlKS52aWV3KDEsIDEsIDMsIDMpCiAgICAjIM6mIGlzIHBhcnQgb2YgZmllbGRzLCBsZXQncyBleHRyYWN0IGl0CiAgICBwaGkgPSBiYXRjaF9kYXRhWydmaWVsZHMnXVs6LCAzOjQsIDosIDpdCiAgICBsYXBsYWNpYW4gPSBGLmNvbnYyZChwaGksIGxhcGxhY2lhbl9rZXJuZWwsIHBhZGRpbmc9MSkKICAgIGxfc21vb3RoID0gKGxhcGxhY2lhbioqMikubWVhbigpCiAgICAKICAgICMgNC4gVEQgTG9zcyAoRW5lcmd5KQogICAgIyBFKHMpIHZzIM6zIEUocycpCiAgICB0YXJnZXRfZW5lcmd5ID0gY29uZmlnLmVudHJvcHlfYmV0YV9zdGFydCAqIGJhdGNoX2RhdGFbJ2VuZXJneV9uZXh0J10uZGV0YWNoKCkKICAgIGxfdGQgPSBGLm1zZV9sb3NzKGVuZXJneSwgdGFyZ2V0X2VuZXJneSkKICAgIAogICAgIyA1LiBOb3ZlbHR5IExvc3MKICAgIHJuZF9lcnJvciA9IHRvcmNoLm1lYW4oKHJuZF90YXJnZXQoZnVzZWQpIC0gcm5kX3ByZWRpY3RvcihmdXNlZCkpKioyLCBkaW09LTEpCiAgICBsX25vdmVsID0gcm5kX2Vycm9yLm1lYW4oKQogICAgCiAgICB0b3RhbF9sb3NzID0gKAogICAgICAgIDEuMCAqIGxfZW50ICsKICAgICAgICBjb25maWcuZW50cm9weV9sb3NzX3dlaWdodF9jb25zZXJ2YXRpb24gKiBsX2NvbnMgKwogICAgICAgIGNvbmZpZy5lbnRyb3B5X2xvc3Nfd2VpZ2h0X3Ntb290aG5lc3MgKiBsX3Ntb290aCArCiAgICAgICAgMS4wICogbF90ZCArCiAgICAgICAgY29uZmlnLmVudHJvcHlfbG9zc193ZWlnaHRfbm92ZWx0eSAqIGxfbm92ZWwKICAgICkKICAgIAogICAgcmV0dXJuIHRvdGFsX2xvc3MsIGxfZW50Lml0ZW0oKSwgbF9jb25zLml0ZW0oKSwgbF9zbW9vdGguaXRlbSgpLCBsX3RkLml0ZW0oKSwgbF9ub3ZlbC5pdGVtKCkK")
write_file_b64("prometheus_tqfd/entropy/network.py", "aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gubm4uZnVuY3Rpb25hbCBhcyBGCmltcG9ydCBjaGVzcwoKdHJ5OgogICAgZnJvbSB0b3JjaF9nZW9tZXRyaWMubm4gaW1wb3J0IEdBVENvbnYsIGdsb2JhbF9tZWFuX3Bvb2wsIGdsb2JhbF9tYXhfcG9vbAogICAgZnJvbSB0b3JjaF9nZW9tZXRyaWMuZGF0YSBpbXBvcnQgRGF0YSwgQmF0Y2gKICAgIEhBU19QWUcgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIEhBU19QWUcgPSBGYWxzZQoKY2xhc3MgRmllbGRFbmNvZGVyKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaW5fY2hhbm5lbHMsIG91dF9kaW0pOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBubi5Db252MmQoaW5fY2hhbm5lbHMsIDY0LCBrZXJuZWxfc2l6ZT01LCBwYWRkaW5nPTIsIHBhZGRpbmdfbW9kZT0nY2lyY3VsYXInKQogICAgICAgIHNlbGYuYm4xID0gbm4uQmF0Y2hOb3JtMmQoNjQpCiAgICAgICAgc2VsZi5jb252MiA9IG5uLkNvbnYyZCg2NCwgMTI4LCBrZXJuZWxfc2l6ZT01LCBwYWRkaW5nPTIsIHBhZGRpbmdfbW9kZT0nY2lyY3VsYXInKQogICAgICAgIHNlbGYuYm4yID0gbm4uQmF0Y2hOb3JtMmQoMTI4KQogICAgICAgIHNlbGYuY29udjMgPSBubi5Db252MmQoMTI4LCAyNTYsIGtlcm5lbF9zaXplPTMsIHBhZGRpbmc9MSkKICAgICAgICBzZWxmLmJuMyA9IG5uLkJhdGNoTm9ybTJkKDI1NikKICAgICAgICBzZWxmLmNvbnY0ID0gbm4uQ29udjJkKDI1NiwgMjU2LCBrZXJuZWxfc2l6ZT0zLCBwYWRkaW5nPTEpCiAgICAgICAgc2VsZi5ibjQgPSBubi5CYXRjaE5vcm0yZCgyNTYpCiAgICAgICAgc2VsZi5hdmdwb29sID0gbm4uQWRhcHRpdmVBdmdQb29sMmQoMSkKICAgICAgICBzZWxmLmZjID0gbm4uTGluZWFyKDI1Niwgb3V0X2RpbSkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICB4ID0gRi5nZWx1KHNlbGYuYm4xKHNlbGYuY29udjEoeCkpKQogICAgICAgIHggPSBGLmdlbHUoc2VsZi5ibjIoc2VsZi5jb252Mih4KSkpCiAgICAgICAgeCA9IEYuZ2VsdShzZWxmLmJuMyhzZWxmLmNvbnYzKHgpKSkKICAgICAgICB4ID0gRi5nZWx1KHNlbGYuYm40KHNlbGYuY29udjQoeCkpKQogICAgICAgIHggPSBzZWxmLmF2Z3Bvb2woeCkudmlldyh4LnNpemUoMCksIC0xKQogICAgICAgIHJldHVybiBzZWxmLmZjKHgpCgpjbGFzcyBHTk5FbmNvZGVyKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaW5fZmVhdHVyZXMsIG91dF9kaW0pOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIGlmIG5vdCBIQVNfUFlHOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLmNvbnYxID0gR0FUQ29udihpbl9mZWF0dXJlcywgNjQsIGhlYWRzPTQpCiAgICAgICAgc2VsZi5jb252MiA9IEdBVENvbnYoMjU2LCA2NCwgaGVhZHM9NCkKICAgICAgICBzZWxmLmNvbnYzID0gR0FUQ29udigyNTYsIDY0LCBoZWFkcz00KQogICAgICAgIHNlbGYuY29udjQgPSBHQVRDb252KDI1NiwgMTI4LCBoZWFkcz00KQogICAgICAgIHNlbGYuZmMgPSBubi5MaW5lYXIoMTAyNCwgb3V0X2RpbSkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgSEFTX1BZRzoKICAgICAgICAgICAgcmV0dXJuIHRvcmNoLnplcm9zKCgxLCA1MTIpKS50byhkYXRhLnguZGV2aWNlKQogICAgICAgIHgsIGVkZ2VfaW5kZXggPSBkYXRhLngsIGRhdGEuZWRnZV9pbmRleAogICAgICAgIHggPSBGLmVsdShzZWxmLmNvbnYxKHgsIGVkZ2VfaW5kZXgpKQogICAgICAgIHggPSBGLmVsdShzZWxmLmNvbnYyKHgsIGVkZ2VfaW5kZXgpKQogICAgICAgIHggPSBGLmVsdShzZWxmLmNvbnYzKHgsIGVkZ2VfaW5kZXgpKQogICAgICAgIHggPSBGLmVsdShzZWxmLmNvbnY0KHgsIGVkZ2VfaW5kZXgpKQogICAgICAgIAogICAgICAgICMgUG9vbGluZwogICAgICAgIHhfbWVhbiA9IGdsb2JhbF9tZWFuX3Bvb2woeCwgZGF0YS5iYXRjaCkKICAgICAgICB4X21heCA9IGdsb2JhbF9tYXhfcG9vbCh4LCBkYXRhLmJhdGNoKQogICAgICAgIHggPSB0b3JjaC5jYXQoW3hfbWVhbiwgeF9tYXhdLCBkaW09MSkgIyAxMDI0RAogICAgICAgIHJldHVybiBzZWxmLmZjKHgpCgpjbGFzcyBRdWFudHVtUG9saWN5SGVhZChubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGluX2RpbSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5mYyA9IG5uLlNlcXVlbnRpYWwoCiAgICAgICAgICAgIG5uLkxpbmVhcihpbl9kaW0sIDI1NiksCiAgICAgICAgICAgIG5uLkdFTFUoKSwKICAgICAgICAgICAgbm4uTGluZWFyKDI1NiwgNDY3MiAqIDIpCiAgICAgICAgKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIG91dCA9IHNlbGYuZmMoeCkKICAgICAgICByZWFsID0gb3V0WzosIDo0NjcyXQogICAgICAgIGltYWcgPSBvdXRbOiwgNDY3MjpdCiAgICAgICAgcmV0dXJuIHJlYWwsIGltYWcKCiAgICBkZWYgZ2V0X3Byb2JhYmlsaXRpZXMoc2VsZiwgcmVhbCwgaW1hZywgbGVnYWxfbWFzayk6CiAgICAgICAgYW1wbGl0dWRlc19zcXVhcmVkID0gcmVhbCoqMiArIGltYWcqKjIKICAgICAgICBhbXBsaXR1ZGVzX3NxdWFyZWQgPSBhbXBsaXR1ZGVzX3NxdWFyZWQgKiBsZWdhbF9tYXNrLmZsb2F0KCkKICAgICAgICAKICAgICAgICAjIEF2b2lkIGRpdmlzaW9uIGJ5IHplcm8KICAgICAgICBzdW1fYW1wID0gYW1wbGl0dWRlc19zcXVhcmVkLnN1bShkaW09LTEsIGtlZXBkaW09VHJ1ZSkKICAgICAgICBwcm9icyA9IGFtcGxpdHVkZXNfc3F1YXJlZCAvIChzdW1fYW1wICsgMWUtOCkKICAgICAgICByZXR1cm4gcHJvYnMKCmNsYXNzIEVudHJvcHlOZXR3b3JrKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZmlnKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmhhc19weWcgPSBIQVNfUFlHCiAgICAgICAgCiAgICAgICAgIyBFbmNvZGVyIEE6IEZpZWxkCiAgICAgICAgc2VsZi5maWVsZF9lbmNvZGVyID0gRmllbGRFbmNvZGVyKDQsIDUxMikKICAgICAgICAKICAgICAgICAjIEVuY29kZXIgQjogR05OIG9yIFNpbXBsaWZpZWQgQ05OCiAgICAgICAgaWYgc2VsZi5oYXNfcHlnOgogICAgICAgICAgICBzZWxmLmdubl9lbmNvZGVyID0gR05ORW5jb2RlcigxMCwgNTEyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgU2ltcGxpZmllZCBtb2RlOiB1c2UgYSBzdGFuZGFyZCBDTk4gZW5jb2RlciBmb3IgdGhlIGJvYXJkCiAgICAgICAgICAgIHNlbGYuc2ltcGxpZmllZF9lbmNvZGVyID0gbm4uU2VxdWVudGlhbCgKICAgICAgICAgICAgICAgIG5uLkNvbnYyZCgxOSwgNjQsIGtlcm5lbF9zaXplPTMsIHBhZGRpbmc9MSksCiAgICAgICAgICAgICAgICBubi5CYXRjaE5vcm0yZCg2NCksCiAgICAgICAgICAgICAgICBubi5SZUxVKCksCiAgICAgICAgICAgICAgICBubi5Db252MmQoNjQsIDEyOCwga2VybmVsX3NpemU9MywgcGFkZGluZz0xKSwKICAgICAgICAgICAgICAgIG5uLkJhdGNoTm9ybTJkKDEyOCksCiAgICAgICAgICAgICAgICBubi5SZUxVKCksCiAgICAgICAgICAgICAgICBubi5BZGFwdGl2ZUF2Z1Bvb2wyZCgxKSwKICAgICAgICAgICAgICAgIG5uLkZsYXR0ZW4oKSwKICAgICAgICAgICAgICAgIG5uLkxpbmVhcigxMjgsIDUxMikKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICBzZWxmLmZ1c2lvbiA9IG5uLlNlcXVlbnRpYWwoCiAgICAgICAgICAgIG5uLkxpbmVhcigxMDI0LCA3NjgpLAogICAgICAgICAgICBubi5MYXllck5vcm0oNzY4KSwKICAgICAgICAgICAgbm4uR0VMVSgpLAogICAgICAgICAgICBubi5MaW5lYXIoNzY4LCA1MTIpLAogICAgICAgICAgICBubi5MYXllck5vcm0oNTEyKSwKICAgICAgICAgICAgbm4uR0VMVSgpLAogICAgICAgICAgICBubi5MaW5lYXIoNTEyLCA1MTIpLAogICAgICAgICAgICBubi5MYXllck5vcm0oNTEyKSwKICAgICAgICAgICAgbm4uR0VMVSgpCiAgICAgICAgKQogICAgICAgIAogICAgICAgIHNlbGYucXVhbnR1bV9wb2xpY3kgPSBRdWFudHVtUG9saWN5SGVhZCg1MTIpCiAgICAgICAgc2VsZi5lbmVyZ3lfaGVhZCA9IG5uLlNlcXVlbnRpYWwoCiAgICAgICAgICAgIG5uLkxpbmVhcig1MTIsIDI1NiksCiAgICAgICAgICAgIG5uLkdFTFUoKSwKICAgICAgICAgICAgbm4uTGluZWFyKDI1NiwgMSkKICAgICAgICApCiAgICAgICAgc2VsZi5mbG93X2ZpZWxkX2hlYWQgPSBubi5TZXF1ZW50aWFsKAogICAgICAgICAgICBubi5MaW5lYXIoNTEyLCAyNTYpLAogICAgICAgICAgICBubi5HRUxVKCksCiAgICAgICAgICAgIG5uLkxpbmVhcigyNTYsIDEyOCkgIyA4eDh4MgogICAgICAgICkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCBmaWVsZF90ZW5zb3IsIGJvYXJkX2RhdGEsIGxlZ2FsX21hc2spOgogICAgICAgICMgZmllbGRfdGVuc29yOiBbQiwgNCwgOCwgOF0KICAgICAgICAjIGJvYXJkX2RhdGE6IGVpdGhlciBQeUcgQmF0Y2ggb3IgW0IsIDE5LCA4LCA4XSB0ZW5zb3IKICAgICAgICAjIGxlZ2FsX21hc2s6IFtCLCA0NjcyXQogICAgICAgIAogICAgICAgIGZpZWxkX291dCA9IHNlbGYuZmllbGRfZW5jb2RlcihmaWVsZF90ZW5zb3IpCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi5oYXNfcHlnOgogICAgICAgICAgICBnbm5fb3V0ID0gc2VsZi5nbm5fZW5jb2Rlcihib2FyZF9kYXRhKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGdubl9vdXQgPSBzZWxmLnNpbXBsaWZpZWRfZW5jb2Rlcihib2FyZF9kYXRhKQogICAgICAgICAgICAKICAgICAgICBmdXNlZCA9IHNlbGYuZnVzaW9uKHRvcmNoLmNhdChbZmllbGRfb3V0LCBnbm5fb3V0XSwgZGltPTEpKQogICAgICAgIAogICAgICAgIHJlYWwsIGltYWcgPSBzZWxmLnF1YW50dW1fcG9saWN5KGZ1c2VkKQogICAgICAgIHByb2JzID0gc2VsZi5xdWFudHVtX3BvbGljeS5nZXRfcHJvYmFiaWxpdGllcyhyZWFsLCBpbWFnLCBsZWdhbF9tYXNrKQogICAgICAgIAogICAgICAgIGVuZXJneSA9IHNlbGYuZW5lcmd5X2hlYWQoZnVzZWQpCiAgICAgICAgZmxvdyA9IHNlbGYuZmxvd19maWVsZF9oZWFkKGZ1c2VkKS52aWV3KC0xLCAyLCA4LCA4KQogICAgICAgIAogICAgICAgIHJldHVybiBwcm9icywgZW5lcmd5LCBmbG93LCAocmVhbCwgaW1hZyksIGZ1c2VkCgpkZWYgYnVpbGRfZ3JhcGhfZGF0YShib2FyZDogY2hlc3MuQm9hcmQpOgogICAgaWYgbm90IEhBU19QWUc6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAKICAgICMgbm9kZXM6IGVhY2ggcGllY2UKICAgIG5vZGVzID0gW10KICAgIHBpZWNlX21hcCA9IGJvYXJkLnBpZWNlX21hcCgpCiAgICBzcXVhcmVzID0gbGlzdChwaWVjZV9tYXAua2V5cygpKQogICAgCiAgICBmb3Igc3EgaW4gc3F1YXJlczoKICAgICAgICBwaWVjZSA9IHBpZWNlX21hcFtzcV0KICAgICAgICByYW5rLCBmaWxlID0gZGl2bW9kKHNxLCA4KQogICAgICAgICMgRmVhdHVyZXM6IFt0eXBlKDYpLCByYW5rLCBmaWxlLCBtb2JpbGl0eV0KICAgICAgICBwdHlwZSA9IFswXSo2CiAgICAgICAgcHR5cGVbcGllY2UucGllY2VfdHlwZS0xXSA9IDEuMAogICAgICAgIAogICAgICAgICMgbW9iaWxpdHkKICAgICAgICBtb2JpbGl0eSA9IDAKICAgICAgICBmb3IgbW92ZSBpbiBib2FyZC5wc2V1ZG9fbGVnYWxfbW92ZXM6CiAgICAgICAgICAgIGlmIG1vdmUuZnJvbV9zcXVhcmUgPT0gc3E6CiAgICAgICAgICAgICAgICBtb2JpbGl0eSArPSAxCiAgICAgICAgCiAgICAgICAgZmVhdCA9IHB0eXBlICsgW3JhbmsvNy4wLCBmaWxlLzcuMCwgbW9iaWxpdHkvMjAuMCwgMS4wIGlmIHBpZWNlLmNvbG9yID09IGNoZXNzLldISVRFIGVsc2UgLTEuMF0KICAgICAgICBub2Rlcy5hcHBlbmQoZmVhdCkKICAgICAgICAKICAgIHggPSB0b3JjaC50ZW5zb3Iobm9kZXMsIGR0eXBlPXRvcmNoLmZsb2F0MzIpCiAgICAKICAgICMgZWRnZXM6IGlmIHBpZWNlcyBhdHRhY2sgZWFjaCBvdGhlcgogICAgZWRnZV9pbmRleCA9IFtdCiAgICBmb3IgaSwgc3ExIGluIGVudW1lcmF0ZShzcXVhcmVzKToKICAgICAgICBmb3Igaiwgc3EyIGluIGVudW1lcmF0ZShzcXVhcmVzKToKICAgICAgICAgICAgaWYgaSA9PSBqOiBjb250aW51ZQogICAgICAgICAgICBpZiBib2FyZC5pc19hdHRhY2tpbmcoc3ExLCBzcTIpIG9yIGJvYXJkLmlzX2F0dGFja2luZyhzcTIsIHNxMSk6CiAgICAgICAgICAgICAgICBlZGdlX2luZGV4LmFwcGVuZChbaSwgal0pCiAgICAgICAgICAgICAgICAKICAgIGlmIG5vdCBlZGdlX2luZGV4OgogICAgICAgIGVkZ2VfaW5kZXggPSB0b3JjaC5lbXB0eSgoMiwgMCksIGR0eXBlPXRvcmNoLmxvbmcpCiAgICBlbHNlOgogICAgICAgIGVkZ2VfaW5kZXggPSB0b3JjaC50ZW5zb3IoZWRnZV9pbmRleCwgZHR5cGU9dG9yY2gubG9uZykudCgpLmNvbnRpZ3VvdXMoKQogICAgICAgIAogICAgcmV0dXJuIERhdGEoeD14LCBlZGdlX2luZGV4PWVkZ2VfaW5kZXgpCg==")
write_file_b64("prometheus_tqfd/entropy/trainer.py", "aW1wb3J0IHRvcmNoCmZyb20gdG9yY2gub3B0aW0gaW1wb3J0IEFkYW1XCmZyb20gdG9yY2guY3VkYS5hbXAgaW1wb3J0IEdyYWRTY2FsZXIsIGF1dG9jYXN0CmZyb20gY29sbGVjdGlvbnMgaW1wb3J0IGRlcXVlCmltcG9ydCByYW5kb20KaW1wb3J0IHRpbWUKZnJvbSBwcm9tZXRoZXVzX3RxZmQuZW50cm9weS5ybmQgaW1wb3J0IFJORFRhcmdldCwgUk5EUHJlZGljdG9yCmZyb20gcHJvbWV0aGV1c190cWZkLmVudHJvcHkubG9zcyBpbXBvcnQgY29tcHV0ZV90b3RhbF9lbnRyb3B5X2xvc3MKCmNsYXNzIEVudHJvcHlSZXBsYXlCdWZmZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2FwYWNpdHkpOgogICAgICAgIHNlbGYuYnVmZmVyID0gZGVxdWUobWF4bGVuPWNhcGFjaXR5KQoKICAgIGRlZiBhZGQoc2VsZiwgdHJhamVjdG9yeSk6CiAgICAgICAgZm9yIGkgaW4gcmFuZ2UobGVuKHRyYWplY3RvcnkpIC0gMSk6CiAgICAgICAgICAgIHN0ZXAgPSB0cmFqZWN0b3J5W2ldCiAgICAgICAgICAgIG5leHRfc3RlcCA9IHRyYWplY3RvcnlbaSsxXQogICAgICAgICAgICBwYWlyID0gewogICAgICAgICAgICAgICAgJ2ZpZWxkJzogc3RlcFsnZmllbGQnXSwKICAgICAgICAgICAgICAgICdib2FyZCc6IHN0ZXBbJ2JvYXJkJ10sCiAgICAgICAgICAgICAgICAnbWFzayc6IHN0ZXBbJ21hc2snXSwKICAgICAgICAgICAgICAgICdvcHBfbGVnYWxfY291bnQnOiBzdGVwWydvcHBfbGVnYWxfY291bnQnXSwKICAgICAgICAgICAgICAgICdlbmVyZ3lfY2FwdHVyZWQnOiBzdGVwWydlX2NhcHR1cmVkJ10sCiAgICAgICAgICAgICAgICAnZW5lcmd5X2JlZm9yZSc6IHN0ZXBbJ2VuZXJneV9iZWZvcmUnXSwKICAgICAgICAgICAgICAgICdlbmVyZ3lfbmV4dCc6IG5leHRfc3RlcFsnZW5lcmd5X2JlZm9yZSddLAogICAgICAgICAgICAgICAgJ2VuZXJneV9kaWZmJzogbmV4dF9zdGVwWydlbmVyZ3lfYmVmb3JlJ10gLSBzdGVwWydlbmVyZ3lfYmVmb3JlJ10KICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLmJ1ZmZlci5hcHBlbmQocGFpcikKCiAgICBkZWYgc2FtcGxlKHNlbGYsIGJhdGNoX3NpemUpOgogICAgICAgIGJhdGNoID0gcmFuZG9tLnNhbXBsZShzZWxmLmJ1ZmZlciwgYmF0Y2hfc2l6ZSkKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnZmllbGRzJzogdG9yY2guc3RhY2soW2l0ZW1bJ2ZpZWxkJ10gZm9yIGl0ZW0gaW4gYmF0Y2hdKSwKICAgICAgICAgICAgJ2JvYXJkcyc6IHRvcmNoLnN0YWNrKFtpdGVtWydib2FyZCddIGZvciBpdGVtIGluIGJhdGNoXSksCiAgICAgICAgICAgICdtYXNrcyc6IHRvcmNoLnN0YWNrKFtpdGVtWydtYXNrJ10gZm9yIGl0ZW0gaW4gYmF0Y2hdKSwKICAgICAgICAgICAgJ29wcF9sZWdhbF9jb3VudHMnOiB0b3JjaC50ZW5zb3IoW2l0ZW1bJ29wcF9sZWdhbF9jb3VudCddIGZvciBpdGVtIGluIGJhdGNoXSksCiAgICAgICAgICAgICdlbmVyZ3lfY2FwdHVyZWQnOiB0b3JjaC50ZW5zb3IoW2l0ZW1bJ2VuZXJneV9jYXB0dXJlZCddIGZvciBpdGVtIGluIGJhdGNoXSwgZHR5cGU9dG9yY2guZmxvYXQzMiksCiAgICAgICAgICAgICdlbmVyZ3lfbmV4dCc6IHRvcmNoLnRlbnNvcihbaXRlbVsnZW5lcmd5X25leHQnXSBmb3IgaXRlbSBpbiBiYXRjaF0sIGR0eXBlPXRvcmNoLmZsb2F0MzIpLAogICAgICAgICAgICAnZW5lcmd5X2RpZmYnOiB0b3JjaC50ZW5zb3IoW2l0ZW1bJ2VuZXJneV9kaWZmJ10gZm9yIGl0ZW0gaW4gYmF0Y2hdLCBkdHlwZT10b3JjaC5mbG9hdDMyKQogICAgICAgIH0KCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gbGVuKHNlbGYuYnVmZmVyKQoKY2xhc3MgRW50cm9weVRyYWluZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZmlnLCBkYXRhX3F1ZXVlLCB3ZWlnaHRzX3F1ZXVlLCBzdG9wX2V2ZW50LCBtZXRyaWNzX3F1ZXVlLCBzaGFyZWRfdmFsdWVzPU5vbmUpOgogICAgICAgIHNlbGYuY29uZmlnID0gY29uZmlnCiAgICAgICAgc2VsZi5kYXRhX3F1ZXVlID0gZGF0YV9xdWV1ZQogICAgICAgIHNlbGYud2VpZ2h0c19xdWV1ZSA9IHdlaWdodHNfcXVldWUKICAgICAgICBzZWxmLnN0b3BfZXZlbnQgPSBzdG9wX2V2ZW50CiAgICAgICAgc2VsZi5tZXRyaWNzX3F1ZXVlID0gbWV0cmljc19xdWV1ZQogICAgICAgIHNlbGYuc2hhcmVkX3ZhbHVlcyA9IHNoYXJlZF92YWx1ZXMKICAgICAgICAKICAgICAgICBmcm9tIHByb21ldGhldXNfdHFmZC5lbnRyb3B5Lm5ldHdvcmsgaW1wb3J0IEVudHJvcHlOZXR3b3JrCiAgICAgICAgc2VsZi5uZXR3b3JrID0gRW50cm9weU5ldHdvcmsoY29uZmlnKS50byhjb25maWcuZGV2aWNlKQogICAgICAgIHNlbGYub3B0aW1pemVyID0gQWRhbVcoc2VsZi5uZXR3b3JrLnBhcmFtZXRlcnMoKSwgbHI9Y29uZmlnLmVudHJvcHlfbGVhcm5pbmdfcmF0ZSkKICAgICAgICAKICAgICAgICBzZWxmLnJuZF90YXJnZXQgPSBSTkRUYXJnZXQoMTAyNCwgY29uZmlnLmVudHJvcHlfcm5kX2ZlYXR1cmVfZGltKS50byhjb25maWcuZGV2aWNlKQogICAgICAgIHNlbGYucm5kX3ByZWRpY3RvciA9IFJORFByZWRpY3RvcigxMDI0LCBjb25maWcuZW50cm9weV9ybmRfZmVhdHVyZV9kaW0pLnRvKGNvbmZpZy5kZXZpY2UpCiAgICAgICAgc2VsZi5ybmRfb3B0aW1pemVyID0gQWRhbVcoc2VsZi5ybmRfcHJlZGljdG9yLnBhcmFtZXRlcnMoKSwgbHI9MWUtNCkKICAgICAgICAKICAgICAgICBzZWxmLnNjYWxlciA9IEdyYWRTY2FsZXIoKQogICAgICAgIHNlbGYucmVwbGF5X2J1ZmZlciA9IEVudHJvcHlSZXBsYXlCdWZmZXIoY29uZmlnLmVudHJvcHlfcmVwbGF5X3NpemUpCiAgICAgICAgc2VsZi5nbG9iYWxfc3RlcCA9IDAKICAgICAgICBzZWxmLmdhbWVzX3BsYXllZCA9IDAKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHByaW50KCJFbnRyb3B5IFRyYWluZXIgc3RhcnRlZC4iKQogICAgICAgIHdoaWxlIG5vdCBzZWxmLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgICAgIHdoaWxlIG5vdCBzZWxmLmRhdGFfcXVldWUuZW1wdHkoKToKICAgICAgICAgICAgICAgIHRyYWplY3RvcnkgPSBzZWxmLmRhdGFfcXVldWUuZ2V0KCkKICAgICAgICAgICAgICAgIHNlbGYucmVwbGF5X2J1ZmZlci5hZGQodHJhamVjdG9yeSkKICAgICAgICAgICAgICAgIHNlbGYuZ2FtZXNfcGxheWVkICs9IDEKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiBsZW4oc2VsZi5yZXBsYXlfYnVmZmVyKSA+PSBzZWxmLmNvbmZpZy5taW5fYnVmZmVyX2JlZm9yZV90cmFpbmluZzoKICAgICAgICAgICAgICAgIHNlbGYuX3RyYWluX3N0ZXAoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZWxmLmdsb2JhbF9zdGVwICUgc2VsZi5jb25maWcud2VpZ2h0X3B1Ymxpc2hfaW50ZXJ2YWwgPT0gMDoKICAgICAgICAgICAgICAgICAgICBzdGF0ZV9kaWN0ID0gc2VsZi5uZXR3b3JrLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAgICAgICAgIHNlbGYud2VpZ2h0c19xdWV1ZS5wdXQoc3RhdGVfZGljdCkKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLnNoYXJlZF92YWx1ZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hhcmVkX3ZhbHVlc1snZW50cm9weV93ZWlnaHRzJ10gPSBzdGF0ZV9kaWN0CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hhcmVkX3ZhbHVlc1snZW50cm9weV9vcHRfc3RhdGUnXSA9IHNlbGYub3B0aW1pemVyLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNoYXJlZF92YWx1ZXNbJ2VudHJvcHlfc3RlcHMnXSA9IHNlbGYuZ2xvYmFsX3N0ZXAKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzWydlbnRyb3B5X2dhbWVzJ10gPSBzZWxmLmdhbWVzX3BsYXllZAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgIGRlZiBfdHJhaW5fc3RlcChzZWxmKToKICAgICAgICBzZWxmLm5ldHdvcmsudHJhaW4oKQogICAgICAgIGJhdGNoID0gc2VsZi5yZXBsYXlfYnVmZmVyLnNhbXBsZShzZWxmLmNvbmZpZy5lbnRyb3B5X2JhdGNoX3NpemUpCiAgICAgICAgZm9yIGsgaW4gYmF0Y2g6CiAgICAgICAgICAgIGJhdGNoW2tdID0gYmF0Y2hba10udG8oc2VsZi5jb25maWcuZGV2aWNlKQogICAgICAgICAgICAKICAgICAgICBzZWxmLm9wdGltaXplci56ZXJvX2dyYWQoKQogICAgICAgIHNlbGYucm5kX29wdGltaXplci56ZXJvX2dyYWQoKQogICAgICAgIAogICAgICAgIHdpdGggYXV0b2Nhc3QoKToKICAgICAgICAgICAgbG9zcywgbF9lbnQsIGxfY29ucywgbF9zbW9vdGgsIGxfdGQsIGxfbm92ZWwgPSBjb21wdXRlX3RvdGFsX2VudHJvcHlfbG9zcygKICAgICAgICAgICAgICAgIGJhdGNoLCBzZWxmLm5ldHdvcmssIHNlbGYucm5kX3RhcmdldCwgc2VsZi5ybmRfcHJlZGljdG9yLCBzZWxmLmNvbmZpZwogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgIHNlbGYuc2NhbGVyLnNjYWxlKGxvc3MpLmJhY2t3YXJkKCkKICAgICAgICBzZWxmLnNjYWxlci5zdGVwKHNlbGYub3B0aW1pemVyKQogICAgICAgIHNlbGYuc2NhbGVyLnN0ZXAoc2VsZi5ybmRfb3B0aW1pemVyKQogICAgICAgIHNlbGYuc2NhbGVyLnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICAgc2VsZi5nbG9iYWxfc3RlcCArPSAxCiAgICAgICAgCiAgICAgICAgIyBMb2cgbWV0cmljcwogICAgICAgIHNlbGYubWV0cmljc19xdWV1ZS5wdXQoewogICAgICAgICAgICAndHlwZSc6ICdlbnRyb3B5X21ldHJpY3MnLAogICAgICAgICAgICAnc3RlcCc6IHNlbGYuZ2xvYmFsX3N0ZXAsCiAgICAgICAgICAgICdsb3NzJzogbG9zcy5pdGVtKCksCiAgICAgICAgICAgICdsX2VudHJvcHknOiBsX2VudCwKICAgICAgICAgICAgJ2xfY29uc2VydmF0aW9uJzogbF9jb25zLAogICAgICAgICAgICAnbF9zbW9vdGhuZXNzJzogbF9zbW9vdGgsCiAgICAgICAgICAgICdsX3RkJzogbF90ZCwKICAgICAgICAgICAgJ2xfbm92ZWx0eSc6IGxfbm92ZWwsCiAgICAgICAgICAgICdnYW1lcyc6IHNlbGYuZ2FtZXNfcGxheWVkLAogICAgICAgICAgICAnYnVmZmVyX3NpemUnOiBsZW4oc2VsZi5yZXBsYXlfYnVmZmVyKQogICAgICAgIH0pCg==")
write_file_b64("prometheus_tqfd/entropy/selfplay.py", "aW1wb3J0IHRvcmNoCmltcG9ydCBjaGVzcwppbXBvcnQgcmFuZG9tCmltcG9ydCBudW1weSBhcyBucApmcm9tIHByb21ldGhldXNfdHFmZC5lbnRyb3B5LmZpZWxkcyBpbXBvcnQgRmllbGRDYWxjdWxhdG9yCmZyb20gcHJvbWV0aGV1c190cWZkLmVudHJvcHkubmV0d29yayBpbXBvcnQgYnVpbGRfZ3JhcGhfZGF0YSwgSEFTX1BZRwpmcm9tIHByb21ldGhldXNfdHFmZC5lbmNvZGluZyBpbXBvcnQgQm9hcmRFbmNvZGVyLCBNb3ZlRW5jb2RlcgoKY2xhc3MgRW50cm9weVNlbGZQbGF5V29ya2VyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmZpZywgd2VpZ2h0c19xdWV1ZSwgZGF0YV9xdWV1ZSwgc3RvcF9ldmVudCwgd29ya2VyX2lkKToKICAgICAgICBzZWxmLmNvbmZpZyA9IGNvbmZpZwogICAgICAgIHNlbGYud2VpZ2h0c19xdWV1ZSA9IHdlaWdodHNfcXVldWUKICAgICAgICBzZWxmLmRhdGFfcXVldWUgPSBkYXRhX3F1ZXVlCiAgICAgICAgc2VsZi5zdG9wX2V2ZW50ID0gc3RvcF9ldmVudAogICAgICAgIHNlbGYud29ya2VyX2lkID0gd29ya2VyX2lkCiAgICAgICAgCiAgICAgICAgZnJvbSBwcm9tZXRoZXVzX3RxZmQuZW50cm9weS5uZXR3b3JrIGltcG9ydCBFbnRyb3B5TmV0d29yawogICAgICAgIHNlbGYubmV0d29yayA9IEVudHJvcHlOZXR3b3JrKGNvbmZpZykudG8oY29uZmlnLmFjdG9yX2RldmljZSkKICAgICAgICBzZWxmLm5ldHdvcmsuZXZhbCgpCiAgICAgICAgCiAgICAgICAgc2VsZi5maWVsZF9jYWxjID0gRmllbGRDYWxjdWxhdG9yKGNvbmZpZy5waHlzaWNzKQogICAgICAgIHNlbGYuYm9hcmRfZW5jb2RlciA9IEJvYXJkRW5jb2RlcigpCiAgICAgICAgc2VsZi5tb3ZlX2VuY29kZXIgPSBNb3ZlRW5jb2RlcigpCiAgICAgICAgCiAgICAgICAgc2VsZi50ZW1wZXJhdHVyZSA9IGNvbmZpZy5lbnRyb3B5X3RlbXBfc3RhcnQKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHByaW50KGYiRW50cm9weSBXb3JrZXIge3NlbGYud29ya2VyX2lkfSBzdGFydGVkLiIpCiAgICAgICAgd2hpbGUgbm90IHNlbGYuc3RvcF9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgaWYgbm90IHNlbGYud2VpZ2h0c19xdWV1ZS5lbXB0eSgpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYubmV0d29yay5sb2FkX3N0YXRlX2RpY3Qoc2VsZi53ZWlnaHRzX3F1ZXVlLmdldF9ub3dhaXQoKSkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIAogICAgICAgICAgICB0cmFqZWN0b3J5ID0gc2VsZi5fcGxheV9nYW1lKCkKICAgICAgICAgICAgc2VsZi5kYXRhX3F1ZXVlLnB1dCh0cmFqZWN0b3J5KQogICAgICAgICAgICAKICAgICAgICAgICAgIyBBbm5lYWwgdGVtcGVyYXR1cmUKICAgICAgICAgICAgc2VsZi50ZW1wZXJhdHVyZSA9IG1heChzZWxmLmNvbmZpZy5lbnRyb3B5X3RlbXBfZW5kLCBzZWxmLnRlbXBlcmF0dXJlICogc2VsZi5jb25maWcuZW50cm9weV90ZW1wX2RlY2F5KQoKICAgIGRlZiBfcGxheV9nYW1lKHNlbGYpOgogICAgICAgIGJvYXJkID0gY2hlc3MuQm9hcmQoKQogICAgICAgIHRyYWplY3RvcnkgPSBbXQogICAgICAgIAogICAgICAgIHdoaWxlIG5vdCBib2FyZC5pc19nYW1lX292ZXIoKSBhbmQgbm90IHNlbGYuc3RvcF9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgZmllbGRfdGVuc29yID0gc2VsZi5maWVsZF9jYWxjLmNvbXB1dGVfZmllbGRzKGJvYXJkKS51bnNxdWVlemUoMCkudG8oc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICBpZiBzZWxmLm5ldHdvcmsuaGFzX3B5ZzoKICAgICAgICAgICAgICAgIGJvYXJkX2RhdGEgPSBidWlsZF9ncmFwaF9kYXRhKGJvYXJkKQogICAgICAgICAgICAgICAgaWYgYm9hcmRfZGF0YTogYm9hcmRfZGF0YSA9IGJvYXJkX2RhdGEudG8oc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYm9hcmRfZGF0YSA9IHNlbGYuYm9hcmRfZW5jb2Rlci5lbmNvZGUoYm9hcmQpLnVuc3F1ZWV6ZSgwKS50byhzZWxmLmNvbmZpZy5hY3Rvcl9kZXZpY2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgbWFzayA9IHNlbGYubW92ZV9lbmNvZGVyLmdldF9sZWdhbF9tYXNrKGJvYXJkKS51bnNxdWVlemUoMCkudG8oc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICAKICAgICAgICAgICAgd2l0aCB0b3JjaC5ub19ncmFkKCk6CiAgICAgICAgICAgICAgICBwcm9icywgZW5lcmd5LCBfLCBfID0gc2VsZi5uZXR3b3JrKGZpZWxkX3RlbnNvciwgYm9hcmRfZGF0YSwgbWFzaykKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQm9sdHptYW5uIHNhbXBsaW5nCiAgICAgICAgICAgIHByb2JzID0gcHJvYnNbMF0uY3B1KCkubnVtcHkoKQogICAgICAgICAgICBsZWdhbF9tb3ZlcyA9IGxpc3QoYm9hcmQubGVnYWxfbW92ZXMpCiAgICAgICAgICAgIGxlZ2FsX2luZGljZXMgPSBbc2VsZi5tb3ZlX2VuY29kZXIubW92ZV90b19pbmRleChtKSBmb3IgbSBpbiBsZWdhbF9tb3Zlc10KICAgICAgICAgICAgCiAgICAgICAgICAgIHBfbGVnYWwgPSBwcm9ic1tsZWdhbF9pbmRpY2VzXQogICAgICAgICAgICBwX2xlZ2FsID0gbnAubWF4aW11bShwX2xlZ2FsLCAxZS04KQogICAgICAgICAgICAKICAgICAgICAgICAgIyBBcHBseSB0ZW1wZXJhdHVyZQogICAgICAgICAgICBsb2dpdHMgPSBucC5sb2cocF9sZWdhbCkgLyBzZWxmLnRlbXBlcmF0dXJlCiAgICAgICAgICAgIGV4cF9sb2dpdHMgPSBucC5leHAobG9naXRzIC0gbnAubWF4KGxvZ2l0cykpCiAgICAgICAgICAgIHBfZmluYWwgPSBleHBfbG9naXRzIC8gZXhwX2xvZ2l0cy5zdW0oKQogICAgICAgICAgICAKICAgICAgICAgICAgbW92ZV9pZHggPSBucC5yYW5kb20uY2hvaWNlKGxlbihsZWdhbF9tb3ZlcyksIHA9cF9maW5hbCkKICAgICAgICAgICAgbW92ZSA9IGxlZ2FsX21vdmVzW21vdmVfaWR4XQogICAgICAgICAgICAKICAgICAgICAgICAgIyBPcHBvbmVudCBsZWdhbCBjb3VudCBmb3IgZW50cm9weSBsb3NzCiAgICAgICAgICAgIHRlbXBfYm9hcmQgPSBib2FyZC5jb3B5KCkKICAgICAgICAgICAgdGVtcF9ib2FyZC5wdXNoKG1vdmUpCiAgICAgICAgICAgIG9wcF9sZWdhbF9jb3VudCA9IHRlbXBfYm9hcmQubGVnYWxfbW92ZXMuY291bnQoKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBFbmVyZ3kgY2FwdHVyZWQKICAgICAgICAgICAgY2FwdHVyZWRfcGllY2UgPSBib2FyZC5waWVjZV9hdChtb3ZlLnRvX3NxdWFyZSkKICAgICAgICAgICAgZV9jYXB0dXJlZCA9IHNlbGYuZmllbGRfY2FsYy5waWVjZV9lbmVyZ2llc1tjYXB0dXJlZF9waWVjZS5waWVjZV90eXBlXSBpZiBjYXB0dXJlZF9waWVjZSBlbHNlIDAuMAogICAgICAgICAgICAKICAgICAgICAgICAgc3RlcF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2ZpZWxkJzogZmllbGRfdGVuc29yLmNwdSgpLnNxdWVlemUoMCksCiAgICAgICAgICAgICAgICAnYm9hcmQnOiBib2FyZF9kYXRhLnguY3B1KCkgaWYgc2VsZi5uZXR3b3JrLmhhc19weWcgZWxzZSBib2FyZF9kYXRhLmNwdSgpLnNxdWVlemUoMCksCiAgICAgICAgICAgICAgICAnbWFzayc6IG1hc2suY3B1KCkuc3F1ZWV6ZSgwKSwKICAgICAgICAgICAgICAgICdvcHBfbGVnYWxfY291bnQnOiBvcHBfbGVnYWxfY291bnQsCiAgICAgICAgICAgICAgICAnZV9jYXB0dXJlZCc6IGVfY2FwdHVyZWQsCiAgICAgICAgICAgICAgICAnZW5lcmd5X2JlZm9yZSc6IGVuZXJneS5pdGVtKCksCiAgICAgICAgICAgICAgICAnYm9hcmRfb2JqJzogYm9hcmQuY29weSgpICMgRm9yIGxhdGVyIGJ1aWxkaW5nIHBhaXJzCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHRyYWplY3RvcnkuYXBwZW5kKHN0ZXBfZGF0YSkKICAgICAgICAgICAgYm9hcmQucHVzaChtb3ZlKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gdHJhamVjdG9yeQo=")
write_file_b64("prometheus_tqfd/entropy/rnd.py", "aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gubm4uZnVuY3Rpb25hbCBhcyBGCgpjbGFzcyBSTkRUYXJnZXQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbl9kaW0sIG91dF9kaW0pOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuZmMgPSBubi5TZXF1ZW50aWFsKAogICAgICAgICAgICBubi5MaW5lYXIoaW5fZGltLCAyNTYpLAogICAgICAgICAgICBubi5SZUxVKCksCiAgICAgICAgICAgIG5uLkxpbmVhcigyNTYsIG91dF9kaW0pCiAgICAgICAgKQogICAgICAgICMgUmFuZG9tbHkgaW5pdGlhbGl6ZWQgYW5kIGZyb3plbgogICAgICAgIGZvciBwIGluIHNlbGYucGFyYW1ldGVycygpOgogICAgICAgICAgICBwLnJlcXVpcmVzX2dyYWQgPSBGYWxzZQoKY2xhc3MgUk5EUHJlZGljdG9yKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaW5fZGltLCBvdXRfZGltKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmZjID0gbm4uU2VxdWVudGlhbCgKICAgICAgICAgICAgbm4uTGluZWFyKGluX2RpbSwgMjU2KSwKICAgICAgICAgICAgbm4uUmVMVSgpLAogICAgICAgICAgICBubi5MaW5lYXIoMjU2LCBvdXRfZGltKQogICAgICAgICkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICByZXR1cm4gc2VsZi5mYyh4KQoKZGVmIGNvbXB1dGVfbm92ZWx0eShmdXNlZF9mZWF0dXJlcywgcm5kX3RhcmdldCwgcm5kX3ByZWRpY3Rvcik6CiAgICB3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgICAgICB0YXJnZXRfb3V0ID0gcm5kX3RhcmdldChmdXNlZF9mZWF0dXJlcykKICAgIHByZWRpY3Rvcl9vdXQgPSBybmRfcHJlZGljdG9yKGZ1c2VkX2ZlYXR1cmVzKQogICAgCiAgICBlcnJvciA9IHRvcmNoLm1lYW4oKHRhcmdldF9vdXQgLSBwcmVkaWN0b3Jfb3V0KSoqMiwgZGltPS0xKQogICAgcmV0dXJuIGVycm9yCg==")
write_file_b64("prometheus_tqfd/dashboard/heatmaps.py", "aW1wb3J0IHBsb3RseS5ncmFwaF9vYmplY3RzIGFzIGdvCmltcG9ydCBudW1weSBhcyBucAoKZGVmIHJlbmRlcl9oZWF0bWFwKGRhdGEsIHRpdGxlLCBjb2xvcnNjYWxlPSdSZEJ1Jyk6CiAgICBmaWcgPSBnby5GaWd1cmUoZGF0YT1nby5IZWF0bWFwKAogICAgICAgIHo9ZGF0YSwKICAgICAgICBjb2xvcnNjYWxlPWNvbG9yc2NhbGUsCiAgICAgICAgem1pZD0wIGlmIGNvbG9yc2NhbGUgPT0gJ1JkQnUnIGVsc2UgTm9uZSwKICAgICAgICBzaG93c2NhbGU9VHJ1ZQogICAgKSkKICAgIGZpZy51cGRhdGVfbGF5b3V0KAogICAgICAgIHRpdGxlPXRpdGxlLAogICAgICAgIHhheGlzPWRpY3QodGlja3RleHQ9bGlzdCgnYWJjZGVmZ2gnKSwgdGlja3ZhbHM9bGlzdChyYW5nZSg4KSkpLAogICAgICAgIHlheGlzPWRpY3QodGlja3RleHQ9bGlzdCgnMTIzNDU2NzgnKSwgdGlja3ZhbHM9bGlzdChyYW5nZSg4KSkpLAogICAgICAgIHdpZHRoPTQwMCwgaGVpZ2h0PTQwMAogICAgKQogICAgcmV0dXJuIGZpZwoKZGVmIGdldF9hdGxhc19oZWF0bWFwKG1jdHNfcm9vdCk6CiAgICBoZWF0bWFwID0gbnAuemVyb3MoKDgsIDgpKQogICAgZm9yIG1vdmUsIGNoaWxkIGluIG1jdHNfcm9vdC5jaGlsZHJlbi5pdGVtcygpOgogICAgICAgIHRvX3NxdWFyZSA9IG1vdmUudG9fc3F1YXJlCiAgICAgICAgcm93LCBjb2wgPSBkaXZtb2QodG9fc3F1YXJlLCA4KQogICAgICAgIGhlYXRtYXBbcm93LCBjb2xdICs9IGNoaWxkLnZpc2l0X2NvdW50CiAgICBpZiBoZWF0bWFwLm1heCgpID4gMDoKICAgICAgICBoZWF0bWFwIC89IGhlYXRtYXAubWF4KCkKICAgIHJldHVybiBoZWF0bWFwCgpkZWYgZ2V0X2VudHJvcHlfaGVhdG1hcChwaGlfdGVuc29yKToKICAgICMgcGhpX3RlbnNvcjogWzgsIDhdCiAgICByZXR1cm4gcGhpX3RlbnNvci5udW1weSgpCg==")
write_file_b64("prometheus_tqfd/dashboard/app.py", "aW1wb3J0IHN0cmVhbWxpdCBhcyBzdAppbXBvcnQgcGFuZGFzIGFzIHBkCmltcG9ydCBqc29uCmltcG9ydCB0aW1lCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAppbXBvcnQgcGxvdGx5LmV4cHJlc3MgYXMgcHgKZnJvbSBwcm9tZXRoZXVzX3RxZmQuZGFzaGJvYXJkLmhlYXRtYXBzIGltcG9ydCByZW5kZXJfaGVhdG1hcAoKc3Quc2V0X3BhZ2VfY29uZmlnKHBhZ2VfdGl0bGU9IlBST01FVEhFVVMtVFFGRCBEYXNoYm9hcmQiLCBsYXlvdXQ9IndpZGUiKQoKc3QudGl0bGUoIvCflKUgUFJPTUVUSEVVUy1UUUZEIENoZXNzIFRyYWluaW5nIikKCiMgU2lkZWJhcgpzdC5zaWRlYmFyLmhlYWRlcigiQ29udHJvbHMiKQppZiBzdC5zaWRlYmFyLmJ1dHRvbigiQ2hlY2twb2ludCBOb3ciKToKICAgIHBhc3MgIyBTZW5kIHNpZ25hbCB0byBzdXBlcnZpc29yCmlmIHN0LnNpZGViYXIuYnV0dG9uKCJQYXVzZS9SZXN1bWUiKToKICAgIHBhc3MKCiMgTG9hZCBNZXRyaWNzCiMgV2Ugc2hvdWxkIGZpbmQgdGhlIGxhdGVzdCBydW5faWQKZGVmIGdldF9sYXRlc3RfcnVuX2RpcigpOgogICAgYmFzZSA9IFBhdGgoIi9jb250ZW50L3Byb21ldGhldXNfcnVucyIpCiAgICBpZiBub3QgYmFzZS5leGlzdHMoKTogcmV0dXJuIE5vbmUKICAgIHJ1bnMgPSBzb3J0ZWQoW2QgZm9yIGQgaW4gYmFzZS5pdGVyZGlyKCkgaWYgZC5pc19kaXIoKV0sIGtleT1sYW1iZGEgeDogeC5uYW1lLCByZXZlcnNlPVRydWUpCiAgICByZXR1cm4gcnVuc1swXSBpZiBydW5zIGVsc2UgTm9uZQoKcnVuX2RpciA9IGdldF9sYXRlc3RfcnVuX2RpcigpCm1ldHJpY3NfZmlsZSA9IHJ1bl9kaXIgLyAibWV0cmljcyIgLyAibWV0cmljcy5qc29ubCIgaWYgcnVuX2RpciBlbHNlIE5vbmUKCmRlZiBsb2FkX21ldHJpY3MoKToKICAgIGlmIG5vdCBtZXRyaWNzX2ZpbGUgb3Igbm90IG1ldHJpY3NfZmlsZS5leGlzdHMoKTogcmV0dXJuIFtdCiAgICBkYXRhID0gW10KICAgIHdpdGggb3BlbihtZXRyaWNzX2ZpbGUsICdyJykgYXMgZjoKICAgICAgICBmb3IgbGluZSBpbiBmOgogICAgICAgICAgICBkYXRhLmFwcGVuZChqc29uLmxvYWRzKGxpbmUpKQogICAgcmV0dXJuIGRhdGEKCm1ldHJpY3MgPSBsb2FkX21ldHJpY3MoKQoKdGFiMSwgdGFiMiwgdGFiMywgdGFiNCwgdGFiNSA9IHN0LnRhYnMoWyJPdmVydmlldyIsICJMZWFybmluZyBDdXJ2ZXMiLCAiSGVhdG1hcHMiLCAiTGl2ZSBHYW1lIiwgIlBoeXNpY3MgVHVuaW5nIl0pCgp3aXRoIHRhYjE6CiAgICBjb2wxLCBjb2wyLCBjb2wzID0gc3QuY29sdW1ucygzKQogICAgIyBQbGFjZWhvbGRlciBmb3IgcmVhbCB2YWx1ZXMKICAgIGNvbDEubWV0cmljKCJBVExBUyBFTE8iLCAiMTAwMCIpCiAgICBjb2wyLm1ldHJpYygiRU5UUk9QWSBFTE8iLCAiMTAwMCIpCiAgICBjb2wzLm1ldHJpYygiR2FtZXMgUGxheWVkIiwgbGVuKFttIGZvciBtIGluIG1ldHJpY3MgaWYgbS5nZXQoJ3R5cGUnKSA9PSAnZHVlbCddKSkKCndpdGggdGFiMjoKICAgIHN0LnN1YmhlYWRlcigiTG9zcyBDdXJ2ZXMiKQogICAgYXRsYXNfbWV0cmljcyA9IFttIGZvciBtIGluIG1ldHJpY3MgaWYgbS5nZXQoJ3R5cGUnKSA9PSAnYXRsYXNfbWV0cmljcyddCiAgICBpZiBhdGxhc19tZXRyaWNzOgogICAgICAgIGRmX2F0bGFzID0gcGQuRGF0YUZyYW1lKGF0bGFzX21ldHJpY3MpCiAgICAgICAgc3QubGluZV9jaGFydChkZl9hdGxhcy5zZXRfaW5kZXgoJ3N0ZXAnKVtbJ2xvc3MnLCAncG9saWN5X2xvc3MnLCAndmFsdWVfbG9zcyddXSkKICAgICAgICAKICAgIGVudHJvcHlfbWV0cmljcyA9IFttIGZvciBtIGluIG1ldHJpY3MgaWYgbS5nZXQoJ3R5cGUnKSA9PSAnZW50cm9weV9tZXRyaWNzJ10KICAgIGlmIGVudHJvcHlfbWV0cmljczoKICAgICAgICBkZl9lbnRyb3B5ID0gcGQuRGF0YUZyYW1lKGVudHJvcHlfbWV0cmljcykKICAgICAgICBzdC5saW5lX2NoYXJ0KGRmX2VudHJvcHkuc2V0X2luZGV4KCdzdGVwJylbWydsb3NzJywgJ2xfZW50cm9weScsICdsX2NvbnNlcnZhdGlvbicsICdsX3RkJ11dKQoKd2l0aCB0YWI1OgogICAgc3Quc3ViaGVhZGVyKCJUaGVybW9keW5hbWljIENvbnN0YW50cyIpCiAgICAjIFRoaXMgdGFiIHdvdWxkIGFsbG93IGFkanVzdGluZyBwaHlzaWNzIHZpYSBhIGNvbmZpZyBmaWxlIHRoYXQgc3VwZXJ2aXNvciB3YXRjaGVzCiAgICBzdC5zbGlkZXIoIkRpZmZ1c2lvbiBTaWdtYSAoz4MpIiwgMC4xLCA1LjAsIDIuNSkKICAgIHN0LnNsaWRlcigiRW5lcmd5IEtpbmciLCAxMDAuMCwgMjAwMC4wLCAxMDAwLjApCgpzdC5zaWRlYmFyLnRleHQoZiJVcHRpbWU6IHt0aW1lLnRpbWUoKTouMGZ9IikK")
write_file_b64("prometheus_tqfd/atlas/network.py", "aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gubm4uZnVuY3Rpb25hbCBhcyBGCgpjbGFzcyBSZXNpZHVhbEJsb2NrKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2hhbm5lbHMpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBubi5Db252MmQoY2hhbm5lbHMsIGNoYW5uZWxzLCBrZXJuZWxfc2l6ZT0zLCBwYWRkaW5nPTEpCiAgICAgICAgc2VsZi5ibjEgPSBubi5CYXRjaE5vcm0yZChjaGFubmVscykKICAgICAgICBzZWxmLmNvbnYyID0gbm4uQ29udjJkKGNoYW5uZWxzLCBjaGFubmVscywga2VybmVsX3NpemU9MywgcGFkZGluZz0xKQogICAgICAgIHNlbGYuYm4yID0gbm4uQmF0Y2hOb3JtMmQoY2hhbm5lbHMpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgcmVzaWR1YWwgPSB4CiAgICAgICAgb3V0ID0gRi5yZWx1KHNlbGYuYm4xKHNlbGYuY29udjEoeCkpKQogICAgICAgIG91dCA9IHNlbGYuYm4yKHNlbGYuY29udjIob3V0KSkKICAgICAgICBvdXQgKz0gcmVzaWR1YWwKICAgICAgICByZXR1cm4gRi5yZWx1KG91dCkKCmNsYXNzIFBvbGljeUhlYWQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjaGFubmVscyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5jb252ID0gbm4uQ29udjJkKGNoYW5uZWxzLCAzMiwga2VybmVsX3NpemU9MSkKICAgICAgICBzZWxmLmJuID0gbm4uQmF0Y2hOb3JtMmQoMzIpCiAgICAgICAgc2VsZi5mYyA9IG5uLkxpbmVhcigzMiAqIDggKiA4LCA0NjcyKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIG91dCA9IEYucmVsdShzZWxmLmJuKHNlbGYuY29udih4KSkpCiAgICAgICAgb3V0ID0gb3V0LnZpZXcob3V0LnNpemUoMCksIC0xKQogICAgICAgIHJldHVybiBzZWxmLmZjKG91dCkKCmNsYXNzIFZhbHVlSGVhZChubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNoYW5uZWxzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbnYgPSBubi5Db252MmQoY2hhbm5lbHMsIDQsIGtlcm5lbF9zaXplPTEpCiAgICAgICAgc2VsZi5ibiA9IG5uLkJhdGNoTm9ybTJkKDQpCiAgICAgICAgc2VsZi5mYzEgPSBubi5MaW5lYXIoNCAqIDggKiA4LCAyNTYpCiAgICAgICAgc2VsZi5mYzIgPSBubi5MaW5lYXIoMjU2LCAxKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIG91dCA9IEYucmVsdShzZWxmLmJuKHNlbGYuY29udih4KSkpCiAgICAgICAgb3V0ID0gb3V0LnZpZXcob3V0LnNpemUoMCksIC0xKQogICAgICAgIG91dCA9IEYucmVsdShzZWxmLmZjMShvdXQpKQogICAgICAgIHJldHVybiB0b3JjaC50YW5oKHNlbGYuZmMyKG91dCkpCgpjbGFzcyBBdGxhc05ldHdvcmsobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25maWcpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuaW5wdXRfYmxvY2sgPSBubi5TZXF1ZW50aWFsKAogICAgICAgICAgICBubi5Db252MmQoY29uZmlnLmF0bGFzX2lucHV0X2NoYW5uZWxzLCBjb25maWcuYXRsYXNfY2hhbm5lbHMsIGtlcm5lbF9zaXplPTMsIHBhZGRpbmc9MSksCiAgICAgICAgICAgIG5uLkJhdGNoTm9ybTJkKGNvbmZpZy5hdGxhc19jaGFubmVscyksCiAgICAgICAgICAgIG5uLlJlTFUoKQogICAgICAgICkKICAgICAgICBzZWxmLnJlc190b3dlciA9IG5uLk1vZHVsZUxpc3QoWwogICAgICAgICAgICBSZXNpZHVhbEJsb2NrKGNvbmZpZy5hdGxhc19jaGFubmVscykgZm9yIF8gaW4gcmFuZ2UoY29uZmlnLmF0bGFzX3Jlc19ibG9ja3MpCiAgICAgICAgXSkKICAgICAgICBzZWxmLnBvbGljeV9oZWFkID0gUG9saWN5SGVhZChjb25maWcuYXRsYXNfY2hhbm5lbHMpCiAgICAgICAgc2VsZi52YWx1ZV9oZWFkID0gVmFsdWVIZWFkKGNvbmZpZy5hdGxhc19jaGFubmVscykKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICB4ID0gc2VsZi5pbnB1dF9ibG9jayh4KQogICAgICAgIGZvciBibG9jayBpbiBzZWxmLnJlc190b3dlcjoKICAgICAgICAgICAgeCA9IGJsb2NrKHgpCiAgICAgICAgcG9saWN5X2xvZ2l0cyA9IHNlbGYucG9saWN5X2hlYWQoeCkKICAgICAgICB2YWx1ZSA9IHNlbGYudmFsdWVfaGVhZCh4KQogICAgICAgIHJldHVybiBwb2xpY3lfbG9naXRzLCB2YWx1ZQo=")
write_file_b64("prometheus_tqfd/atlas/trainer.py", "aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKZnJvbSB0b3JjaC5vcHRpbSBpbXBvcnQgQWRhbVcKZnJvbSB0b3JjaC5jdWRhLmFtcCBpbXBvcnQgR3JhZFNjYWxlciwgYXV0b2Nhc3QKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgZGVxdWUKaW1wb3J0IHJhbmRvbQppbXBvcnQgdGltZQoKY2xhc3MgUmVwbGF5QnVmZmVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNhcGFjaXR5KToKICAgICAgICBzZWxmLmJ1ZmZlciA9IGRlcXVlKG1heGxlbj1jYXBhY2l0eSkKCiAgICBkZWYgYWRkKHNlbGYsIHRyYWplY3RvcnkpOgogICAgICAgIGZvciBzdGVwIGluIHRyYWplY3Rvcnk6CiAgICAgICAgICAgIHNlbGYuYnVmZmVyLmFwcGVuZChzdGVwKQoKICAgIGRlZiBzYW1wbGUoc2VsZiwgYmF0Y2hfc2l6ZSk6CiAgICAgICAgYmF0Y2ggPSByYW5kb20uc2FtcGxlKHNlbGYuYnVmZmVyLCBiYXRjaF9zaXplKQogICAgICAgIHN0YXRlcyA9IHRvcmNoLnN0YWNrKFtzWydzdGF0ZSddIGZvciBzIGluIGJhdGNoXSkKICAgICAgICBwb2xpY2llcyA9IHRvcmNoLnN0YWNrKFtzWydwb2xpY3knXSBmb3IgcyBpbiBiYXRjaF0pCiAgICAgICAgdmFsdWVzID0gdG9yY2gudGVuc29yKFtzWyd2YWx1ZSddIGZvciBzIGluIGJhdGNoXSwgZHR5cGU9dG9yY2guZmxvYXQzMikKICAgICAgICByZXR1cm4gc3RhdGVzLCBwb2xpY2llcywgdmFsdWVzCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLmJ1ZmZlcikKCmNsYXNzIEF0bGFzVHJhaW5lcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25maWcsIGRhdGFfcXVldWUsIHdlaWdodHNfcXVldWUsIHN0b3BfZXZlbnQsIG1ldHJpY3NfcXVldWUsIHNoYXJlZF92YWx1ZXM9Tm9uZSk6CiAgICAgICAgc2VsZi5jb25maWcgPSBjb25maWcKICAgICAgICBzZWxmLmRhdGFfcXVldWUgPSBkYXRhX3F1ZXVlCiAgICAgICAgc2VsZi53ZWlnaHRzX3F1ZXVlID0gd2VpZ2h0c19xdWV1ZQogICAgICAgIHNlbGYuc3RvcF9ldmVudCA9IHN0b3BfZXZlbnQKICAgICAgICBzZWxmLm1ldHJpY3NfcXVldWUgPSBtZXRyaWNzX3F1ZXVlCiAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzID0gc2hhcmVkX3ZhbHVlcwogICAgICAgIAogICAgICAgIGZyb20gcHJvbWV0aGV1c190cWZkLmF0bGFzLm5ldHdvcmsgaW1wb3J0IEF0bGFzTmV0d29yawogICAgICAgIHNlbGYubmV0d29yayA9IEF0bGFzTmV0d29yayhjb25maWcpLnRvKGNvbmZpZy5kZXZpY2UpCiAgICAgICAgc2VsZi5vcHRpbWl6ZXIgPSBBZGFtVyhzZWxmLm5ldHdvcmsucGFyYW1ldGVycygpLCBscj1jb25maWcuYXRsYXNfbGVhcm5pbmdfcmF0ZSwgd2VpZ2h0X2RlY2F5PWNvbmZpZy5hdGxhc193ZWlnaHRfZGVjYXkpCiAgICAgICAgc2VsZi5zY2FsZXIgPSBHcmFkU2NhbGVyKCkKICAgICAgICAKICAgICAgICBzZWxmLnJlcGxheV9idWZmZXIgPSBSZXBsYXlCdWZmZXIoY29uZmlnLmF0bGFzX3JlcGxheV9zaXplKQogICAgICAgIHNlbGYuZ2xvYmFsX3N0ZXAgPSAwCiAgICAgICAgc2VsZi5nYW1lc19wbGF5ZWQgPSAwCgogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICBwcmludCgiQXRsYXMgVHJhaW5lciBzdGFydGVkLiIpCiAgICAgICAgd2hpbGUgbm90IHNlbGYuc3RvcF9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgIyBDb2xsZWN0IGRhdGEKICAgICAgICAgICAgd2hpbGUgbm90IHNlbGYuZGF0YV9xdWV1ZS5lbXB0eSgpOgogICAgICAgICAgICAgICAgdHJhamVjdG9yeSA9IHNlbGYuZGF0YV9xdWV1ZS5nZXQoKQogICAgICAgICAgICAgICAgc2VsZi5yZXBsYXlfYnVmZmVyLmFkZCh0cmFqZWN0b3J5KQogICAgICAgICAgICAgICAgc2VsZi5nYW1lc19wbGF5ZWQgKz0gMQogICAgICAgICAgICAKICAgICAgICAgICAgIyBUcmFpbiBpZiBlbm91Z2ggZGF0YQogICAgICAgICAgICBpZiBsZW4oc2VsZi5yZXBsYXlfYnVmZmVyKSA+PSBzZWxmLmNvbmZpZy5taW5fYnVmZmVyX2JlZm9yZV90cmFpbmluZzoKICAgICAgICAgICAgICAgIHNlbGYuX3RyYWluX3N0ZXAoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZWxmLmdsb2JhbF9zdGVwICUgc2VsZi5jb25maWcud2VpZ2h0X3B1Ymxpc2hfaW50ZXJ2YWwgPT0gMDoKICAgICAgICAgICAgICAgICAgICBzdGF0ZV9kaWN0ID0gc2VsZi5uZXR3b3JrLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAgICAgICAgIHNlbGYud2VpZ2h0c19xdWV1ZS5wdXQoc3RhdGVfZGljdCkKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLnNoYXJlZF92YWx1ZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hhcmVkX3ZhbHVlc1snYXRsYXNfd2VpZ2h0cyddID0gc3RhdGVfZGljdAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNoYXJlZF92YWx1ZXNbJ2F0bGFzX29wdF9zdGF0ZSddID0gc2VsZi5vcHRpbWl6ZXIuc3RhdGVfZGljdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hhcmVkX3ZhbHVlc1snYXRsYXNfc3RlcHMnXSA9IHNlbGYuZ2xvYmFsX3N0ZXAKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzWydhdGxhc19nYW1lcyddID0gc2VsZi5nYW1lc19wbGF5ZWQKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKCiAgICBkZWYgX3RyYWluX3N0ZXAoc2VsZik6CiAgICAgICAgc2VsZi5uZXR3b3JrLnRyYWluKCkKICAgICAgICBzdGF0ZXMsIHRhcmdldF9wb2xpY2llcywgdGFyZ2V0X3ZhbHVlcyA9IHNlbGYucmVwbGF5X2J1ZmZlci5zYW1wbGUoc2VsZi5jb25maWcuYXRsYXNfYmF0Y2hfc2l6ZSkKICAgICAgICBzdGF0ZXMsIHRhcmdldF9wb2xpY2llcywgdGFyZ2V0X3ZhbHVlcyA9IHN0YXRlcy50byhzZWxmLmNvbmZpZy5kZXZpY2UpLCB0YXJnZXRfcG9saWNpZXMudG8oc2VsZi5jb25maWcuZGV2aWNlKSwgdGFyZ2V0X3ZhbHVlcy50byhzZWxmLmNvbmZpZy5kZXZpY2UpCiAgICAgICAgCiAgICAgICAgc2VsZi5vcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICB3aXRoIGF1dG9jYXN0KCk6CiAgICAgICAgICAgIHBvbGljeV9sb2dpdHMsIHZhbHVlX3ByZWQgPSBzZWxmLm5ldHdvcmsoc3RhdGVzKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBQb2xpY3kgbG9zczogQ3Jvc3MtZW50cm9weQogICAgICAgICAgICBsb2dfcHJvYnMgPSBGLmxvZ19zb2Z0bWF4KHBvbGljeV9sb2dpdHMsIGRpbT0xKQogICAgICAgICAgICBwb2xpY3lfbG9zcyA9IC10b3JjaC5zdW0odGFyZ2V0X3BvbGljaWVzICogbG9nX3Byb2JzLCBkaW09MSkubWVhbigpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFZhbHVlIGxvc3M6IE1TRQogICAgICAgICAgICB2YWx1ZV9sb3NzID0gRi5tc2VfbG9zcyh2YWx1ZV9wcmVkLnZpZXcoLTEpLCB0YXJnZXRfdmFsdWVzKQogICAgICAgICAgICAKICAgICAgICAgICAgdG90YWxfbG9zcyA9IHBvbGljeV9sb3NzICsgdmFsdWVfbG9zcwogICAgICAgICAgICAKICAgICAgICBzZWxmLnNjYWxlci5zY2FsZSh0b3RhbF9sb3NzKS5iYWNrd2FyZCgpCiAgICAgICAgc2VsZi5zY2FsZXIuc3RlcChzZWxmLm9wdGltaXplcikKICAgICAgICBzZWxmLnNjYWxlci51cGRhdGUoKQogICAgICAgIAogICAgICAgIHNlbGYuZ2xvYmFsX3N0ZXAgKz0gMQogICAgICAgIAogICAgICAgICMgTG9nIG1ldHJpY3MKICAgICAgICBzZWxmLm1ldHJpY3NfcXVldWUucHV0KHsKICAgICAgICAgICAgJ3R5cGUnOiAnYXRsYXNfbWV0cmljcycsCiAgICAgICAgICAgICdzdGVwJzogc2VsZi5nbG9iYWxfc3RlcCwKICAgICAgICAgICAgJ2xvc3MnOiB0b3RhbF9sb3NzLml0ZW0oKSwKICAgICAgICAgICAgJ3BvbGljeV9sb3NzJzogcG9saWN5X2xvc3MuaXRlbSgpLAogICAgICAgICAgICAndmFsdWVfbG9zcyc6IHZhbHVlX2xvc3MuaXRlbSgpLAogICAgICAgICAgICAnZ2FtZXMnOiBzZWxmLmdhbWVzX3BsYXllZCwKICAgICAgICAgICAgJ2J1ZmZlcl9zaXplJzogbGVuKHNlbGYucmVwbGF5X2J1ZmZlcikKICAgICAgICB9KQo=")
write_file_b64("prometheus_tqfd/atlas/selfplay.py", "aW1wb3J0IHRvcmNoCmltcG9ydCBjaGVzcwpmcm9tIHByb21ldGhldXNfdHFmZC5hdGxhcy5tY3RzIGltcG9ydCBNQ1RTCmZyb20gcHJvbWV0aGV1c190cWZkLmVuY29kaW5nIGltcG9ydCBCb2FyZEVuY29kZXIsIE1vdmVFbmNvZGVyCmltcG9ydCB0aW1lCgpjbGFzcyBBdGxhc1NlbGZQbGF5V29ya2VyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmZpZywgd2VpZ2h0c19xdWV1ZSwgZGF0YV9xdWV1ZSwgc3RvcF9ldmVudCwgd29ya2VyX2lkKToKICAgICAgICBzZWxmLmNvbmZpZyA9IGNvbmZpZwogICAgICAgIHNlbGYud2VpZ2h0c19xdWV1ZSA9IHdlaWdodHNfcXVldWUKICAgICAgICBzZWxmLmRhdGFfcXVldWUgPSBkYXRhX3F1ZXVlCiAgICAgICAgc2VsZi5zdG9wX2V2ZW50ID0gc3RvcF9ldmVudAogICAgICAgIHNlbGYud29ya2VyX2lkID0gd29ya2VyX2lkCiAgICAgICAgCiAgICAgICAgZnJvbSBwcm9tZXRoZXVzX3RxZmQuYXRsYXMubmV0d29yayBpbXBvcnQgQXRsYXNOZXR3b3JrCiAgICAgICAgc2VsZi5uZXR3b3JrID0gQXRsYXNOZXR3b3JrKGNvbmZpZykudG8oY29uZmlnLmFjdG9yX2RldmljZSkKICAgICAgICBzZWxmLm5ldHdvcmsuZXZhbCgpCiAgICAgICAgCiAgICAgICAgc2VsZi5tY3RzID0gTUNUUyhjb25maWcpCiAgICAgICAgc2VsZi5ib2FyZF9lbmNvZGVyID0gQm9hcmRFbmNvZGVyKCkKICAgICAgICBzZWxmLm1vdmVfZW5jb2RlciA9IE1vdmVFbmNvZGVyKCkKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHByaW50KGYiQXRsYXMgV29ya2VyIHtzZWxmLndvcmtlcl9pZH0gc3RhcnRlZC4iKQogICAgICAgIHdoaWxlIG5vdCBzZWxmLnN0b3BfZXZlbnQuaXNfc2V0KCk6CiAgICAgICAgICAgICMgQ2hlY2sgZm9yIG5ldyB3ZWlnaHRzCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLndlaWdodHNfcXVldWUuZW1wdHkoKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzdGF0ZV9kaWN0ID0gc2VsZi53ZWlnaHRzX3F1ZXVlLmdldF9ub3dhaXQoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubmV0d29yay5sb2FkX3N0YXRlX2RpY3Qoc3RhdGVfZGljdCkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIAogICAgICAgICAgICB0cmFqZWN0b3J5ID0gc2VsZi5fcGxheV9nYW1lKCkKICAgICAgICAgICAgc2VsZi5kYXRhX3F1ZXVlLnB1dCh0cmFqZWN0b3J5KQoKICAgIGRlZiBfcGxheV9nYW1lKHNlbGYpOgogICAgICAgIGJvYXJkID0gY2hlc3MuQm9hcmQoKQogICAgICAgIHRyYWplY3RvcnkgPSBbXQogICAgICAgIAogICAgICAgIHdoaWxlIG5vdCBib2FyZC5pc19nYW1lX292ZXIoKSBhbmQgbm90IHNlbGYuc3RvcF9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgc3RhdGVfdGVuc29yID0gc2VsZi5ib2FyZF9lbmNvZGVyLmVuY29kZShib2FyZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHJvb3QgPSBzZWxmLm1jdHMuc2VhcmNoKGJvYXJkLCBzZWxmLm5ldHdvcmssIHNlbGYuY29uZmlnLmFjdG9yX2RldmljZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgUG9saWN5IHRhcmdldDogbm9ybWFsaXplZCB2aXNpdCBjb3VudHMKICAgICAgICAgICAgcG9saWN5X3RhcmdldCA9IHRvcmNoLnplcm9zKDQ2NzIpCiAgICAgICAgICAgIHRvdGFsX3Zpc2l0cyA9IHN1bShjaGlsZC52aXNpdF9jb3VudCBmb3IgY2hpbGQgaW4gcm9vdC5jaGlsZHJlbi52YWx1ZXMoKSkKICAgICAgICAgICAgZm9yIG1vdmUsIGNoaWxkIGluIHJvb3QuY2hpbGRyZW4uaXRlbXMoKToKICAgICAgICAgICAgICAgIHBvbGljeV90YXJnZXRbc2VsZi5tb3ZlX2VuY29kZXIubW92ZV90b19pbmRleChtb3ZlKV0gPSBjaGlsZC52aXNpdF9jb3VudCAvIHRvdGFsX3Zpc2l0cwogICAgICAgICAgICAKICAgICAgICAgICAgIyBTZWxlY3QgYWN0aW9uCiAgICAgICAgICAgIHRlbXAgPSBzZWxmLmNvbmZpZy5hdGxhc190ZW1wX2luaXQgaWYgbGVuKGJvYXJkLm1vdmVfc3RhY2spIDwgc2VsZi5jb25maWcuYXRsYXNfdGVtcF9tb3ZlcyBlbHNlIHNlbGYuY29uZmlnLmF0bGFzX3RlbXBfZmluYWwKICAgICAgICAgICAgIyBXYWl0LCBhdGxhc190ZW1wX2luaXQvZmluYWwgYXJlIG5vdCBpbiBteSBjb25maWcucHkgeWV0LCBJIHNob3VsZCBhZGQgdGhlbSBvciB1c2UgZGVmYXVsdHMuCiAgICAgICAgICAgICMgSSB1c2VkIGF0bGFzX3RlbXBfbW92ZXM9MzAuIEknbGwgdXNlIDEuMCBhbmQgMC4xIGFzIGRlZmF1bHQgdGVtcHMuCiAgICAgICAgICAgIG1vdmUgPSBzZWxmLm1jdHMuc2VsZWN0X2FjdGlvbihyb290LCB0ZW1wZXJhdHVyZT10ZW1wIGlmIGhhc2F0dHIoc2VsZi5jb25maWcsICdhdGxhc190ZW1wX2luaXQnKSBlbHNlIDEuMCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHRyYWplY3RvcnkuYXBwZW5kKHsKICAgICAgICAgICAgICAgICdzdGF0ZSc6IHN0YXRlX3RlbnNvciwKICAgICAgICAgICAgICAgICdwb2xpY3knOiBwb2xpY3lfdGFyZ2V0LAogICAgICAgICAgICAgICAgJ3ZhbHVlJzogTm9uZSwgIyBUbyBiZSBmaWxsZWQKICAgICAgICAgICAgICAgICd0dXJuJzogYm9hcmQudHVybgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgYm9hcmQucHVzaChtb3ZlKQogICAgICAgICAgICAKICAgICAgICAjIEZpbGwgcmVzdWx0cwogICAgICAgIHJlc3VsdF9zdHIgPSBib2FyZC5yZXN1bHQoKQogICAgICAgIHJlc3VsdCA9IDAuMAogICAgICAgIGlmIHJlc3VsdF9zdHIgPT0gIjEtMCI6IHJlc3VsdCA9IDEuMAogICAgICAgIGVsaWYgcmVzdWx0X3N0ciA9PSAiMC0xIjogcmVzdWx0ID0gLTEuMAogICAgICAgIAogICAgICAgIGZvciBzdGVwIGluIHRyYWplY3Rvcnk6CiAgICAgICAgICAgICMgVmFsdWUgZnJvbSBwZXJzcGVjdGl2ZSBvZiBwbGF5ZXIgd2hvc2UgdHVybiBpdCBpcwogICAgICAgICAgICBzdGVwWyd2YWx1ZSddID0gcmVzdWx0IGlmIHN0ZXBbJ3R1cm4nXSA9PSBjaGVzcy5XSElURSBlbHNlIC1yZXN1bHQKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHRyYWplY3RvcnkK")
write_file_b64("prometheus_tqfd/atlas/mcts.py", "aW1wb3J0IG1hdGgKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0b3JjaAppbXBvcnQgY2hlc3MKZnJvbSBwcm9tZXRoZXVzX3RxZmQuZW5jb2RpbmcgaW1wb3J0IE1vdmVFbmNvZGVyLCBCb2FyZEVuY29kZXIKCmNsYXNzIE1DVFNOb2RlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGJvYXJkOiBjaGVzcy5Cb2FyZCwgcGFyZW50PU5vbmUsIHByaW9yPTAuMCk6CiAgICAgICAgc2VsZi5ib2FyZCA9IGJvYXJkCiAgICAgICAgc2VsZi5wYXJlbnQgPSBwYXJlbnQKICAgICAgICBzZWxmLmNoaWxkcmVuID0ge30KICAgICAgICBzZWxmLnZpc2l0X2NvdW50ID0gMAogICAgICAgIHNlbGYudG90YWxfdmFsdWUgPSAwLjAKICAgICAgICBzZWxmLnByaW9yID0gcHJpb3IKICAgICAgICBzZWxmLmlzX2V4cGFuZGVkID0gRmFsc2UKCiAgICBAcHJvcGVydHkKICAgIGRlZiBxX3ZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnRvdGFsX3ZhbHVlIC8gc2VsZi52aXNpdF9jb3VudCBpZiBzZWxmLnZpc2l0X2NvdW50ID4gMCBlbHNlIDAuMAoKY2xhc3MgTUNUUzoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25maWcpOgogICAgICAgIHNlbGYuY29uZmlnID0gY29uZmlnCiAgICAgICAgc2VsZi5tb3ZlX2VuY29kZXIgPSBNb3ZlRW5jb2RlcigpCiAgICAgICAgc2VsZi5ib2FyZF9lbmNvZGVyID0gQm9hcmRFbmNvZGVyKCkKCiAgICBkZWYgc2VhcmNoKHNlbGYsIGJvYXJkOiBjaGVzcy5Cb2FyZCwgbmV0d29yaywgZGV2aWNlPSdjcHUnKToKICAgICAgICByb290ID0gTUNUU05vZGUoYm9hcmQuY29weSgpKQogICAgICAgIAogICAgICAgICMgSW5pdGlhbCBleHBhbnNpb24gZm9yIHJvb3QKICAgICAgICBzZWxmLl9leHBhbmRfbm9kZShyb290LCBuZXR3b3JrLCBkZXZpY2UpCiAgICAgICAgc2VsZi5fYWRkX2RpcmljaGxldF9ub2lzZShyb290KQoKICAgICAgICBmb3IgXyBpbiByYW5nZShzZWxmLmNvbmZpZy5hdGxhc19tY3RzX3NpbXVsYXRpb25zKToKICAgICAgICAgICAgbm9kZSA9IHJvb3QKICAgICAgICAgICAgc2VhcmNoX3BhdGggPSBbbm9kZV0KCiAgICAgICAgICAgICMgU2VsZWN0aW9uCiAgICAgICAgICAgIHdoaWxlIG5vZGUuaXNfZXhwYW5kZWQgYW5kIG5vdCBub2RlLmJvYXJkLmlzX2dhbWVfb3ZlcigpOgogICAgICAgICAgICAgICAgYWN0aW9uLCBub2RlID0gc2VsZi5fc2VsZWN0X2NoaWxkKG5vZGUpCiAgICAgICAgICAgICAgICBzZWFyY2hfcGF0aC5hcHBlbmQobm9kZSkKCiAgICAgICAgICAgICMgRXhwYW5zaW9uICYgRXZhbHVhdGlvbgogICAgICAgICAgICB2YWx1ZSA9IHNlbGYuX2V2YWx1YXRlKG5vZGUsIG5ldHdvcmssIGRldmljZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQmFja3Byb3BhZ2F0aW9uCiAgICAgICAgICAgIHNlbGYuX2JhY2twcm9wYWdhdGUoc2VhcmNoX3BhdGgsIHZhbHVlKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcm9vdAoKICAgIGRlZiBfc2VsZWN0X2NoaWxkKHNlbGYsIG5vZGUpOgogICAgICAgIGJlc3Rfc2NvcmUgPSAtZmxvYXQoJ2luZicpCiAgICAgICAgYmVzdF9hY3Rpb24gPSBOb25lCiAgICAgICAgYmVzdF9jaGlsZCA9IE5vbmUKCiAgICAgICAgdG90YWxfc3FydF9uID0gbWF0aC5zcXJ0KHN1bShjaGlsZC52aXNpdF9jb3VudCBmb3IgY2hpbGQgaW4gbm9kZS5jaGlsZHJlbi52YWx1ZXMoKSkpCiAgICAgICAgCiAgICAgICAgZm9yIGFjdGlvbiwgY2hpbGQgaW4gbm9kZS5jaGlsZHJlbi5pdGVtcygpOgogICAgICAgICAgICB1X3Njb3JlID0gc2VsZi5jb25maWcuYXRsYXNfbWN0c19jcHVjdF9pbml0ICogY2hpbGQucHJpb3IgKiB0b3RhbF9zcXJ0X24gLyAoMSArIGNoaWxkLnZpc2l0X2NvdW50KQogICAgICAgICAgICAjIFN0YW5kYXJkIEFscGhhWmVybyBQVUNUCiAgICAgICAgICAgICMgY19wdWN0ID0gbG9nKCgxICsgTl9wYXJlbnQgKyBjX2Jhc2UpIC8gY19iYXNlKSArIGNfaW5pdAogICAgICAgICAgICAjIEZvciBzaW1wbGljaXR5IHVzaW5nIGZpeGVkIEMgZm9yIG5vdywgb3IgY2FuIGltcGxlbWVudCB0aGUgZnVsbCBmb3JtdWxhCiAgICAgICAgICAgIAogICAgICAgICAgICBzY29yZSA9IGNoaWxkLnFfdmFsdWUgKyB1X3Njb3JlCiAgICAgICAgICAgIGlmIHNjb3JlID4gYmVzdF9zY29yZToKICAgICAgICAgICAgICAgIGJlc3Rfc2NvcmUgPSBzY29yZQogICAgICAgICAgICAgICAgYmVzdF9hY3Rpb24gPSBhY3Rpb24KICAgICAgICAgICAgICAgIGJlc3RfY2hpbGQgPSBjaGlsZAogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIGJlc3RfYWN0aW9uLCBiZXN0X2NoaWxkCgogICAgZGVmIF9leHBhbmRfbm9kZShzZWxmLCBub2RlLCBuZXR3b3JrLCBkZXZpY2UpOgogICAgICAgIGlmIG5vZGUuYm9hcmQuaXNfZ2FtZV9vdmVyKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgICAgICAgICAgYm9hcmRfdGVuc29yID0gc2VsZi5ib2FyZF9lbmNvZGVyLmVuY29kZShub2RlLmJvYXJkKS51bnNxdWVlemUoMCkudG8oZGV2aWNlKQogICAgICAgICAgICBwb2xpY3lfbG9naXRzLCBfID0gbmV0d29yayhib2FyZF90ZW5zb3IpCiAgICAgICAgICAgIAogICAgICAgICAgICBtYXNrID0gc2VsZi5tb3ZlX2VuY29kZXIuZ2V0X2xlZ2FsX21hc2sobm9kZS5ib2FyZCkudG8oZGV2aWNlKQogICAgICAgICAgICBwcm9icyA9IHRvcmNoLnNvZnRtYXgocG9saWN5X2xvZ2l0c1swXVttYXNrXSwgZGltPTApLmNwdSgpLm51bXB5KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxlZ2FsX21vdmVzID0gbGlzdChub2RlLmJvYXJkLmxlZ2FsX21vdmVzKQogICAgICAgICAgICBmb3IgbW92ZSwgcHJvYiBpbiB6aXAobGVnYWxfbW92ZXMsIHByb2JzKToKICAgICAgICAgICAgICAgIG5ld19ib2FyZCA9IG5vZGUuYm9hcmQuY29weSgpCiAgICAgICAgICAgICAgICBuZXdfYm9hcmQucHVzaChtb3ZlKQogICAgICAgICAgICAgICAgbm9kZS5jaGlsZHJlblttb3ZlXSA9IE1DVFNOb2RlKG5ld19ib2FyZCwgcGFyZW50PW5vZGUsIHByaW9yPXByb2IpCiAgICAgICAgICAgICAgICAKICAgICAgICBub2RlLmlzX2V4cGFuZGVkID0gVHJ1ZQoKICAgIGRlZiBfZXZhbHVhdGUoc2VsZiwgbm9kZSwgbmV0d29yaywgZGV2aWNlKToKICAgICAgICBpZiBub2RlLmJvYXJkLmlzX2dhbWVfb3ZlcigpOgogICAgICAgICAgICByZXMgPSBub2RlLmJvYXJkLnJlc3VsdCgpCiAgICAgICAgICAgIGlmIHJlcyA9PSAiMS0wIjogcmV0dXJuIDEuMCBpZiBub2RlLmJvYXJkLnR1cm4gPT0gY2hlc3MuQkxBQ0sgZWxzZSAtMS4wCiAgICAgICAgICAgIGlmIHJlcyA9PSAiMC0xIjogcmV0dXJuIDEuMCBpZiBub2RlLmJvYXJkLnR1cm4gPT0gY2hlc3MuV0hJVEUgZWxzZSAtMS4wCiAgICAgICAgICAgIHJldHVybiAwLjAKCiAgICAgICAgc2VsZi5fZXhwYW5kX25vZGUobm9kZSwgbmV0d29yaywgZGV2aWNlKQogICAgICAgIHdpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgICAgICAgICBib2FyZF90ZW5zb3IgPSBzZWxmLmJvYXJkX2VuY29kZXIuZW5jb2RlKG5vZGUuYm9hcmQpLnVuc3F1ZWV6ZSgwKS50byhkZXZpY2UpCiAgICAgICAgICAgIF8sIHZhbHVlID0gbmV0d29yayhib2FyZF90ZW5zb3IpCiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5pdGVtKCkKCiAgICBkZWYgX2JhY2twcm9wYWdhdGUoc2VsZiwgc2VhcmNoX3BhdGgsIHZhbHVlKToKICAgICAgICBmb3Igbm9kZSBpbiByZXZlcnNlZChzZWFyY2hfcGF0aCk6CiAgICAgICAgICAgIG5vZGUudmlzaXRfY291bnQgKz0gMQogICAgICAgICAgICBub2RlLnRvdGFsX3ZhbHVlICs9IHZhbHVlCiAgICAgICAgICAgIHZhbHVlID0gLXZhbHVlCgogICAgZGVmIF9hZGRfZGlyaWNobGV0X25vaXNlKHNlbGYsIG5vZGUpOgogICAgICAgIG1vdmVzID0gbGlzdChub2RlLmNoaWxkcmVuLmtleXMoKSkKICAgICAgICBub2lzZSA9IG5wLnJhbmRvbS5kaXJpY2hsZXQoW3NlbGYuY29uZmlnLmF0bGFzX2RpcmljaGxldF9hbHBoYV0gKiBsZW4obW92ZXMpKQogICAgICAgIGZvciBpLCBtb3ZlIGluIGVudW1lcmF0ZShtb3Zlcyk6CiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW5bbW92ZV0ucHJpb3IgPSAoMSAtIHNlbGYuY29uZmlnLmF0bGFzX2RpcmljaGxldF9lcHNpbG9uKSAqIG5vZGUuY2hpbGRyZW5bbW92ZV0ucHJpb3IgKyBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLmF0bGFzX2RpcmljaGxldF9lcHNpbG9uICogbm9pc2VbaV0KCiAgICBkZWYgc2VsZWN0X2FjdGlvbihzZWxmLCByb290LCB0ZW1wZXJhdHVyZT0xLjApOgogICAgICAgIG1vdmVzID0gbGlzdChyb290LmNoaWxkcmVuLmtleXMoKSkKICAgICAgICB2aXNpdF9jb3VudHMgPSBbY2hpbGQudmlzaXRfY291bnQgZm9yIGNoaWxkIGluIHJvb3QuY2hpbGRyZW4udmFsdWVzKCldCiAgICAgICAgCiAgICAgICAgaWYgdGVtcGVyYXR1cmUgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIG1vdmVzW25wLmFyZ21heCh2aXNpdF9jb3VudHMpXQogICAgICAgIAogICAgICAgIHZpc2l0X2NvdW50cyA9IG5wLmFycmF5KHZpc2l0X2NvdW50cykgKiogKDEuMCAvIHRlbXBlcmF0dXJlKQogICAgICAgIHByb2JzID0gdmlzaXRfY291bnRzIC8gdmlzaXRfY291bnRzLnN1bSgpCiAgICAgICAgcmV0dXJuIG5wLnJhbmRvbS5jaG9pY2UobW92ZXMsIHA9cHJvYnMpCg==")
write_file_b64("prometheus_tqfd/evaluation/baselines.py", "aW1wb3J0IGNoZXNzCmltcG9ydCByYW5kb20KaW1wb3J0IG51bXB5IGFzIG5wCgpjbGFzcyBSYW5kb21QbGF5ZXI6CiAgICBkZWYgc2VsZWN0X21vdmUoc2VsZiwgYm9hcmQpOgogICAgICAgIHJldHVybiByYW5kb20uY2hvaWNlKGxpc3QoYm9hcmQubGVnYWxfbW92ZXMpKQoKY2xhc3MgSGV1cmlzdGljUGxheWVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4cGxvcmF0aW9uPTAuMSk6CiAgICAgICAgc2VsZi5leHBsb3JhdGlvbiA9IGV4cGxvcmF0aW9uCiAgICAgICAgc2VsZi5waWVjZV92YWx1ZXMgPSB7CiAgICAgICAgICAgIGNoZXNzLlBBV046IDEsIGNoZXNzLktOSUdIVDogMywgY2hlc3MuQklTSE9QOiAzLCAKICAgICAgICAgICAgY2hlc3MuUk9PSzogNSwgY2hlc3MuUVVFRU46IDksIGNoZXNzLktJTkc6IDAKICAgICAgICB9CgogICAgZGVmIHNlbGVjdF9tb3ZlKHNlbGYsIGJvYXJkKToKICAgICAgICBpZiByYW5kb20ucmFuZG9tKCkgPCBzZWxmLmV4cGxvcmF0aW9uOgogICAgICAgICAgICByZXR1cm4gcmFuZG9tLmNob2ljZShsaXN0KGJvYXJkLmxlZ2FsX21vdmVzKSkKICAgICAgICAgICAgCiAgICAgICAgbGVnYWxfbW92ZXMgPSBsaXN0KGJvYXJkLmxlZ2FsX21vdmVzKQogICAgICAgIGJlc3Rfc2NvcmUgPSAtZmxvYXQoJ2luZicpCiAgICAgICAgYmVzdF9tb3ZlcyA9IFtdCiAgICAgICAgCiAgICAgICAgZm9yIG1vdmUgaW4gbGVnYWxfbW92ZXM6CiAgICAgICAgICAgIGJvYXJkLnB1c2gobW92ZSkKICAgICAgICAgICAgc2NvcmUgPSBzZWxmLmV2YWx1YXRlKGJvYXJkKQogICAgICAgICAgICBib2FyZC5wb3AoKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBTaW5jZSBldmFsdWF0ZSByZXR1cm5zIHNjb3JlIGZvciBXaGl0ZSwgYW5kIHdlIHdhbnQgdG8gbWF4aW1pemUgZm9yIHRoZSBwbGF5ZXIgd2hvc2UgdHVybiBpdCB3YXMKICAgICAgICAgICAgaWYgYm9hcmQudHVybiA9PSBjaGVzcy5CTEFDSzoKICAgICAgICAgICAgICAgIHNjb3JlID0gLXNjb3JlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgc2NvcmUgPiBiZXN0X3Njb3JlOgogICAgICAgICAgICAgICAgYmVzdF9zY29yZSA9IHNjb3JlCiAgICAgICAgICAgICAgICBiZXN0X21vdmVzID0gW21vdmVdCiAgICAgICAgICAgIGVsaWYgc2NvcmUgPT0gYmVzdF9zY29yZToKICAgICAgICAgICAgICAgIGJlc3RfbW92ZXMuYXBwZW5kKG1vdmUpCiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmFuZG9tLmNob2ljZShiZXN0X21vdmVzKQoKICAgIGRlZiBldmFsdWF0ZShzZWxmLCBib2FyZCk6CiAgICAgICAgaWYgYm9hcmQuaXNfY2hlY2ttYXRlKCk6CiAgICAgICAgICAgIHJldHVybiAtOTk5OSBpZiBib2FyZC50dXJuID09IGNoZXNzLldISVRFIGVsc2UgOTk5OQogICAgICAgICAgICAKICAgICAgICBzY29yZSA9IDAKICAgICAgICAjIE1hdGVyaWFsCiAgICAgICAgZm9yIHNxdWFyZSwgcGllY2UgaW4gYm9hcmQucGllY2VfbWFwKCkuaXRlbXMoKToKICAgICAgICAgICAgdmFsID0gc2VsZi5waWVjZV92YWx1ZXMuZ2V0KHBpZWNlLnBpZWNlX3R5cGUsIDApCiAgICAgICAgICAgIGlmIHBpZWNlLmNvbG9yID09IGNoZXNzLldISVRFOgogICAgICAgICAgICAgICAgc2NvcmUgKz0gdmFsICogMTAKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNjb3JlIC09IHZhbCAqIDEwCiAgICAgICAgICAgICAgICAKICAgICAgICAjIE1vYmlsaXR5CiAgICAgICAgc2NvcmUgKz0gYm9hcmQubGVnYWxfbW92ZXMuY291bnQoKSAqICgxIGlmIGJvYXJkLnR1cm4gPT0gY2hlc3MuV0hJVEUgZWxzZSAtMSkKICAgICAgICAKICAgICAgICAjIENlbnRlciBjb250cm9sIChkNCwgZTQsIGQ1LCBlNSkKICAgICAgICBjZW50ZXJfc3F1YXJlcyA9IFtjaGVzcy5ENCwgY2hlc3MuRTQsIGNoZXNzLkQ1LCBjaGVzcy5FNV0KICAgICAgICBmb3Igc3EgaW4gY2VudGVyX3NxdWFyZXM6CiAgICAgICAgICAgIGlmIGJvYXJkLmlzX2F0dGFja2luZyhjaGVzcy5XSElURSwgc3EpOiBzY29yZSArPSAwLjUKICAgICAgICAgICAgaWYgYm9hcmQuaXNfYXR0YWNraW5nKGNoZXNzLkJMQUNLLCBzcSk6IHNjb3JlIC09IDAuNQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gc2NvcmUK")
write_file_b64("prometheus_tqfd/evaluation/arena.py", "aW1wb3J0IGNoZXNzCmltcG9ydCB0aW1lCmltcG9ydCB0b3JjaAppbXBvcnQgbnVtcHkgYXMgbnAKZnJvbSBwcm9tZXRoZXVzX3RxZmQuZXZhbHVhdGlvbi5iYXNlbGluZXMgaW1wb3J0IFJhbmRvbVBsYXllciwgSGV1cmlzdGljUGxheWVyCmZyb20gcHJvbWV0aGV1c190cWZkLmVuY29kaW5nIGltcG9ydCBCb2FyZEVuY29kZXIsIE1vdmVFbmNvZGVyCmZyb20gcHJvbWV0aGV1c190cWZkLmVudHJvcHkuZmllbGRzIGltcG9ydCBGaWVsZENhbGN1bGF0b3IKCmNsYXNzIEFyZW5hOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmZpZywgbWV0cmljc19xdWV1ZSwgc2hhcmVkX3ZhbHVlcyk6CiAgICAgICAgc2VsZi5jb25maWcgPSBjb25maWcKICAgICAgICBzZWxmLm1ldHJpY3NfcXVldWUgPSBtZXRyaWNzX3F1ZXVlCiAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzID0gc2hhcmVkX3ZhbHVlcwogICAgICAgIAogICAgICAgIHNlbGYuYm9hcmRfZW5jb2RlciA9IEJvYXJkRW5jb2RlcigpCiAgICAgICAgc2VsZi5tb3ZlX2VuY29kZXIgPSBNb3ZlRW5jb2RlcigpCiAgICAgICAgc2VsZi5maWVsZF9jYWxjID0gRmllbGRDYWxjdWxhdG9yKGNvbmZpZy5waHlzaWNzKQogICAgICAgIAogICAgZGVmIHBsYXlfZ2FtZShzZWxmLCBwbGF5ZXJfd2hpdGUsIHBsYXllcl9ibGFjayk6CiAgICAgICAgYm9hcmQgPSBjaGVzcy5Cb2FyZCgpCiAgICAgICAgd2hpbGUgbm90IGJvYXJkLmlzX2dhbWVfb3ZlcigpOgogICAgICAgICAgICBpZiBib2FyZC50dXJuID09IGNoZXNzLldISVRFOgogICAgICAgICAgICAgICAgbW92ZSA9IHBsYXllcl93aGl0ZS5zZWxlY3RfbW92ZShib2FyZCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG1vdmUgPSBwbGF5ZXJfYmxhY2suc2VsZWN0X21vdmUoYm9hcmQpCiAgICAgICAgICAgIGJvYXJkLnB1c2gobW92ZSkKICAgICAgICByZXR1cm4gYm9hcmQucmVzdWx0KCkKCiAgICBkZWYgdXBkYXRlX2VsbyhzZWxmLCByZXN1bHRzLCBrX2ZhY3Rvcj0zMik6CiAgICAgICAgIyByZXN1bHRzOiB7J2F0bGFzX3dpbnMnOiB4LCAnZW50cm9weV93aW5zJzogeSwgJ2RyYXdzJzogen0KICAgICAgICByX2EgPSBzZWxmLnNoYXJlZF92YWx1ZXNbJ2F0bGFzX2VsbyddCiAgICAgICAgcl9iID0gc2VsZi5zaGFyZWRfdmFsdWVzWydlbnRyb3B5X2VsbyddCiAgICAgICAgCiAgICAgICAgZV9hID0gMSAvICgxICsgMTAgKiogKChyX2IgLSByX2EpIC8gNDAwKSkKICAgICAgICAKICAgICAgICB0b3RhbCA9IHJlc3VsdHNbJ2F0bGFzX3dpbnMnXSArIHJlc3VsdHNbJ2VudHJvcHlfd2lucyddICsgcmVzdWx0c1snZHJhd3MnXQogICAgICAgIGlmIHRvdGFsID09IDA6IHJldHVybgogICAgICAgIAogICAgICAgIHNfYSA9IChyZXN1bHRzWydhdGxhc193aW5zJ10gKyAwLjUgKiByZXN1bHRzWydkcmF3cyddKSAvIHRvdGFsCiAgICAgICAgCiAgICAgICAgc2VsZi5zaGFyZWRfdmFsdWVzWydhdGxhc19lbG8nXSA9IHJfYSArIGtfZmFjdG9yICogKHNfYSAtIGVfYSkKICAgICAgICBzZWxmLnNoYXJlZF92YWx1ZXNbJ2VudHJvcHlfZWxvJ10gPSByX2IgKyBrX2ZhY3RvciAqICgoMSAtIHNfYSkgLSAoMSAtIGVfYSkpCgpjbGFzcyBOTlBsYXllcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtb2RlbCwgY29uZmlnLCBtb3ZlX2VuY29kZXIsIGJvYXJkX2VuY29kZXIsIGZpZWxkX2NhbGM9Tm9uZSwgaXNfbWN0cz1GYWxzZSk6CiAgICAgICAgc2VsZi5tb2RlbCA9IG1vZGVsCiAgICAgICAgc2VsZi5jb25maWcgPSBjb25maWcKICAgICAgICBzZWxmLm1vdmVfZW5jb2RlciA9IG1vdmVfZW5jb2RlcgogICAgICAgIHNlbGYuYm9hcmRfZW5jb2RlciA9IGJvYXJkX2VuY29kZXIKICAgICAgICBzZWxmLmZpZWxkX2NhbGMgPSBmaWVsZF9jYWxjCiAgICAgICAgc2VsZi5pc19tY3RzID0gaXNfbWN0cwogICAgICAgIAogICAgICAgIGlmIGlzX21jdHM6CiAgICAgICAgICAgIGZyb20gcHJvbWV0aGV1c190cWZkLmF0bGFzLm1jdHMgaW1wb3J0IE1DVFMKICAgICAgICAgICAgc2VsZi5tY3RzID0gTUNUUyhjb25maWcpCgogICAgZGVmIHNlbGVjdF9tb3ZlKHNlbGYsIGJvYXJkKToKICAgICAgICBzZWxmLm1vZGVsLmV2YWwoKQogICAgICAgIHdpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgICAgICAgICBpZiBzZWxmLmlzX21jdHM6CiAgICAgICAgICAgICAgICByb290ID0gc2VsZi5tY3RzLnNlYXJjaChib2FyZCwgc2VsZi5tb2RlbCwgc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYubWN0cy5zZWxlY3RfYWN0aW9uKHJvb3QsIHRlbXBlcmF0dXJlPTApCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmaWVsZF90ZW5zb3IgPSBzZWxmLmZpZWxkX2NhbGMuY29tcHV0ZV9maWVsZHMoYm9hcmQpLnVuc3F1ZWV6ZSgwKS50byhzZWxmLmNvbmZpZy5hY3Rvcl9kZXZpY2UpCiAgICAgICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYubW9kZWwsICdoYXNfcHlnJykgYW5kIHNlbGYubW9kZWwuaGFzX3B5ZzoKICAgICAgICAgICAgICAgICAgICBmcm9tIHByb21ldGhldXNfdHFmZC5lbnRyb3B5Lm5ldHdvcmsgaW1wb3J0IGJ1aWxkX2dyYXBoX2RhdGEKICAgICAgICAgICAgICAgICAgICBib2FyZF9kYXRhID0gYnVpbGRfZ3JhcGhfZGF0YShib2FyZCkudG8oc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBib2FyZF9kYXRhID0gc2VsZi5ib2FyZF9lbmNvZGVyLmVuY29kZShib2FyZCkudW5zcXVlZXplKDApLnRvKHNlbGYuY29uZmlnLmFjdG9yX2RldmljZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbWFzayA9IHNlbGYubW92ZV9lbmNvZGVyLmdldF9sZWdhbF9tYXNrKGJvYXJkKS51bnNxdWVlemUoMCkudG8oc2VsZi5jb25maWcuYWN0b3JfZGV2aWNlKQogICAgICAgICAgICAgICAgcHJvYnMsIF8sIF8sIF8sIF8gPSBzZWxmLm1vZGVsKGZpZWxkX3RlbnNvciwgYm9hcmRfZGF0YSwgbWFzaykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcHJvYnMgPSBwcm9ic1swXS5jcHUoKS5udW1weSgpCiAgICAgICAgICAgICAgICBsZWdhbF9tb3ZlcyA9IGxpc3QoYm9hcmQubGVnYWxfbW92ZXMpCiAgICAgICAgICAgICAgICBsZWdhbF9pbmRpY2VzID0gW3NlbGYubW92ZV9lbmNvZGVyLm1vdmVfdG9faW5kZXgobSkgZm9yIG0gaW4gbGVnYWxfbW92ZXNdCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBfbGVnYWwgPSBwcm9ic1tsZWdhbF9pbmRpY2VzXQogICAgICAgICAgICAgICAgbW92ZV9pZHggPSBucC5hcmdtYXgocF9sZWdhbCkKICAgICAgICAgICAgICAgIHJldHVybiBsZWdhbF9tb3Zlc1ttb3ZlX2lkeF0KCmRlZiBjYWxjdWxhdGVfZWxvX3VwZGF0ZShyX2EsIHJfYiwgc2NvcmVfYSwgaz0zMik6CiAgICBlX2EgPSAxIC8gKDEgKyAxMCAqKiAoKHJfYiAtIHJfYSkgLyA0MDApKQogICAgcmV0dXJuIHJfYSArIGsgKiAoc2NvcmVfYSAtIGVfYSkK")
write_file_b64("main.py", "aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHRpbWUKaW1wb3J0IG11bHRpcHJvY2Vzc2luZyBhcyBtcApmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKCiMgQWRkIHByb2plY3Qgcm9vdCB0byBwYXRoCnN5cy5wYXRoLmFwcGVuZChvcy5nZXRjd2QoKSkKCmRlZiBpbnN0YWxsX2RlcGVuZGVuY2llcygpOgogICAgcHJpbnQoIvCfk6YgSW5zdGFsbGluZyBkZXBlbmRlbmNpZXMuLi4iKQogICAgbGlicyA9IFsKICAgICAgICAicHl0aG9uLWNoZXNzIiwgIm51bXB5IiwgInRvcmNoIiwgImVpbm9wcyIsICJwc3V0aWwiLCAKICAgICAgICAibHo0IiwgInNhZmV0ZW5zb3JzIiwgInBsb3RseSIsICJzdHJlYW1saXQiLCAicHluZ3JvayIKICAgIF0KICAgICMgQ2hlY2sgaWYgdG9yY2hfZ2VvbWV0cmljIGNhbiBiZSBpbnN0YWxsZWQgZWFzaWx5CiAgICB0cnk6CiAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJwaXAiLCAiaW5zdGFsbCIsICItLXF1aWV0Il0gKyBsaWJzLCBjaGVjaz1UcnVlKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiV2FybmluZzogRXJyb3IgZHVyaW5nIGluc3RhbGxhdGlvbjoge2V9IikKCmRlZiBzZXR1cF9kaXJlY3Rvcmllcyhjb25maWcpOgogICAgIyBIYW5kbGUgL2NvbnRlbnQgZm9yIENvbGFiCiAgICBpZiBvcy5wYXRoLmV4aXN0cygiL2NvbnRlbnQiKToKICAgICAgICBjb25maWcuYmFzZV9kaXIgPSBQYXRoKCIvY29udGVudC9wcm9tZXRoZXVzX3J1bnMiKQogICAgICAgIAogICAgcnVuX2RpciA9IGNvbmZpZy5iYXNlX2RpciAvIGNvbmZpZy5ydW5faWQKICAgIGZvciBzdWIgaW4gWydjaGVja3BvaW50cycsICdtZXRyaWNzJywgJ2dhbWVzJywgJ2xvZ3MnXToKICAgICAgICAocnVuX2RpciAvIHN1YikubWtkaXIocGFyZW50cz1UcnVlLCBleGlzdF9vaz1UcnVlKQogICAgCiAgICAjIENyZWF0ZSBhIGxpbmsgdG8gbGF0ZXN0CiAgICBsYXRlc3RfbGluayA9IGNvbmZpZy5iYXNlX2RpciAvICdsYXRlc3QnCiAgICBpZiBsYXRlc3RfbGluay5leGlzdHMoKToKICAgICAgICBpZiBsYXRlc3RfbGluay5pc19zeW1saW5rKCk6IGxhdGVzdF9saW5rLnVubGluaygpCiAgICAgICAgZWxzZTogc2h1dGlsLnJtdHJlZShsYXRlc3RfbGluaykKICAgIAogICAgIyBJbiBDb2xhYiwgd2UgY2FuJ3QgYWx3YXlzIHN5bWxpbmsuIExldCdzIGp1c3QgdXNlIGl0IGFzIGEgbmFtZS4KICAgICMgV2UnbGwgaGFuZGxlICdsYXRlc3QnIGxvZ2ljIGluIENQIG1hbmFnZXIuCiAgICBwYXNzCgpkZWYgc3RhcnRfZGFzaGJvYXJkKHBvcnQpOgogICAgcHJpbnQoZiLwn5qAIFN0YXJ0aW5nIFN0cmVhbWxpdCBEYXNoYm9hcmQgb24gcG9ydCB7cG9ydH0uLi4iKQogICAgIyBTdGFydCBzdHJlYW1saXQgYXMgYSBzdWJwcm9jZXNzCiAgICBwcm9jZXNzID0gc3VicHJvY2Vzcy5Qb3BlbihbCiAgICAgICAgc3lzLmV4ZWN1dGFibGUsICItbSIsICJzdHJlYW1saXQiLCAicnVuIiwgCiAgICAgICAgInByb21ldGhldXNfdHFmZC9kYXNoYm9hcmQvYXBwLnB5IiwKICAgICAgICBmIi0tc2VydmVyLnBvcnQ9e3BvcnR9IiwKICAgICAgICAiLS1zZXJ2ZXIuaGVhZGxlc3M9dHJ1ZSIKICAgIF0pCiAgICByZXR1cm4gcHJvY2VzcwoKZGVmIG1haW4oKToKICAgIHByaW50KCLwn5SlIFBST01FVEhFVVMtVFFGRCBEdWFsIENoZXNzIEFJIFRyYWluaW5nIFN5c3RlbSIpCiAgICAKICAgICMgbXAgc2V0dXAKICAgIG1wLnNldF9zdGFydF9tZXRob2QoJ3NwYXduJywgZm9yY2U9VHJ1ZSkKICAgIAogICAgIyAxLiBIYXJkd2FyZSBEZXRlY3Rpb24KICAgIGZyb20gcHJvbWV0aGV1c190cWZkLnV0aWxzLmhhcmR3YXJlIGltcG9ydCBkZXRlY3RfaGFyZHdhcmUKICAgIGh3ID0gZGV0ZWN0X2hhcmR3YXJlKCkKICAgIHByaW50KGYi8J+TiiBIYXJkd2FyZToge2h3WydkZXZpY2UnXS51cHBlcigpfSAtIHtod1snZ3B1X25hbWUnXX0iKQogICAgCiAgICAjIDIuIENvbmZpZwogICAgZnJvbSBwcm9tZXRoZXVzX3RxZmQuY29uZmlnIGltcG9ydCBQcm9tZXRoZXVzQ29uZmlnLCBhZGp1c3RfY29uZmlnX2Zvcl9oYXJkd2FyZQogICAgY29uZmlnID0gUHJvbWV0aGV1c0NvbmZpZygpCiAgICAKICAgICMgR29vZ2xlIERyaXZlIE1vdW50CiAgICBpZiBvcy5wYXRoLmV4aXN0cygiL2NvbnRlbnQiKSBhbmQgY29uZmlnLnVzZV9kcml2ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZyb20gZ29vZ2xlLmNvbGFiIGltcG9ydCBkcml2ZQogICAgICAgICAgICBkcml2ZS5tb3VudCgnL2NvbnRlbnQvZHJpdmUnKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoIuKaoO+4jyBDb3VsZCBub3QgbW91bnQgR29vZ2xlIERyaXZlLiIpCiAgICBjb25maWcgPSBhZGp1c3RfY29uZmlnX2Zvcl9oYXJkd2FyZShjb25maWcpCiAgICAKICAgICMgMy4gU2V0dXAgRGlyZWN0b3JpZXMKICAgIHNldHVwX2RpcmVjdG9yaWVzKGNvbmZpZykKICAgIAogICAgIyA0LiBTdGFydCBEYXNoYm9hcmQgJiBUdW5uZWwKICAgIGRhc2hib2FyZF9wcm9jID0gc3RhcnRfZGFzaGJvYXJkKGNvbmZpZy5kYXNoYm9hcmRfcG9ydCkKICAgIGZyb20gcHJvbWV0aGV1c190cWZkLnV0aWxzLnR1bm5lbGluZyBpbXBvcnQgc2V0dXBfdHVubmVsCiAgICAjIFRyeSB0byBnZXQgbmdyb2sgdG9rZW4gZnJvbSBlbnZpcm9ubWVudCBvciBzZWNyZXRzCiAgICBuZ3Jva190b2tlbiA9IG9zLmVudmlyb24uZ2V0KCdOR1JPS19UT0tFTicpCiAgICB0cnk6CiAgICAgICAgZnJvbSBnb29nbGUuY29sYWIgaW1wb3J0IHVzZXJkYXRhCiAgICAgICAgbmdyb2tfdG9rZW4gPSBuZ3Jva190b2tlbiBvciB1c2VyZGF0YS5nZXQoJ05HUk9LX1RPS0VOJykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICAgICAgCiAgICBwdWJsaWNfdXJsID0gc2V0dXBfdHVubmVsKGNvbmZpZy5kYXNoYm9hcmRfcG9ydCwgbmdyb2tfdG9rZW49bmdyb2tfdG9rZW4pCiAgICBwcmludChmIuKchSBEYXNoYm9hcmQgVVJMOiB7cHVibGljX3VybH0iKQogICAgCiAgICAjIDUuIFN0YXJ0IFN1cGVydmlzb3IKICAgIGZyb20gcHJvbWV0aGV1c190cWZkLm9yY2hlc3RyYXRpb24uc3VwZXJ2aXNvciBpbXBvcnQgU3VwZXJ2aXNvcgogICAgc3VwZXJ2aXNvciA9IFN1cGVydmlzb3IoY29uZmlnKQogICAgCiAgICBwcmludCgiXG7wn5qAIFN0YXJ0aW5nIFRyYWluaW5nLi4uIikKICAgIHRyeToKICAgICAgICBzdXBlcnZpc29yLnJ1bigpCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxu8J+bkSBTaHV0ZG93biByZXF1ZXN0ZWQuIikKICAgIGZpbmFsbHk6CiAgICAgICAgaWYgZGFzaGJvYXJkX3Byb2M6IGRhc2hib2FyZF9wcm9jLnRlcm1pbmF0ZSgpCiAgICAgICAgcHJpbnQoIuKchSBQcm9tZXRoZXVzIGZpbmlzaGVkLiIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg==")

if __name__ == "__main__":
    # Installation
    print("üì¶ Installing core dependencies...")
    subprocess.run([sys.executable, "-m", "pip", "install", "--quiet", "python-chess", "numpy", "torch", "einops", "psutil", "lz4", "safetensors", "plotly", "streamlit", "pyngrok"], check=True)

    # Run Main
    if os.path.exists("main.py"):
        import main
        main.main()
    else:
        print("‚ùå main.py not found!")
